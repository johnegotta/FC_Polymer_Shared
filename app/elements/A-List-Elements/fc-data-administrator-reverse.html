
<dom-module id="fc-data-administrator-reverse">
	<!-- CodeMirror -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.2.0/codemirror.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.2.0/codemirror.css">

<!-- Firepad -->
<link rel="stylesheet" href="https://cdn.firebase.com/libs/firepad/1.2.0/firepad.css">
<script src="https://cdn.firebase.com/libs/firepad/1.2.0/firepad.min.js"></script>

	<template>
<style>
	 	#div1 {
	 		min-width:260px; 
	 		max-width: 960px;
	 		display: flex;
	 		min-height:280 px;
	 		padding:10px;
	 		border:1px solid #aaaaaa;
	 	}
	 	article { display: block;}
	  	
		div.assistView::--webkit-scrollbar {
					display: none;
			}
		
		paper-dialogue-scrollable::--webkit-scrollbar {
					display: none;}
	
			paper-dialog {
				font-family: merriweather;
			  	font-size: 1.05em;
				display: block;
				min-width: 270px;
				max-width: 1080px;
				min-height: 280px;
				overflow: hidden;
				border: 2px ridge #002c90;
				background: #fff;
				border-radius: 8px;
				z-index: 100000;
				opacity: 1;
				display: flex;
			}
			.subheading{
				font-size: 13px;
				color: brown;
				font-weight: 800;
			}
			h6.subheading{
				font-size: .6em;
				color: brown;
				font-weight: 800;
			}
			
			.fc-headerclass{
				padding: 4px 2px 2px 4px;
				font-family: Merriweather;
				font-size: 26px;
				color: #000066;
				}
			fc-holder{
				margin: 3px;
				border: 2px dashed green;
				padding: 3px;
			}
			
			h3, h4 {
				color: #000066;
				margin-bottom: 4px;
				margin-top: 8px;
				font-family: Merriweather;
				font-weight: 700;
			}
			section {
			 
			 	overflow-y: scroll;
			}
			iron-page {
				display: float;
				position: relative;
				margin-top: 0px;
				padding-top: 4px;
			}
			p.assistant{
			
				font-family: Times;
				font-size: 14px;
				font-weight: 500px;
				color: goldenrod;
				overflow-y: scroll;
			}
			div.scroll-master{
				height: 98%;
				min-height:460px;
				overflow: hidden;
				overflow-y: scroll;
				border: 0px 3px 0px 3px inset #fffffe;
				border-top: 1px solid #000066;
				border-bottom: 1px solid #000066;
			}
			iron-icon{
				height: 36px;
				width: 36px;
			}
			
			iron-pages{
			
				position: relative;
				display: flex;
			}
			fc-holder{ 
				margin: 2px 6px 4px 6px;
			}
			
			
</style>
	<div class="layout container vertical center center-justified iconset">
		<button class="right" style="position: fixed; left: 400px; top: 30px; opacity: .65; background: goldenrod; border: 6px ridge silver;" on-tap="flattap" on-hover="{{getFocused}}"> TAP ME
				<div hidden="{{getFocused}}"style="font-size: 8.5pt; width: 500px; height: 24px; font-family: times; color: #000066;">
					<span>Get Focused!</span>
				</div>
		</button>
	</div>

								
<paper-dialog id="dragDialogTwo" class="layout vertical container" style="display: block; overflow: auto; resizable: both; resize: auto;"  draggable="true" no-cancel-on-outside-click="true">
<div on-mousedown="_startDrag">
	<h3 class="fc-headerclass horizontal layout center-justified" style="padding-bottom: 4px; margin-top:16px;">The Focused Data Admin</h3>
	<h6  class="subheading horizontal layout center-justified" style="line-height:2; margin: 10px 3px 0px 3px;">CLICK TO DRAG || CLICK AGAIN TO RELEASE</h6></div>
	<div class="scroll-master">
		<iron-pages id="assistantPages" selected="0">
			<section>
				<!--<fc-cell-creator>
				</fc-cell-creator>-->
				<div class="vertical layout flex-1 container">
				<fc-holder "horizontal layout no-wrap container center center-justified">
					<paper-input value='{{testNumber}}' style="max-width: 340px;" list="Test Number" always-float-label='true' label='Test Number'></paper-input>
					<datalist name="Test Number" list="Test Number" id="Test Number">
						<option value={{testNumber.one}}> Test 1</option>
						<option> Test 2</option>
						<option> Test 3</option>
						<option> Test 4</option>
						<option> Test 5</option>
						<option> Test 6</option>
						<option> Test 7</option>
						<option> Test 8</option>
						<option> Test 9</option>
						<option> Test 10</option>
					</datalist>
					<paper-input value='{{sectionType}}' style="max-width: 340px;" list="SectionType" always-float-label='true' label='Section Type'></paper-input>
					<datalist name="Test Number" list="Test Number" id="SectionType">
						<option> Math 55 Questions</option>
						<option> Math 25 Questions</option>
						<option> Reading 52 Questions</option>
						<option> Writing 40 Questions</option>
						<option> Essay Prompt and Passage</option>
					</datalist>
					<paper-input value='{{sectionType}}' style="max-width: 340px;" list="subSection" always-float-label='true' label='Sub-Section Type'></paper-input>
					<datalist name="subSection" list="subSection" id="subSection">
						<option> THESE OPTIONS SHOULD BE BOUND</option>
						<option> THESE OPTIONS SHOULD BE BOUND</option>
						<option> THESE OPTIONS SHOULD BE BOUND</option>
						<option> THESE OPTIONS SHOULD BE BOUND</option>
						<option> THESE OPTIONS SHOULD BE BOUND</option>
					</datalist>

				</fc-holder>
				<fc-holder "horizontal layout no-wrap container">
					<paper-input value='{{passageNumber}}' style="max-width: 340px;" always-float-label='true' label='Passage Title'></paper-input>
					<paper-input value='{{passageTitle}}' style="max-width: 340px;" always-float-label='true' label='Passage Title'></paper-input>
					<paper-input value='{{passageBlurb}}' style="max-width: 340px;" always-float-label='true' label='Passage Blurb'></paper-input>
				</fc-holder>
				</div>
			</section>
			<section class="vertical layout flex container">
				<div id="firepad" style="border: 6px ridge silver; overflow: auto;resize: auto; min-height: 480px;" class="fit">
					
				</div>
				




			</section>
			<section>
				<h3> Building Cells</h3>
				<h5> Cell Builder One</h5>
			</section>
<section>




</section>



				
	</iron-pages>
</div>
			
	<fc-holder>	
				<paper-button class="flex-1" on-tap="conttap">More</paper-button>
				<paper-button class="flex-1" on-tap="coolThings">Scores</paper-button>
				<paper-button class="flex-1" dialog-dismiss>Exit</paper-button>
				<paper-button class="flex-1" on-tap="_savePassage">Passage Save</paper-button>

	</fc-holder>
	
</paper-dialog>
</template>
<script>  
	Polymer({
		is: 'fc-data-administrator-reverse',
		properties:{
		offsetX: {
				type: Number,
				notify: true,
				reflectToAttributes: true
				},
		offsetY: {
				type: Number,
				notify: true,
				reflectToAttributes: true
				},
		wordArray2: {
			type: Array,
			value: [], 
			notify: true, 
			reflectToAttributes: true,
				},
		dragging: {
				type: Boolean, 
				value: false, 
				notify: true
			},
		newPassageRef: {
			type: Number,
			value: 0,
			notify: true
		},
		timeout: {
				type: Boolean, 
				value: false, 
				notify: true
			},
		passageDestinations: {
			type: Array,
			value: [],
			notify: true
		},
		passagesArray: {
			type: Array,
			value: [],
			notify: true
		},
		passageTitle: {
			type: String,
			value: 'none',
			notify: true
		},
		passageBlurb:{
			type: String,
			value: 'none',
			notify: true
		}, 
		open: 	{
			type: Boolean,
			value: false, 
			notify: true
			},
		currentDragger:{
			type: Object,
			notify: true,
			reflectToAttributes: true
		}, 
		superItemArray:{
			type:Array,
			value: [],
			notify: true,
			reflectToAttributes: true
		},
		passageWordArray:{
			type:Array,
			value: [],
			notify: true,
			reflectToAttributes: true
		},
		getFocused: {
			type: Boolean, 
			value: true,
			notify: true,
			reflectToAttributes: true
		},
		order:{
			type: Number,
			notify: true
		},
		passageWordObject:{
			type:Object,
			value: {},
			notify: true,
			reflectToAttributes: true
		}, 
		passageContent: {
			type: String,
			notify: true,
			reflectToAttributes: true
		},
		firepad: {
			type:Object,
			value:{},
			notify: true,
			reflectToAttributes: true	
		},
		firepadRef: {
			type:Object,
			value:{},
			notify: true,
			reflectToAttributes: true	
		},
		passageBlurb:{
			type: String,
			value: 'none',
			reflectToAttributes: true,
			notify: true
		}
	},
	 created: function(){
	 	
		},
attached: function() { 
	this.loadFirepad();
	this.loadPassages();
			
			},
	loadPassages: function(){
				self=this;
				self.passagesArray=[];
				var ref= new Firebase("https://focused0ne.firebaseio.com/passagesDestinations");
				ref.on("child_added", function(snap){
					if (snap.val() ==undefined){
						self.push('passageDestinations',"https://focused0ne.firebaseio.com/passagesDestinations/new_Passage_0");
							self.newPassageRef = 0;
							self.newPassageRef++;	
											
					}
					else{
						var count = 0;
  							count++;
  							console.log("added", snap.key());
							// length will always equal count, since snap.val() will include every child_added event
							// triggered before this point
						ref.once("value", function(snap) {
  						console.log("initial data loaded!", Object.keys(snap.val()).length === count);
							});
						}
				});
	},

	loadFirepad: function(){
		this.firepadRef = new Firebase('https://focused0ne.firebaseio.com/firepad');
  			this.codeMirror = CodeMirror(this.$.firepad, { lineWrapping: true });
  			this.firepad = Firepad.fromCodeMirror(this.firepadRef, this.codeMirror,
      		{richTextShortcuts: true, richTextToolbar: true, defaultText: 'Welcome to the Focused Data Administrator' });
			this.passage_width = 400;
	},

_savePassage: function(){
	var blurb = this.passageBlurb;
	var passageTitle = this.passageTitle;
	var self = this;
	var passageContent = self.firepad.getText();
			var truePassageContent = passageContent.replace(/[\—]/g, " — ");
			var arrayPassed=truePassageContent.split(/\s/g);
			self.order =arrayPassed.length;
			self.paragraphArray = truePassageContent.split(/\n/);
			var ref = new Firebase("https://focused0ne.firebaseio.com/passagesDestinations");
				self.passageArray = [];
				var i = self.paragraphArray.length-1;
				for(; i> 0; i--)
					{
						console.log(i + " " + self.paragraphArray[i]);
					var wordCounter = 0;
					var newPara = false;
					var wordArray = self.paragraphArray[i].split(/\s/g);
					var paraWordRemaining = wordArray.length-1;
					var paragraph_number = Math.ceil(i/2);
					var isLastWordOfPara =false;
					var currentWord;
					
	
					while(paraWordRemaining>=0)
					// para word loop
					{
							self.order--;
							self.wordCounter--;
							if (paraWordRemaining==0){
								newPara = true;
								
								
							}
							else if(wordCounter==0)
							{ 
			
								isLastWordOfPara = true;
							}
							else{
								newPara=false;
								isLastWordOfPara=false;
							
							}
								
								currentWord = wordArray[paraWordRemaining];	      				
								self.push("passageArray",
									{ 
										"passageTitle": passageTitle,
										"passageBlurb": blurb,
										'order': self.order,
										'word' : currentWord, 
										'newPara': newPara,
										'paragraph_number': paragraph_number,
										'isLastWordOfPara':isLastWordOfPara
									});
								wordCounter++;
								paraWordRemaining--;
							} //SINGLE word entry ends here, WOULD LOVE TO CUT THIS IN HALF
						}//SINGLE line loop
					//this is the paragraph for loop
					var arrayPassage = self.passageArray.reverse();
					ref.child('new_Passage_1').set(arrayPassage);
					console.log(arrayPassage);
					self.passageArray = [];
			//	this is the loop for a whole passage. When Dynamic this loop goes away	
		//this ends the firepad stuff			
	},
	
		clearPassage: function(){
			var adminStorage2 = window.localStorage;
			var len = this.superItemArray.length;
			var franklin = this.superItemArray[1];
			var name = this.superItemArray[1].Full_Name;
			var email = this.superItemArray[1].Email;
			alert(JSON.stringify(this.superItemArray[1]));
			adminStorage2.setItem(name,email,len);
			
		},
		ready: function() { 
		
		},
 		conttap: function() {
 			 var pages = this.$.assistantPages;
    			pages.selectNext();
  				
  				},
  		flattap: function() {
			this.$.dragDialogTwo.open();			
	},
		back: function(){
			var pages = this.$.assistantPages;
    			pages.selectPrevious();
	},
	getFocused: function(){
		this.getFocused = !this.getFocused;
	},
		_startDrag: function(e){
		
			//console.log(e);
			this.dragging=true;
			var dragbox = this.$.dragDialogTwo.getBoundingClientRect();
			this.offsetX = e.offsetX;
			//console.log(this.offsetX);
			var Xoff = this.offsetX = e.offsetX;
			var Yoff = this.offsetY = e.offsetY;
			//console.log(Yoff);
			document.captureEvents(Event.MOUSEMOVE);
			document.onmousemove = dragmeplease;
			function dragmeplease(mp){
				var _x = mp.clientX - 80;
				var xString = _x.toString() + 'px';
				var	_y = mp.clientY -80; 
				var yString = _y.toString() + 'px';
		  		document.querySelector('#dragDialogTwo').style.top = yString;
		  		//console.log("_y has this value here " + _y);
		  		document.querySelector("#dragDialogTwo").style.left = xString;
		  		//console.log(_x + " that was x");
		  	document.captureEvents(Event.MOUSEUP);
			document.onmouseup = endThisPlease;
			function endThisPlease(omu){
				//console.log(omu.detail);
				document.onmousemove = null;
				document.onmouseup = null;
			}
	
	}
} 
});
</script>
</dom-module>
<!--
getData: function(argItem)
	{
		
		this.fcid = argItem;
		if(this.scores.hasOwnProperty(argItem))
		{
		
			return ['PRETEST: ' + this.scores[argItem].scoresPreTest + "  \n\r",
					'TEST 1: ' + this.scores[argItem].scoresTest1 + "    |||    ",
					'TEST 2: ' + this.scores[argItem].scoresTest2 + "    |||    ",
					'TEST 3: ' + this.scores[argItem].scoresTest3 + "    |||    ",
					'TEST 4: ' + this.scores[argItem].scoresTest4 + "    |||    ",
					'TEST 5: ' + this.scores[argItem].scoresTest5 + "    |||    ",
					'TEST 6: ' + this.scores[argItem].scoresTest6 + "    |||    ",
					'REAL SAT: ' + this.scores[argItem].realSAT + "    |||    "
					];
		}
	},
<h3> Cell Creation Page</h3>
				<paper-input>lolo</paper-input>
				<paper-input>lolo</paper-input>
				<div style="border: 5px ridge silver; width: 240px; height: 120px;"> 
					<h6>BUILD HERE</h6>
				</div>
				<paper-button>Save To Collection</paper-button>
				<input list="collectionsList" placeholder="Collection List">
					<data-list name='collectionsList'>
						<option>1</option>
						<option>2</option>
						<option>3</option>
						<option>4</option>
						<option>5</option>
					</data-list>
				<h3> Card Creation Page</h3>
				<paper-input>lolo</paper-input>
				<paper-input>lolo</paper-input>
				<div style="border: 5px ridge silver; width: 240px; height: 120px;"> 
					<h6>BUILD HERE</h6>
				</div>
				<paper-button>Save To Collection</paper-button>
				<input list="collectionsList" placeholder="Collection List">
					
				<h3> Layout Creation Area</h3>
				<paper-input>lolo</paper-input>
				<paper-input>lolo</paper-input>
				<div style="border: 5px ridge silver; width: 240px; height: 120px;"> 
					<h6>BUILD HERE</h6>
				</div>
				<paper-button>Save To Collection</paper-button>
				<input list="collectionsList" placeholder="Collection List">
					
	
			<h3> Graphs and other Data Representation</h3>
				<paper-input>lolo</paper-input>
				<paper-input>lolo</paper-input>
				<div style="border: 5px ridge silver; width: 240px; height: 120px;"> 
					<h6>BUILD HERE</h6>
				</div>
				<paper-button>Save To Collection</paper-button>
				<input list="collectionsList" placeholder="Collection List">
					<datalist id="collectionsList">
						
					</datalist>
			<h3> Build Elements From Template Elements</h3>
				<p class="assistantView container" no-cancel-on-outside-click="true">
		
				
				<h3>Your Element Collections </h3>
				
				<details>
				<summary> <b>Dashboard Top-View Collection</b></summary>
					<ul> Here are your Elements As Assembled in your Top-View Dashboard
						
						<li> Six with Picture</li>
					</ul>
				</details>
				<details>
				<summary> <b>Dashboard Top-Bottom Grid-Full View Collection</b></summary>
					<ul> Here are your Elements As Assembled in your Top-Bottom/ Grid-Full View Collection
						
						<li> Six with Picture</li>
					</ul>
				</details>
				<details>
				<summary> <b>DashBoard Four Panel Two-by-Two Collection</b></summary>
					<ul> Here is your Four Panel Collection
						
						<li> Six with Picture</li>
					</ul>
				</details>
				<details>
				<summary> <b>DashBoard Four Panel Full Screen Collection</b></summary>
					<ul> Here is your Four Panel Full Screen Collection
					<template is="dom-repeat" items={{superItemArray}}>
						<li>{{item.fcid}}</li>
						<li>{{item.Email}}</li>
						<li>{{item.Full_Name}}</li>
					
						</template>
					</ul>
				</details>
				-->		
				<!--"\n Akira came directly, breaking all tradition. Was that it? Had he followed form—had he asked his mother to speak to his father to approach a go-between—would Chie have been more receptive? \n He came on a winter’s eve. He pounded on the door while a cold rain beat on the shuttered veranda, so at first Chie thought him only the wind. The maid knew better. Chie heard her soft scuttling footsteps, the creak of the door. Then the maid brought a calling card to the drawing room, for Chie. \n Chie was reluctant to go to her guest; perhaps she was feeling too cozy. She and Naomi were reading at a low table set atop a charcoal brazier. A thick quilt spread over the sides of the table so their legs were tucked inside with the heat.  \n “Who is it at this hour, in this weather?” Chie questioned as she picked the name card off the maid’s lacquer tray. \n “Shinoda, Akira. Kobe Dental College,” she read. \n Naomi recognized the name. Chie heard a soft intake of air. \n “I think you should go,” said Naomi. \n Akira was waiting in the entry. He was in his early twenties, slim and serious, wearing the black military-style uniform of a student. As he bowed-his hands hanging straight down, a black cap in one, a yellow oil-paper umbrella in the other—Chie glanced beyond him. In the glistening surface of the courtyard’s rain-drenched paving stones, she saw his reflection like a dark double. \n “Madame,” said Akira, “forgive my disruption, but I come with a matter of urgency.” \n His voice was soft, refined. He straightened and stole a deferential peek at her face. \n In the dim light his eyes shone with sincerity. Chie felt herself starting to like him. \n “Come inside, get out of this nasty night. Surely your business can wait for a moment or two.” \n “I don’t want to trouble you. Normally I would approach you more properly but I’ve received word of a position. I’ve an opportunity to go to America, as dentist for Seattle’s Japanese community.” \n “Congratulations,” Chie said with amusement. “That is an opportunity, I’m sure. But how am I involved?” \n Even noting Naomi’s breathless reaction to the name card, Chie had no idea. Akira’s message, delivered like a formal speech, filled her with maternal amusement. You know how children speak so earnestly, so hurriedly, so endearingly about things that have no importance in an adult’s mind? That’s how she viewed him, as a child. \n It was how she viewed Naomi. Even though Naomi was eighteen and training endlessly in the artsneeded to make a good marriage, Chie had made no effort to find her a husband. Akira blushed. \n “Depending on your response, I may stay in Japan. I’ve come to ask for Naomi’s hand.” \n Suddenly Chie felt the dampness of the night. \n “Does Naomi know anything of your... ambitions?” \n “We have an understanding. Please don’t judge my candidacy by the unseemliness of this proposal. I ask directly because the use of a go-between takes much time. Either method comes down to the same thing: a matter of parental approval. If you give your consent, I become Naomi’s yoshi. We’ll live in the House of Fuji. Without your consent, I must go to America, to secure a new home for my bride.” \n Eager to make his point, he’d been looking her full in the face. Abruptly, his voice turned gentle. \n “I see I’ve startled you. My humble apologies. I’ll take no more of your evening. My address is on my card. If you don’t wish to contact me, I’ll reapproach you in two weeks’ time. Until then, good night.” He bowed and left. Taking her ease, with effortless grace, like a cat making off with a fish. \n “Mother?” Chie heard Naomi’s low voice and turned from the door. “He has asked you?” \n The sight of Naomi’s clear eyes, her dark brows gave Chie strength. Maybe his hopes were preposterous. \n “Where did you meet such a fellow?” Chai began.  “Imagine! He thinks he can marry the Fuji heir and take her to America all in the snap of his fingers!” \n Chie waited for Naomi’s ripe laughter. Naomi was silent. She stood a full half minute looking straight into Chie’s eyes. Finally, she spoke: \n “Mother.” \n “Yes?” \n “I mean to have him.”\n\n";-->
	<!--	var setFB = new Firebase("https://focusedstaging1.firebaseio.com/students"); 
	    var self = this;
	    setFB.on("value", function(snap){
	    var theSet = snap.val();
		//console.log(theSet);
	    var counterone = 0;
		var keyfirst = Object.keys(theSet);
		var limit = keyfirst.length;
		//console.log(limit);
	
	     for(counterone = 0; counterone < limit; counterone++){
	     	var testKeys =  Object.keys(theSet[keyfirst[counterone]].test_results);
			var testCounter = testKeys.length;
	     	
	     	var studenters = keyfirst[counterone];
			//alert(testCounter + "c " + studenters);
			var full = theSet[keyfirst[counterone]].first_name + " " + theSet[keyfirst[counterone]].last_name;
			self.push('superItemArray', {
						'Full_Name' : full,
						'fcid': theSet[keyfirst[counterone]].student,
						'Email': theSet[keyfirst[counterone]].email,
						'Test_Results': {function(){
			
					     	var testFB = new Firebase("https://focusedstaging1.firebaseio.com/test_results");
					     	var thisTestResult = this;
					     	testFB.orderByChild('student').equalTo(studenters).on("value", function(snapshot){
					    			var testies = snapshot.val();
					    			var testcounter = testies.length;
					    			//console.log(testcounter);
					    			var i = 0;
					    			for(i=0; i<testcounter; i++){
						     			var keysInTestResults = Object.keys(testies);
						     			var FITRs = keysInTestResults.length;
						     			console.log(Object.keys(testies[keysInTestResults[j]]));//values we want;
						     			var scoreHeaders = Object.keys(testies[keysInTestResults[0]]);
										var it = testies[keysInTestResults[j]].values();
										var entry;
											while (!(entry = it.next()).done) {
    											console.log(entry.value);
    											self.push('superItemArray', entry.value);
												}
											//console.log(entry.value);
												return entry.value;
										};
	     							
	    							});
	    						}
	     					}
						});
					
				}
			});-->