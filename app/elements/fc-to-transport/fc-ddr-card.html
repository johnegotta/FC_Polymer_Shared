
<dom-module id="fc-ddr-card">
 <template>
<style>
 :host{
          margin: 7px 8px 8px 8px;
          min-width: 42px;
          max-width: 1880px;
          min-height: 64px;
          max-height: 1900px;
          position: absolute;
          background: white;
          padding: 8px;
    
        }
     paper-header-panel {
    
        max-width: 1850px;
        min-width: 98%;
        min-height: 52px;
        margin: 4px;
         position: relative; 
        border: 4px solid #efefef;
        @apply(--shadow-elevation-2dp);
      }
      .paper-header {
        height: 46px;
        font-size: 21px;
        line-height: 25px;
        padding: 4px;
        color: white;
        transition: height 0.2s;
        margin-bottom: 5px;
      }
   
      .content {
        max-height: 2500px;
        min-height: 64px;
        overflow-y: scroll;
        
   
      }
      .tiny{
        height: 42px;
        font-size: 16px;

      }
      .cover {
        margin: 2px;
      }
      .magenta .paper-header {
        background-color: magenta;
      }
      .darkBlue .paper-header {
        background-color: #008;

      }
      .blue .paper-header {
        background-color: var(--paper-light-blue-500);
      }
      .red .paper-header {
        background-color: var(--paper-red-500);
      }
      .orange .paper-header {
        background-color: var(--paper-amber-500);
      }
      .green .paper-header {
        background-color: var(--paper-green-500);
      }
      .cyan .paper-header {
        background-color: var(--paper-cyan-500);
      }
      .lime .paper-header {
        background-color: var(--paper-lime-500);
      }
      .pink .paper-header {
        background-color: var(--paper-pink-a200);
      }

		
</style>

  
<!-- on-track="_focusedDraggable" -->
  <paper-header-panel id="myPanel" drags="true" style$="height: [[currentHeight]]; width: [[currentWidth]];" class$="[[headClass]] [[verticalClass]] layout flex around-justified">
  <div class="paper-header layout horizontal center-justified" style$="text-align: center; height: [[computeHeadHeight(isMini, isPage, isColumn, isCard, isCounter, isPicker)]]">
  <iron-icon 
            icon="icons:highlight-off" 
            name="fc-dialog-closer"
            description="designed to close the dialog"
            class="menuItems-light"
            hidden="{{!isResizing}}"
            on-tap="falseClose"
            style$="position: absolute; z-index: 45; border-radius: 180px; background: [[_computeButtonBG(toggleColor)]]; width: 14px; height: 14px; border-shadow: 11px 4px 18px 7px #afafaf; right: 0px; top: 0px;"
          >
      </iron-icon>
<content select=".headerLeft">
</content>


     [[_computeHeader(headerTitle)]]
<content select=".headerRight">
        </content>


     </div>
  
        <div id="attachContent" class="content" style$="height: 100%; opacity: 1; z-index: 200; background: white;">
   <content id="cardContent" style="height: 100%;">




   </content>
   <content select=".daycard">
   </content>
  
          

           	
		</div>

    
 </paper-header-panel>    
      <section on-track="_resize" hidden="{{!isResizing}}" style="position: absolute; bottom: 0px; right: 0px; height: 8px; width: 100%; max-width: 1850px; padding: 4px; border: 2px white solid; border-radius:180px; background: aqua;"></section>     
</template>
    <script>
    
FcDdrCard=Polymer({
	is:'fc-ddr-card',
	behaviors:[
     "Polymer.IronFitBehavior", 
      "Polymer.IronResizableBehavior",
      "FCBehaviors.DraggableBehavior"

    ],

	properties: {
    verticalClass:{
      type: String,
      value: "vertical",
      reflectToAttribute: true,
      notify: true
    },
    focusedPlanner: {
      type: Boolean, 
      value: false,
      notify: true
    },
    headClass:{
      type: String,
      value: "blue",
      notify: true,
      reflectToAttribute: true
    },
    toggleColor:{
      type: Boolean,
      value: true,
      notify: true
    },
    headerTitle:{
      type: String,
      notify: true,
      reflectToAttribute: true
    },
    attachContent: {
      type: Array,
      value: [],
      reflectToAttribute: true,
      notify: true
    },
		drags:{
			type: Boolean, 
			value: false,
			notify: true,
      reflectToAttribute: true
		},
		isResizing: {
			type: Boolean,
			value: true, 
			notify: true,
      reflectToAttribute: true
		},
		isMini: {
			type: Boolean,
			value: function(){return false;},
			notify: true,
      reflectToAttribute: true
		},
		inputValue: {
				type: String,
				notify: true,
				reflectToAttribute: true
		},
    isColumn:{
        type: Boolean, 
        value: false,
        notify: true
    }, 
    isCard:{
        type: Boolean, 
        value: false,
        notify: true
    },
    isPage:{
      type: Boolean, 
        value: false,
        notify: true
    },
    dragCounter:{
      type: Number,
      value: 0,
      notify: true
    },
    isCounter:{
        type: Object,
        value: { counter: 0, size: "column"},
        notify: true
    },
		
    widthCounter:{
      type: Number,
      value: 0,
      notify: true
    },
  
      currentWidth: {
          type: String, 
          notify: true, 
          reflectToAttribute: true
      },
      currentHeight: {
          type: String, 
          notify: true, 
          reflectToAttribute: true
      },
      
      theId: {
      	type: String, 
      	notify: true,
      },
      id:{
      	type: String,
      	computed: "_computeId(theId, day)",
      	notify: true
      },
      dragCounter: {
        type: Number,
        value: 0,
        notify: true
      },
      dragCorrection: {
      	type:Number,
      	value: function(){return 0;},
      	notify: true
      }, 
      isPicker:{
        type: Boolean, 
        value: false, 
        notifyResize: true,
        reflectToAttribute: true
      }

    },
    ready: function(){
      this._computeCurrentHeight();
      this.startWidth();
    },
    
     attached: function(){
        var self=this;
      this.fire("mywidth", {mywidth: self, parent: self.parent});
      this.click();
       // this.startWidth();
       this.set("_notifyingDescendant", true);
           this.startHeight();

    },

    _computeHeader: function(headerTitle){
      return headerTitle;
    },
    computeHeadHeight: function(isMini, isPage, isColumn, isCard, isCounter, isPicker)
    {
      var height = (isColumn==true)?"98px;": isMini==true? "20px; font-size: 16px; font-weight: 700;":isCard==true?"46px;":isPicker==true?"32px;": "39px";
      return height;
      
    },
   
     startWidth: function(){
      var target=this;
      var oneW=target.getBoundingClientRect().width;
     var sWidth =window.getComputedStyle(this, null).getPropertyValue("width");
         console.log(sWidth,"window inner", window.innerWidth, "hhoooooj", oneW);
         if(this.focusedPlanner){
          var widthN=(Math.floor(.85*window.innerWidth)<1900)?(Math.floor(.85*window.innerWidth)).toString()+"px":"1850px";
          this.set("currentWidth", widthN);
         } 
         
      
         
        },
     startHeight: function(){
      var self=this;
      this.fire("mywidth", {mywidth: self, parent: self.parent});
     },
    onIronResize: function(){

      // this.resizeMe();
      // this.afterStartResize();
      // this.notifyResize();
    },
   
    _computeCurrentHeight: function(){
    	var ht=window.screen.height;
      ht=.88*(ht);
      ht=ht.toString()+"px";
    	if(this.currentHeight==undefined) {this.set("currentHeight", ht);}
    	
    	
    },
    _computeId: function(theId, day){
    	//console.log(theId, day, day, day, day, theId);

    },
    computeSelected: function(selectionArray){
      return "[name=first]";
    },
    
    _computeRelId: function(day){
    	 var dayId	= day.replaceAll("\\s+","");
    	 //console.log(dayId, dayId, dayId, dayId);
    	 return dayId;
    },
    computeId:function(theId){
    	//console.log(theId, theId, theId, theId, theId, theId);
    },
    _resize: function(e){
          var self=this;
          e.preventDefault();
          if(this.isResizing==true){
          switch(e.detail.state) {
                case 'start':
                var theId=this.relId;
                var elem=this.$$(theId);
                var sWidth =window.getComputedStyle(self.$.myPanel, null).getPropertyValue("width");
                self.set("currentWidth", sWidth);
              
                 break;
                case 'track':
                  var newheight = parseInt(self.currentHeight) + e.detail.ddy;
                  var nwidth = parseInt(self.currentWidth) + e.detail.ddx;
                  var trueWidth = nwidth.toString()+'px';
                  var trueHeight = newheight.toString()+'px';
                  
           
                  self.set("currentWidth",trueWidth);
                  self.set("currentHeight",trueHeight);
                  self.style.width= trueWidth;
                  self.style.height= trueHeight;
                
                  break;
                case 'end':
                  self.style.width= trueWidth;
                  self.style.height= trueHeight;
                  // self.notifyResize();
                  self.onIronResize();
                 // self.afterStartResize();
                  Polymer.dom.flush();
                  break;
              }
            }
        },
    
       falseClose: function(){
        this.toggleColor=!this.toggleColor;
        if(this.toggleColor===false){
        this.set('currentHeight', "128px");
      }
        else{
          this.set('currentHeight', "480px");
            }

       },
       _computeButtonBG: function(toggleColor){
        var returnVal=(toggleColor==false)?"red;":"green;";
        return returnVal;

       },

 
});
</script>
</dom-module>