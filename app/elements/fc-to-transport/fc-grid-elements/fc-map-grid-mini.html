<dom-module id="fc-mapped-grid">
 <template id="fc-mapped-grid-template">
 <style>
 :host{@apply(--layout-vertical);
  @apply(--layout-flex);

  margin: 12px 3px;
  padding: 4px;
  overflow:scroll;
  position: static;
  background: white;
  opacity: 1;
};
textarea{
 margin:0px; border: 1px #dfdfdf solid; box-shadow: 1px 3px 4px 2px #fafafa; cursor: cell; font-size: 18px; font-weight: 600; color: #009; font-family: merriweather; text-align: center; white-space: wrap;
  max-height: 45px; min-height: 45px; border: 1px solid #afafaf; padding-top: 4px; font-family: merriweather; color: #009; text-align: center; resize:none;
  @apply(--layout-self-shrink);
}
section{
  background:white;
 }
.userStyle{font-size:22px; font-weight: 900; font-style: italics; text-decoration: underline;}
textarea::-moz-selection { /* Code for Firefox */

}
paper-item{
border: 1px solid #afafaf;
}
.selected{
  border: dashed 2px #f2f735;
 -webkit-transition: border 0.9 ease, margin-top 0.9s ease, margin-right 0.9s ease;
  transition: border 0.9 ease, margin-top 0.9s ease, margin-right 0.9s ease;},
@-webkit-keyframes blink {
   from {
    border: dashed 1px
#f2f735;

  }

  to {
    border: dashed 3px 
#f2f735;
  margin-top:-1px;
    
  }
}
  
@keyframes blink {
  from {
    border: dashed 1px 
#f2f735;
margin-top:0px;
  }

  to {
       border: dashed 3px 
#f2f735;
  margin-top:-1px;
  margin-bottom:-1px;
    
  }
}
#myContextMenu{
  min-width: 280px; max-height: 420px; position: fixed; border:4px ridge gold; overflow-y: scroll; box-shadow: 5px 7px 11px 3px #afafaf;

}

textarea::selection {
    border: gold 2px solid;
}
  *{@apply(--layout-nowrap);}
</style>
 
 <array-selector id="columnSelector" items="{{dataArrays}}" multi toggle selected="{{selectedArraySet}}">
 </array-selector>
<!-- <a> -->
<div is-gridbox="true" on-mousedown="closemenu" id="mappedGridContainer" class="horizontal layout flex self-stretch reverse" style="min-width:66.99vw; background: aliceblue; max-width:88.99vw; min-height: 91vh; max-height:96vh; padding-top: 9px;">
<!--side utility editing menu for the spreadsheet-like versions-->

Turn<paper-icon-button icon="icons:dashboard" on-tap="arraySwap"></paper-icon-button>Page 
<div hidden="{{!four}}" id="hanger1" contenteditable="true" style="display:flex; flex-direction: column; flex-wrap:nowrap; max-width: 85%; width: auto;">
<div id="hanger3"  on-dblclick="insertRow" contenteditable="true" on-contextmenu="mycontextMenu" data-gh="true" data-payload$="{{col.data}}" on-focus="setValuesInMap" style="display:flex; flex-direction: row; flex-wrap:nowrap; max-width: 1800px; width: auto; overflow: scroll;">

</div>


</div>
<template is="dom-repeat"  id="mappedGridRepeater" observe="data selected" class="horizontal layout flex" id="template" index-as="columnIndex" items="{{selectedArraySet}}" as="col">
<!-- <a link={{}}> -->
    <div id$="divCol_[[columnIndex]]" hidden="{{four}}"style$="{{_computeSelectedHoverStyle(trigger, col.selected)}} position:" class="vertical layout container nowrap self-stretch">
          <section id$="header_[[columnIndex]]" class="horizontal layout flex nowrap center center-justified self-shrink" data-payload$="{{col.data}}" draggable="true" on-dragstart="startDrag" on-dragover="dragOver" on-drop="handleDrop" 
          style$="background:[[_computeHighlighted(col.selected, col.data, col.highlighted, trigger)]]; cursor:pointer; font-weight:700; color: #009; font-size: 18px; overflow: hidden; text-align: center; min-width:calc(100vw/28); border-radius: 2px; max-width: 210px; max-height: 58px; min-height: 38px;">
            {{col.name}} <input on-click="highlightCol" type="checkbox" name="hl" value="Bike" checked="{{computeColSelected(col.selected, trigger)}}">
          </section>    
          <template is="dom-repeat" id$="template_{{columnIndex}}" class="vertical flex layout" observe="highlight col row" is="dom-repeat" items="{{col.data}}">
               <!--          <a link={{}}> -->
    <textarea input-type="text" cell="{{item.row}}_{{item.col}}" draggable="true" on-dragstart="startDrag" on-dragover="dragOver" on-drop="handleDrop"  on-dblclick="selectTog" style="" id$="gridBox[[item.col]][[item.row]]" data-payload$="{{item.payload}}" contenteditable="true"  value="{{item.value}}" class$="{{_computeSelected(item.selected, item)}} cellClass" max-char="450">
                              </textarea>

                        
            <!--         </a> -->
              </template>
               </div>
               </template>
       <!--    <fc-fit-wrapper>
</fc-fit-wrapper>
    -->
<!--     </a> -->


</div>
<paper-listbox id="myContextMenu" hidden>
      <paper-item>
        <paper-swatch-picker>
        </paper-swatch-picker> Color Selector
    </paper-item>
    <template is="dom-repeat" items="{{contextMenuCategories}}" as="category" index-as="categoryIndex">
        <paper-item value="{{category.title}}">
            <details>
                <summary>{{category.title}}</summary>
                <paper-listbox style="min-width:240px; ">
                    <template is="dom-repeat" items="{{category.buttons}}" as="item">
                          <paper-item onclick="{{item.myFunction}}" btn-value="{{item.text.0}}" style$="padding: 0px; margin: 0px; font-size: 18px; font-weight: 700; font-family: merriweather; color: #009;{{_computeStyle(item.text.0, format.color, defaultFormat)}}">                {{item.text.0}}
                              <span  style="font-size: 26px; font-weight: 300; color: #009;">{{item.text.2}}</span>
                              <span style="font-size: 36px;">{{item.text.1}}</span> 
                          </paper-item>
                    </template> 
                </paper-listbox>
            </details>
        </paper-item>
    </template>
</paper-listbox>
<!-- </a> -->
 </template>
 <script>
 FcMappedGrid=Polymer({
 	is:"fc-mapped-grid",
  behaviors:[Polymer.Templatizer],
  listeners: {"color-picker-selected":"getcolor"},
 	properties: {
    comparisons:{
      type: Map,
      notify: true,
    },
    cellKey:{
      type: String,
      value: function(){return "comparisons_0_0_";},
      notify: true
    },
    cellValue: {
      type: String,
      value: function(){return "Monthly";},
      notify: true,
    },
    format:{
      type: Object,
      value:function(){return {};},
      notify: true,
    },
    defaultFormat:{
        type:Object,
        value:function(){
            return {"color": "#009", "background": "#fefefe", "header_backgroundColor":"aliceblue", "fontSize": "18px", "fontWeight": "600", "fontFamily": "merriweather", "lineHeight": "1.15", "border": "1px #afafaf solid", "styleText": "margin:0px; box-shadow: 1px 3px 4px 2px #fafafa; cursor: cell;font-size: 18px; font-weight: 600; color: #009; font-family: merriweather; text-align: center; white-space: wrap; max-height: 45px; min-height: 45px; border: 1px solid #afafaf; padding-top: 4px; font-family: merriweather; text-align: center; font-size: 18px; resize:none;"};
          },
        notify: true 
    },
    selectedArraySet:{
        type:Array,
        value:function(){return [];},
        notify: true
    },
    dataArrays:{
        type:Array,
        value:function(){return [];},
        notify: true,
    },
    spanText:{
        type: String,
        value: function(){return "";},
        notify: true
    },
      spanSpanSmallSymbols:{
        type: String,
        value: function(){return "";},
        notify: true
    },
      spanLargeSymbols:{
        type: String,
        value: function(){return "";},
        notify: true
    },
    columns2:{
      type: Array,
      value: function(){return [];},
      notify:true,
    },
    contextMenuCategories:{
        type:Array,
        value:function(){return [];},
        notify: true
    },
    columns3:{
      type: Array,
      value: function(){return [];},
      notify:true,
    },
    mapArray:{
        type: Array,
        value: function(){
            return[];
        },
        notify: true,
    },

    columns:{
      type: Array,
      value: function(){return [];},
      notify:true,
    },
    gridEvent:{
        type: Object,
        value: function(){return {};},
        notify: true, 
    },
    userSelection:{
      type:Boolean,
      value: function(){return false;},
      notify: true,
      observer: "userSelectionArrayTrigger",
    },
    
    
    btnValue:{
      type: String,
      value:function(){return "";},
      notify: true
    },
    arraysIndex:{
        type: Number,
        value: function(){return 0;},
        notify:true,
    },
    selectedArray:{
      type:Array,
      value:function(){return [];},
      notify: true,
    },
    four:{     type:Boolean,
     computed:"computefour(arrayIndex)",
      notify: true,
    },
    columnArchive:{
      type: Array,
      value: function(){return [];},
      notify: true
    },
    rowArchive:{
      type:Array,
      value:function(){return [];},
      notify: true
    },
	 	drags:{type: Boolean, value: function(){return true;}, notify: true},
	 	
 		},

  mycontextMenu(e){
    console.log(e);
    if(e.target.btnValue){
    var btnValue=e.target.btnValue;
      this.set("btnValue", btnValue);
    } 
    this.set("gridEvent", e);
    console.log(this.gridEvent);
    this.$.myContextMenu.hidden=false;
    this.$.myContextMenu.style.left=(e.clientX-330)+"px";
    this.$.myContextMenu.style.top=(e.clientY)+"px";
    this.$.myContextMenu.style.zIndex=25000;
    console.log(e.target);
    var cell=e.target;
    var cellId=cell.getAttribute("id");
    var key=cellId.split("_");
    
     var allSymbols= `‚ûî ‚ù∂ ‚úÇ ‚úé ‚úí ‚úú ‚ùö ‚ù∂ ‚ûÄ ‚ûû ‚òö ‚òõ ‚ò∞ ‚ò± ‚ò∑ ‚òë ‚òê ‚òé ‚òè ‚ñ∫ ‚ñº ‚ñ≤ ‚óÑ ‚áí ‚ñê ‚ñà ‚ñÑ ‚ñÄ`;
        var addOneColumnRight=["+1 Column Right: ","", " ‚úú ‚ñê ‚òõ"],
         leftAddOneColumn=["+1 Column Left: ",""," ‚úú ‚ñê ‚òö"],
         deleteThisColumn=["Delete Column: ","", " ‚úÇ ‚ñê"],
         restoreThisColumn=["Restore Column: ", "‚ò§", "‚ò§‚ñê ‚ò§"],
         addOneRowBelow=["+1 Row Below:", ," ‚ò∞ ‚ñº "],
         addOneRowAbove=["+1 Row Above:", ," ‚ò∞ ‚ñ≤ "],
          deleteThisRow=["Delete Row: "," ", " ‚úÇ ‚ò∞"],
          restoreThisRow=["Restore Row: ","‚ò§", " ‚ò§ ‚ò∞ ‚ò§ "],
         highlightColumn=["Highlight Selection: ",""," ‚úí ‚ùö "],
         returnToDefaultHighlighting=["Remove Highlighting: ", ," ‚úÇ ‚úí"],
         applyThisTextColor=["Apply This Text Color:"," ‚úé" , "‚ñÄ"],
         returnToDefaultTextColor=["Apply Base Text Color:"," ‚úé " , "‚ñÄ"],
         applyThinTextWeight=["Thin Text Weight:", ,"ùíØùíΩùíæùìÉ"],
         applyMediumTextWeight=["Medium Text Weight:", ,"Medium"],
         applyStrongTextWeight=["Strong Text Weight", "STRONG"],
         applyRobotoFontFamily=["Roboto Font Family", ," ROBOTO"],
         applyMerriweatherFontFamily=["Merriweather Font Family", ," Merriweather"],
         applyCourierFixedWidthFontFamily=["Courier Font Family: ", ," Courier"],
         applyItalics=["Italics:", ,"Italics"], 
         applyUnderline=["Underline:", ,"Underline"], 
         applyStrikeThrough=["Strike-Through:", ,"Strike-Through"];
          var columnMenu=[
          {   "title": "Add Columns", 
              "buttons": [
              {"text":addOneColumnRight,"myFunction": this.addColumn.bind(this)}, 
              {"text": leftAddOneColumn, "myFunction": this.addColumn.bind(this)}
            ]
          }, 
          {
              "title":"Delete Column", 
              "buttons":[
                  {"text":deleteThisColumn, "myFunction": this.deleteThisColumn.bind(this)}, 
                  {"text":restoreThisColumn, "myFunction":this.restoreThisColumn.bind(this)}
                  ]
          }
        ];
        var rowMenu=[
          {   "title": "Insert Row", 
              "buttons": [
              {"text":addOneRowAbove,"myFunction": this.insertRow.bind(this)}, 
              {"text": addOneRowBelow, "myFunction": this.insertRow.bind(this)}
            ]
          }, 
          {   "title": "Delete Row", 
              "buttons": [
              {"text":deleteThisRow,"myFunction": this.deleteRow.bind(this)}, 
              {"text": restoreThisRow, "myFunction": this.restoreRow.bind(this)}
            ]
          }
          ]; 
        var basemenu=[{
              "title":"Highlight Color", 
              "buttons":[{"text": highlightColumn,"myFunction":this.stylePropertySelection.bind(this)}, {"text":returnToDefaultHighlighting, "myFunction":this.stylePropertySelection.bind(this)}]
          },
          {   "title": "Text Color",
              "buttons": [
              {"text": applyThisTextColor, "myFunction":this.stylePropertySelection.bind(this)},
              {"text":returnToDefaultTextColor, "myFunction":this.stylePropertySelection.bind(this)}
              ] 
          },
          {    "title": "Text Weight",
                "buttons": [
                    {"text":applyThinTextWeight,"myFunction":this.stylePropertySelection.bind(this)},
                    {"text":applyMediumTextWeight,"myFunction":this.stylePropertySelection.bind(this)},
                    {"text": applyStrongTextWeight, "myFunction":this.stylePropertySelection.bind(this)
              }
            ] 
          },
          {  "title": "Font Family",
             "buttons": [
              {"text":applyRobotoFontFamily,"myFunction":this.stylePropertySelection.bind(this)},
              {"text":applyMerriweatherFontFamily,"myFunction":this.stylePropertySelection.bind(this)},
              {"text": applyCourierFixedWidthFontFamily, "myFunction":this.stylePropertySelection.bind(this)
              }
            ],
          },
          {   "title":"Font Styles",
              "buttons": [
                  {"text":applyItalics,"myFunction":this.stylePropertySelection.bind(this)},
                  {"text": applyUnderline,"myFunction":this.stylePropertySelection.bind(this)},
                  {"text": applyStrikeThrough, "myFunction":this.stylePropertySelection.bind(this)},
                  {"text": ["Normal: ", , " Normal"], "myFunction":this.stylePropertySelection.bind(this)
                } 
            ], 
          }
          ];
    if(key[2]==0){
      var returnColumnHeader =columnMenu.concat(basemenu);
    this.setMenuEntries(returnColumnHeader);
    }
    else if(key[1]==0&&key[2]!=0){
        var returnRowMenu=rowMenu.concat(basemenu);
         this.setMenuEntries(returnRowMenu);
    }
    else if(key[1]&&key[2]){ this.setMenuEntries(basemenu);}
    else{this.setMenuEntries([]);}
  },

  setMenuEntries(returnValue){
      this.set("contextMenuCategories", returnValue);
  },
  closemenu(e){
    this.$.myContextMenu.hidden=true;
  },
  insertRow(e){
    var eid=this.gridEvent.target.getAttribute("id");
      var key=eid.split("_");
      
      if(key[1]==0 &&key[2]!=0){
      var rowNum=key[2];
      var after=(e.target.btnValue.match("Row Below"))?true: false;
      var childColumn= Polymer.dom(this.$.hanger3).children;
      var rows=childColumn[0].children.length;
       var count=childColumn.length;
       for(var k=0;k<count; k++)
       {
          var colNum=childColumn[k].getAttribute("id");
          var colNum=colNum.split("_");
        var elem=document.createElement("TEXTAREA");
        elem.setAttribute("style", "max-height: 55px; min-height: 18px; border: 1px solid #afafaf; padding-top: 4px; height: 33px!important; font-family: merriweather; color: #009; text-align: center; font-size: 18px; font-weight: 600; resize:none;");
         var nKey="comparisons_"+colNum[1]+"_"+rows+"_";
         elem.setAttribute("id", nKey);
         elem.value="--";
         this.comparisons.set(nKey,[elem.value, elem]);
         var theId="#comparisons_"+colNum[1]+"_"+key[2]+"_";
         // console.log(this.$$(theId));
         console.log(theId);
        if(after===false)
        {   //console.log(this.$$(theId));
          Polymer.dom(childColumn[k]).insertBefore(elem, this.$$(theId));
           var style=Polymer.dom(elem).nextSibling.style.cssText
          elem.style.cssText=style;
          this.comparisons.set(nKey, [elem.value,elem]);
         }
        else if(after===true&&key[2]<rows)
            {
              Polymer.dom(childColumn[k]).insertBefore(elem, this.$$(theId).nextSibling);
                var style=Polymer.dom(elem).nextSibling.style.cssText
                elem.style.cssText=style;
                this.comparisons.set(nKey, [elem.value,elem]);
         
            }
        else if(after===true&&key[2]==rows)
            {
              Polymer.dom(childColumn[k]).appendChild(elem);
                var style=Polymer.dom(elem).previousSibling.style.cssText
                elem.style.cssText=style;
                this.comparisons.set(nKey, [elem.value,elem]);
         
            }
       
       }
      }
  },
  deleteRow(e){
    var children=Polymer.dom(this.$.hanger3).children;
    var columnNumberArray=[],
    columnArrayIds=[],
    rowArray=[];
    children.forEach(function(col,index, array){
        var colId=col.getAttribute("id");
        columnArrayIds.push(colId);
        var colIdMiniArray=colId.split("_");
        columnNumberArray.push(colIdMiniArray[1]);
    });
    var baseId=this.gridEvent.target.getAttribute("id"),
    rowIndex=Polymer.dom(children[0]).children.indexOf(this.gridEvent.target),
    splitBaseId=baseId.split("_");
    console.log(rowIndex,rowIndex,rowIndex,rowIndex,rowIndex,rowIndex,rowIndex,rowIndex,rowIndex,rowIndex,rowIndex,rowIndex,rowIndex);
    rowArray=columnNumberArray.map(function(col, index,array){
        var theId="#"+splitBaseId[0]+"_"+col+"_"+splitBaseId[2]+"_";
        var elem=this.$$(theId);
        var theId2="#" + columnArrayIds[index];
        var parent=this.$$(theId2);
        Polymer.dom(parent).removeChild(elem);
        return elem;
    }, this);
    this.push("rowArchive", [rowIndex, rowArray]);
    
    },
  restoreRow(e){
   
     var children=Polymer.dom(this.$.hanger3).children;
     console.log(children,this.rowArchive[0][1],this.rowArchive[0][0], Polymer.dom(children[0]).children);
     var counter=children.length,
     i=0,
      row=this.pop("rowArchive");
      for(i=0; i<counter; i++){
        var column=Polymer.dom(children[i]).children;
         var beforeElement=column[row[0]];
         Polymer.dom(children[i]).insertBefore(row[1][i],beforeElement);
      }
  },
  addColumn(e){
    if(e.target.btnValue){
      this.set("btnValue",e.target.btnValue);
    }
    var parent=this.gridEvent.target.parentElement;
    var pParent=parent.parentElement;
    var columns=pParent.children;
    var eid=this.gridEvent.target.getAttribute("id");
      var key=eid.split("_");
    if(key[2]==0){
      var children=Polymer.dom(parent).children;
      var id=parent.getAttribute("id");
      var column =document.createElement("DIV");
        column.setAttribute("style","display:flex; flex-direction: column; margin: 0px; flex-wrap:nowrap; max-height: 1820px;");
          var colNum=columns.length;//need to push on this length
         
          var att=parent.getAttribute("id");
          var colKey=att.split("_");
          if(this.btnValue && this.btnValue.match("Left") && this.btnValue.match("Left").length>0){
           var columnId="column_"+(colNum);
          column.setAttribute("id", columnId); 
          Polymer.dom(this.$.hanger3).insertBefore(column, parent);
        }
      else{
          var nsib=Polymer.dom(parent).nextSibling;

          var columnId="column_"+(colNum.toString());
          column.setAttribute("id", columnId);
          Polymer.dom(this.$.hanger3).insertBefore(column,nsib);
                      console.log(columnId);
      }
       this.push("columns4",["znother", "column"]);
          var numCells=children.length;
    for(var j=0; j<numCells;j++)
    {
      var trueVal=children[j].getAttribute("id");
      trueVal=trueVal.split("_");
      var val=trueVal[2];
      elem=document.createElement("TEXTAREA");
      var key="comparisons_"+colNum+"_"+val+"_";
      elem.setAttribute("id",key);
      if(j==0){
      elem.setAttribute("style", "max-height:65px; border: solid 1px #009; min-height: 18px; margin:0px; height: 23px!important; font-family: merriweather; background: aliceblue; color: #009; text-align: center; font-size: 18px; font-weight: 700; resize:none;");
      }
      else{

           elem.setAttribute("style", "max-height: 55px; min-height: 18px; border: 1px solid #afafaf; padding-top: 4px; height: 33px!important; font-family: merriweather; color: #009; text-align: center; font-size: 18px; font-weight: 600; resize:none;");
         }
       elem.value="--";
        console.log(columnId);
      Polymer.dom(column).appendChild(elem);
     this.comparisons.set(key,[elem.value, elem]);
    }
  
      }
    },

  deleteThisColumn(e){
    
      if(e.target.btnValue){
          this.set("btnValue",e.target.btnValue);
      }
      var parent=this.gridEvent.target.parentElement;
      var key= parent.getAttribute("id");
      var t=new Date().getTime();
       var grandParent=parent.parentElement;
       var nodeArray=Polymer.dom(grandParent).children;
      var index= nodeArray.indexOf(parent);
      this.push("columnArchive", [index,parent, t]);
      Polymer.dom(grandParent).removeChild(parent);
  },
  restoreThisColumn(e){
        var colArchArray=this.pop("columnArchive");
        var columnChildren=Polymer.dom(this.$.hanger3).children;
        var beforeElement=columnChildren[colArchArray[0]];
        Polymer.dom(this.$.hanger3).insertBefore(colArchArray[1],beforeElement);   
  },
  stylePropertySelection(e){
    if(this.comparisons&&this.comparisons.get("comparisons_0_15_")){
    var value=this.comparisons.get(this.gridEvent.target.id);
    var keys=this.gridEvent.target.id.split("_");
    this.set("btnValue", e.target.btnValue);
    var text=this.btnValue,
    defaultformat = this.defaultFormat,
    formatcolor=this.format.color;  
    var property=(text.match("Highlight Selection"))?`background: ${formatcolor};`:(text.match("Remove Highlighting"))?`background: ${defaultformat.background};`:(text.match("Apply This Text Color"))?`color: ${formatcolor};`:(text.match("Apply Base Text Color"))?`color: ${defaultformat.color};`:(text.match("Thin Text Weight"))?`font-weight: 300;`: (text.match("Medium Text Weight"))?`font-weight: 600;`: (text.match("Strong Text Weight"))?`font-weight: bold;`: (text.match("Roboto Font Family"))?`font-family: Roboto;`:(text.match("Merriweather Font Family"))?`font-family: merriweather;`: (text.match("Courier Font Family"))?`font-family: courier;`:(text.match("Italics"))?`font-style: italic;`:(text.match("Underline"))?`text-decoration: underline;`:(text.match("Strike-Through"))?`text-decoration: line-through;`: `text-decoration: none; font-style: normal;`;
    for(var i=1;i<50;i++)
    {
          if(value  && keys[2]==0)
          {
            var newKey="comparisons_"+keys[1]+"_"+i+"_";
             var value=this.comparisons.get(newKey);
           }
          else if(value && value[1] && keys[1]==0 && keys[2]!=0)
          {
            var newKey="comparisons_"+i+"_"+keys[2]+"_";
             var value=this.comparisons.get(newKey);
          }
          else{
            i=52;
            }
          if(value && value[1])
            { 
              var style=value[1].style.cssText;
              if(style.match(property))
                {
                  var replacer=propertyName[0]+/\[[a-z]+\]:[a-z]+;/;
                  style=style.replace(replacer, "");
                    style=style+property;
                }
              else
                {
                  style=style+property;
                }
              value[1].style=style;
            }   
            else{i=52;}
      }//end for loop 
    }//end initialization if for values
  },
  selection(){},
  getcolor(e){
    console.log(e.detail.color, e.target.toColor);
    this.set("format.color", e.detail.color);
  },
  _computeStyle(text, formatcolor, defaultformat){
      retVal=(text.match("Highlight Selection"))?`background: ${formatcolor};`:(text.match("Remove Highlighting"))?`background: ${defaultformat.background};`:(text.match("Apply This Text Color"))?`color: ${formatcolor};`:(text.match("Apply Base Text Color"))?`color: ${defaultformat.color};`:(text.match("Thin Text Weight"))?`font-weight: 300;`: (text.match("Medium Text Weight"))?`font-weight: 600;`: (text.match("Strong Text Weight"))?`font-weight: 900;`: (text.match("Roboto Font Family"))?`font-family: Roboto;`:(text.match("Merriweather Font Family"))?`font-family: merriweather;`: (text.match("Courier Font Family"))?`font-family: courier;`:(text.match("Italics"))?`font-style: italic;`:(text.match("Underline"))?`text-decoration: underline;`:(text.match("Strike-Through"))?`text-decoration: line-through;`: `text-decoration: normal;`;
         //NOTE TODO: MUST SAVE THE SET OF PROPERTIES WILL OVERWRITE EACH TIME!!!
         return retVal;

  },
  
computefour(arrayIndex){
    return(arrayIndex===3);
},
  selectTog(e){
      console.log(e);
  },
ready(){
    var columns=this.setColumns();
     var headerArray=columns.map(function(val,index, array){
             return val.name;
        });
     console.log(headerArray, columns);
    var columnd=this.parser(headerArray,"accounting", columns);
    this.set("columns", columnd);
    this.parser2();
       this.parser3();
    this.push("dataArrays",this.columns);
    this.push("dataArrays", this.columns2);
    this.push("dataArrays",this.columns3);
        this.push("dataArrays",this.columns4);
    this.set("selectedArraySet", this.dataArrays[this.arrayIndex]);
    this.set("format.color","gold");
    this.set("format.application", "background");

    },
  arraySwap(e){
        var arrayNum=(this.arrayIndex===0)?1:(this.arrayIndex===1)?2:(this.arrayIndex===2)?3:0;
        this.set("arrayIndex", arrayNum);
        this.set("selectedArraySet", this.dataArrays[this.arrayIndex]);
  },
 
selectCell(e){
  if(this.userSelection===true&&this.four===false){
   var parentTemplate= e.model.dataHost;
   var model=parentTemplate.modelForElement(e.target);
   var item=parentTemplate.itemForElement(e.target);
   var key=parentTemplate.keyForElement(e.target);

   if(item.selected===false){
       model.set("item.selected",true);
       item.selected=true;
       e.target.selected=true;
    
  }
  else{
      model.set("item.selected",false);
      item.selected=false; 
      model.set("item.selected",false);
      item.selected=false;
      e.target.selected=false;
  }

     // console.log(e, model, item, key);
  if(item.selected===true){
      this.push("selectedArray", e.target);
      Polymer.dom(e.target).classList.add("selected");
    } 
  else{var index=this.selectedArray.indexOf(e.target);
          this.splice("selectedArray", index, 1);
  }
if(this.format.application&&this.selectedArray.length>0)
      {   this.selectedArray.forEach(function(val,i, arr){
          var attr="style." + this.format.application;
          Polymer.dom(val).setAttribute(attr,this.format.color);
          val.style[this.format.application]=this.format.color;
          val.setAttribute(attr, this.format.color);}, this);
     //archive this to undo formatting... a MUST
      }
    }
    if(this.four&&e.target.nodeName==="LI" && e.target.select){e.target.select=!e.target.select;}else{e.target.select=true;}
  },
  _computeSelected:function(sel, item){
      if(sel===true){return "selected";}else {return "";}

  },

  userSelectionArrayTrigger(newVal, oldVal){
    if(newVal!=null&&newVal===false&&this.selectedArray){
      this.selectedArray.forEach(function(val){ console.log(val);
        val.selected=false;
      });
    }
  },

  changePayload: function(e)
  {
    console.log(e, "I am in changePayload");
  },
  _computeCol: function(col){return col;},

  _computeSelectedHoverStyle(trigger, selected){
    var retVal=(selected===true)?"margin-top:-18px; margin-right: -12px; box-shadow: 7px 13px 28px 12px #afafaf; z-index:222222; border: gold 6px solid":"";
  //  console.log(selected);
    return retVal;

  },

  highlightCol: function(e)
  {   
      var item= this.$.mappedGridRepeater.itemForElement(e.target);
        var model= this.$.mappedGridRepeater.modelForElement(e.target);
        var setVal=(item.selected===false)?true: false;//cascade this down
        console.log(e,model,item);
      var counter=item.data.length;
      var resetVal=item, i=0;
        resetVal.selected=setVal;
        model.set("item.selected", setVal);
        for(i=0;i<counter;i++){
          model.set(["item.data",i,"highlighted"], setVal);
          model.set(["item.data",i,"selected"], setVal);
          item.data[i].highlighted=setVal;
         var nodes= Polymer.dom(this.root).querySelectorAll("INPUT");
          item.data[i].selected=setVal;
          }
        //console.log(item);
        this.set("trigger",!this.trigger);
        this.selectCell(e);
  },

  _computeHighlighted: function(one, two, three){
    if(typeof three===Object){var result = (one === true && two===true)?"yellow":"#afafaf";}
    result=(three===true)?"cyan; border: solid 4px #aecdfe":"aliceblue; border: solid 2px #009";
    return result;
    },
  computeColSelected: function(one,two){return one;},
  _computeHighlighted2(hl, color,background,tr){var result = (hl === true)?"yellow":"white";return result;},
setterUsed(e){
  console.log(e, e.target.value);
 this.set("selected.value", e.target.value);
},

rowOfSettersUsed(e){this.selectedArray.forEach(function(elem){
   this.set(elem.value,e.target.value);
});},
    setColumns(){

          var columnNames=["Years","January","February","March","Qtr1", "April","May","June","Qtr2", "MidYearTot","July","August","September","Qtr3", "Qtr3Tot","October","November","December","Qtr4", "2ndHalf", "Year Total","Œî","Œî"];
        var tempArr=[];
        var retArrays=columnNames.map(function(val, index,array){
                    var count=array.length;
                    var tempArr=[];
                    var valueArray=[];
                    for(var i=0;i<count;i++)
                    {
                       var retMini= val+array[i];
                       tempArr.push({"col": index, "row": i, "selected":false, "background": "#fafafa", "color": "#009", "highlighted": false, "payload":"",value:" "});
                       var value={"value":" "};
                       valueArray.push(value);
                    }
                   retVal={column:index, name: columnNames[index], selected: false, data: tempArr, values:valueArray};
                   //console.log()
                    return retVal;  
            }, []);
        //console.log(retArrays);
        return retArrays;
        },
   parser(colHeaders, type, array){
    var counter =colHeaders.length;
    var retVal=[];
    switch(true){
      case (type==="accounting"):
          switch(true){
            case (colHeaders[0]==="Years"&& colHeaders[4].match("Qtr1")!==undefined):
                for(var i=0;i<counter;i++){ 
                var val=2007+i;
                var cash=1000, ccrd=2300, tot=cash+ccrd;
                if(i<8){val=val.toString()+ " Total";}
                else{ 
                      val=`${val}s: Cash:
                                         Total CCards:
                                        Period Total:`;


                }
                array[0].data[i].payload=val;
              }
              retVal=array;
             // console.log(retVal);



            break;
            default:

            break;
          }
      break;
      default:
      break;
    }
    return(retVal);
   },
   parser3(){
   if(!this.comparisons)
    {
    var comparisons=new Map();
    this.set("comparisons", comparisons);
    }
    var array=[];
    var i=0, j=0;
    var time=new Date().getTime();
      for(i=0;i<16;i++)
      {
          var key="comparisons_"+i+"_"+0+"_";
          var column=document.createElement("div");
          column.setAttribute("style","display:flex; flex-direction: column; margin: 0px; flex-wrap:nowrap; max-height: 1820px;");
          var columnId="column_"+i;
          column.setAttribute("id",columnId);
          var elem=document.createElement("TEXTAREA");
          elem.setAttribute("style", "max-height:65px; border: solid 1px #009; min-height: 18px; margin:0px; height: 23px!important; font-family: merriweather; background: aliceblue; color: #009; text-align: center; font-size: 18px; font-weight: 700; resize:none;");
          elem.setAttribute("id", key);
          var hanger="--";
        if(this.comparisons.get(key))
        {   var jason=this.comparisons.get(key);
            bindValue=jason[0];
            elem.value=bindValue;
          }
        else
        {
          var bindValue=(this.csv[0][i])?this.csv[0][i]:hanger;
          elem.value=bindValue;
          this.comparisons.set(key,[elem.value, elem]);
        }
        var propName='value';
        var self=this;

        bindValue=this.comparisons.get(key);
        bindValue=bindValue[0];
       var value=this.comparisons.get(key)[0];
       console.log(value);
       var element=this.comparisons.get(key)[1];
       
       
        array.push({"column": [i,column], "header": elem, "color": "#009","value": this.comparisons.get(key)[0], "id": key, "key": key, "data":[]});
        console.log(array);
         // if(j===0){
          var theId="#"+columnId;
      
          Polymer.dom(this.$$("#hanger3")).appendChild(column);
              Polymer.dom(this.$$(theId)).appendChild(elem);
        // }
        for(var j=1;j<25;j++){

             var key="comparisons_"+i+"_"+j+"_";
               var elem=document.createElement("TEXTAREA");
          elem.setAttribute("style", "max-height: 55px; min-height: 18px; border: 1px solid #afafaf; padding-top: 4px; height: 33px!important; font-family: merriweather; color: #009; text-align: center; font-size: 18px; font-weight: 600; resize:none;");
          elem.setAttribute("id", key);
              var bindValue=(this.csv[j][i])?this.csv[j][i]:"--";
            //console.log(bindValue, "vital locale");
              elem.contenteditable=true;
              //elem.innerHTML=bindValue;
              elem.value=bindValue
              //console.log(elem.innerHTML);
              var propName='value';
          
                this.comparisons.set(key,[elem.value,elem]);
        if(this.csv[j][i]){
          array[i].data.push({"row":j, "col":i, "payload":elem.value, "value":elem.value, "color": "#009","key":key, "cell": elem});
              
                Polymer.dom(this.$$(theId)).appendChild(elem);
                     // console.log(array);
          }
          else{array[i].data.push({"row":j, "col":i, "payload":elem.value, "value":elem.value, "color": "#009","key":key, "cell": elem});
           //comparisons.set(key,elem);
        Polymer.dom(this.$$(theId)).appendChild(elem);
        //              console.log(array)}
        }
       
      }
    }
      //console.log(array);
      this.set("columns4", array);
           this.set("columns3", array);
           //console.log(comparisons);
           this.set("comparisons", comparisons);
  },
   parser2:function(){
    var length=this.csv.length;
    var id; 
    var array=[];
    var i=0;
      for(i=0;i<16;i++){
        array.push({"column": i, "selected": false, "background": "aliceblue", "highlighted":false, "color": "#009", "name": this.csv[0][i], "data":[]});
        for(var j=1;j<25;j++){
            if(this.csv[j][i]){array[i].data.push({"row":j, "col":i, "payload":this.csv[j][i], "value":this.csv[j][i], "selected": false, "color": "#009", "highlighted": false, "background":"#fafafa"});}
            else{array[i].data.push({"row":j, "col":i, "payload":"--", "value":"--", "selected": false, "color": "#009", "background":"#fafafa"});}
        }
      }

      //console.log(array);
      this.set("columns2", array);
   },
   get csv(){

                var val=[[  "Monthly Comparisons","January" ,"February" ,"March" ,"April" ,"May" ,"June" ,"July" ,"August" ,"September" ,"October","November" ,"December","Monthly Avg","%_v_Prev","Yr. Tot. Est 14"],
            ["2008 Totals",,,,,,,,,,,,,"$11,426.42 ",,"$137,117.00 "],
            ["2009 Totals","39.79%",,,,,,,,,,,,"$16,064.58 ","40.59%","$192,775.00 "],
            ["2010 Totals",,,,,,,,,,,,,"$25,997.08 ","61.83%","$311,965.00 "],
            ["2011 Totals","$31,454.86 ","$17,363.07 ","$36,275.98 ","$18,214.92 ","$9,891.99 ","$52,962.60 ","$70,732.42 ","$70,482.71 ","$30,910.19 ","$45,635.75 ","$10,225.00 ","$29,020.00 ","$35,264.12 ","35.65%","$423,169.49 "],
            ["2012 Totals","$51,545.00 ","$30,709.50 ","$9,300.00 ","$51,240.00 ","$53,762.50 ","$74,445.00 ","$101,800.00 ","$69,150.00 ","$45,700.00 ","$52,008.00 ","$38,220.00","$25,468.75 ","$50,279.06 ","42.58%","$603,348.75 "],
            ["2013 Totals","$70,942.00 ","$31,962.00 ","$59,400.00 ","$86,950.00 ","$55,025.00 ","$76,750.00 ","$148,334.00 ","$68,242.00 ","$51,399.00 ","$62,282.00 ","$51,000.00 ","$66,633.00 ","$69,076.58 ","37.39%","$828,919.00 "],
            ["2014 Totals","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$77,375.00 ",,,,,,,"$86,309.00 ","35.91%","$1,126,578.34 "],
            ["Avg. Revenue '11-'14","$58,135.47 ","$38,773.14 ","$47,412.75 ","$66,623.98 ","$52,683.62 ","$70,383.15 ","$106,955.47 ","$69,291.57 ","$42,669.73 ","$53,308.58 ","$33,148.33 ","$40,373.92 ","$60,232.19 ",,"$722,786.31 "],
            ["% Change 14 v. Avg. '11-'14","35.20%","93.58%","78.59%","65.24%","74.73%","9.93%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","43.29%",,"#REF!"],
            ["Best Month '11-'13 yr. ","$70,942.00 ","$31,962.00 ","$59,400.00 ","$86,950.00 ","$55,025.00 ","$76,750.00 ","$148,334.00 ","$70,482.71 ","$51,399.00 ","$62,282.00 ","$51,000.00 ","$66,633.00 ","$69,263.31 ",,"$900,423.02 "],
            ["% change 14 v. previous best '11-'13","10.79%","134.84%","42.55%","26.61%","67.30%","0.81%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","24.95%",,"-7.94%"],
            [ "Avg. Revenue '12-'14","$67,029.00 ","$45,909.83 ","$51,125.00 ","$82,760.33 ","$66,947.50 ","$76,190.00 ","$125,067.00 ","$68,696.00 ","$48,549.50 ","$57,145.00 ","$44,610.00 ","$46,050.88 ","$65,006.67 ",,"$780,080.04 "],
            ["%Change14 v.14 Avg","17.26%","63.49%","65.62%","33.02%","37.50%","1.56%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","32.77%",,"6.26%"],
            ["Gross delta '13 to '14","$7,658.00 ","$43,096.00 ","$25,275.00 ","$23,141.00 ","$37,030.00 ","$625.00" ,"($148,334.00)","($68,242.00)","($51,399.00)","($62,282.00)","($51,000.00)","($66,633.00)","$27,240.00 ",,"$326,880.00 "],
            ["% &#916 13 to '14","10.79%","134.84%","42.55%","26.61%","67.30%","0.81%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","44.76%",,"54.18%"],
            ["Projections RE: 2014","January" ,"February" ,"March" ,"April" ,"May" ,"June" ,"July" ,"August" ,"September" ,"October","November" ,"December","Monthly Avg","%?'14 v 13","Totals"],
            ["Worst Remaining M. (WRM) '12+","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$74,445.00 ","$101,800.00 ","$68,242.00 ","$45,700.00 ","$52,008.00 ","$38,220.00 ","$25,468.75 ","$70,530.23 ","2.10%","$846,362.75 "],
            ["Proj.WRMonths_incQ4 +17%","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$87,100.65 ","$119,106.00 ","$79,843.14 ","$53,469.00 ","$60,849.36 ","$44,717.40 ","$29,798.44 ","$76,280.25 ","10.43%","$915,362.99 "],
            ["Proj./w_last +15%","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$88,262.50 ","$170,584.10 ","$78,478.30 ","$59,108.85 ","$71,624.30 ","$58,650.00 ","$76,627.95 ","$86,984.58 ","25.92%","$1,043,815.00 "],
            ["Projected w last+25%","$88,677.50 ","$39,952.50 ","$74,250.00 ","$108,687.50 ","$68,781.25 ","$95,937.50 ","$185,417.50 ","$85,302.50 ","$64,248.75 ","$77,852.50 ","$63,750.00 ","$83,291.25 ","$86,345.73 ","25.00%","$1,036,148.75 "],
            ["Proj. w/Avg. 12-13","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$76,190.00 ","$125,067.00 ","$68,696.00 ","$48,549.50 ","$57,145.00 ","$44,610.00 ","$46,050.88 ","$75,565.61 ","9.39%","$906,787.38 "],
            ["2014 Projections" ,"January" ,"February" ,"March" ,"April" ,"May" ,"June" ,"July" ,"August" ,"September" ,"October","November" ,"December","Monthly Avg","%? v. Proj.","2014 Proj."],
            ["2014 Actual ","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$77,375.00 ",,,,,,,"$86,309.00 ","8.73%","$1,126,578.34"],
            ["? '14 v. + 25%","($10,077.50)","$35,105.50 ","$10,425.00 ","$1,403.50 ","$23,273.75 ","($18,562.50)",,,,,,,"$6,927.96 ","8.73%","$90,429.59"]];
            return val;
},
    observeMenuProperty(newVal, oldVal){},

  });
    </script>
   </dom-module>
<!--

_computeNewValue(){
    if(this.comparisons&&this.comparisons.get("comparisons_0_15_")){
    var value=this.comparisons.get(this.cellKey);
    var keys=this.cellKey.split("_");
   console.log( keys[1]);

    var bindValue=this.cellValue;
    value[0]=bindValue;
    value[1].value=bindValue;
    console.log(value[1].style);
    for(var i=0;i<30;i++){

    var newKey="comparisons_"+keys[1]+"_"+i+"_";
    var value=this.comparisons.get(newKey);
    if(value && value[1]){
    var style=value[1].style.cssText;
     if(style.match("background: gold;")&&style.match("background: gold;").length>0)
     {
      style=style.replace("background: gold;", "");
      console.log(style);
    }
      else{
        style=style+"background: gold;";
      }
    value[1].style=style;
    }
    else{i=30;}
    }
      }
  },
var counter=rowArray.length,
    // p=0;
    // for(p=0;p<counter;p++){
    //  var theId="#" + columnArrayIds[p];
    //  var parent=this.$$(theId);
    //   Polymer.dom(parent).removeChild(rowArray[p]);
    //   }
 monkey: function(e)
  {
    var col = "columns[2][2]";
    this.set(["columns", 2, "data",2, "payload"], "monkey"); //{payload:"Monkey"});
  //  console.log(this.columns);
  },

//     Object.defineProperty(elem,propName,{
          //                 enumerable: true,
          //             configurable: true,
          //             get value() {
          //               elem.innerHTML=bindValue;
          //               return bindValue;
          //             },
          // set [propName](bindValue){
          //       [propName] = bindValue;
          //       if(propName==="value"){
          //         elem.innerHTML=bindValue;
          //       }
          //           archive.push({
          //            "element":cell[key],
          //            "propertyName": propName,
          //            "value": bindValue,
          //            "timestamp": time
          //           });
          //         },
          //       });
          //     var keys =Object.keys(elem);
          //     var p=Object.getOwnPropertyNames(elem);
              //console.log(p,keys);
              //if(elem.contenteditable){//console.log(elem.contenteditable);}if(elem.value){//console.log(elem.value);}
// Object.defineProperty(element,"value",{
       //    enumerable: true,
       //    configurable: true,
       //    writable: true,
       //    get value() {
       //      console.log("am in getter");
       //      return self.comparisons.get(key)[0];
       //    }
          // set value(bindValue){
          //   console.log("am setting value");
          //        bindValue=this.comparisons.get(key);
          //        console.log(bindValue);
          //        bindValue=bindValue[0];
          //        value=this.comparisons.get(key)[0];
          //           archive.push({
          //            "element":elem,
          //            "propertyName": propName,
          //            "value": bindValue,
          //            "timestamp": time
          //           });
          //           console.log(bindValue, archive); 
          //     }
           // });
    Object.defineProperty(elem,propName,{
          enumerable: true,
          configurable: true,
          get value() {
            return background_bindValue;
          },
          set [propName](bindValue){;
                if(propName==="value"){elem.innerHTML=bindValue;}
                else if(propName==="background"){elem.style.background=background_bindValue;}
                else{[propName] = [propName]+"_bindValue"}
                    archive.push({
                     "element":cell[key],
                     "propertyName": propName,
                     "value": bindValue,
                     "timestamp": time
                    });
                    console.log(archive);
                     
              }
           });



           startDrag: function(e)
  {   
    if(this.userDrags===true){
    var parentOneTemplate=e.model.dataHost;
    var celloneModel = parentOneTemplate.modelForElement(e.target);
      var cell=parentOneTemplate.itemForElement(e.target); 
      var item = this.$.mappedGridRepeater.itemForElement(e.target);
      this.set("startContainer",item);
      this.set("startCell",cell);
      this.set("startCellModel",celloneModel);
    }
  },

  dragOver: function(e){e.preventDefault();

    this.selectCell(e);},

  handleDrop: function(e){   
    if(this.userDrags===true){
        var parentTemplate=e.model.dataHost;
        var endContainer = this.$.mappedGridRepeater.itemForElement(e.target);
        var endCell= parentTemplate.itemForElement(e.target);
        var cellModel = parentTemplate.modelForElement(e.target);  
        if(this.startContainer.selected===true){
            var startCol=this.startContainer.data[0].col;
            var endCol=endContainer.data[1].col;
            var startContainerClone=Object.assign({},this.startContainer);
            var endContainerClone=Object.assign({},endContainer);
            endContainerClone.column=startCol;
            startContainerClone.column=endCol;
            for(var i=0; i<endContainer.data.length;i++){
                startContainerClone.data[i].col=endCol;
                endContainerClone.data[i].col=startCol;
            }
            this.async(function(){this.splice("columns",endCol,1,startContainerClone);},50);
            this.async(function(){this.splice("columns",startCol,1, endContainerClone);},26);
        }
        else{
            var destpayload = endCell.payload;
            var payload=this.startCell.payload;
            this.async(function(){cellModel.set("item.payload",payload)},25);
            this.startCellModel.set("item.payload",destpayload);
            console.log(this.startCellModel.item.payload);
        }
      }
      else if(this.userSelection===true){



      }
    },
[[  "Monthly Comparisons","January" ,"February" ,"March" ,"April" ,"May" ,"June" ,"July" ,"August" ,"September" ,"October","November" ,"December","Monthly Avg",%"_v_Prev","Yr. Tot. Est 14"],
["2008 Totals",,,,,,,,,,,,,"$11,426.42 ",,"$137,117.00 "],
["2009 Totals","39.79%",,,,,,,,,,,,"$16,064.58 ",40.59%,"$192,775.00 "],
["2010 Totals",,,,,,,,,,,,,"$25,997.08 ",61.83%,"$311,965.00 "],
["2011 Totals","$31,454.86 ","$17,363.07 ","$36,275.98 ","$18,214.92 ","$9,891.99 ","$52,962.60 ","$70,732.42 ","$70,482.71 ","$30,910.19 ","$45,635.75 ","$10,225.00 ","$29,020.00 ","$35,264.12 ",35.65%,"$423,169.49 "],
["2012 Totals","$51,545.00 ","$30,709.50 ","$9,300.00 ","$51,240.00 ","$53,762.50 ","$74,445.00 ","$101,800.00 ","$69,150.00 ","$45,700.00 ","$52,008.00 ","$38,220.00","$25,468.75 ","$50,279.06 ",42.58%,"$603,348.75 "],
["2013 Totals","$70,942.00 ","$31,962.00 ","$59,400.00 ","$86,950.00 ","$55,025.00 ","$76,750.00 ","$148,334.00 ","$68,242.00 ","$51,399.00 ","$62,282.00 ","$51,000.00 ","$66,633.00 ","$69,076.58 ",37.39%,"$828,919.00 "],
["2014 Totals","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$77,375.00 ",,,,,,,"$86,309.00 ","35.91%","$1,126,578.34 ",]
["Avg. Revenue '11-'14","$58,135.47 ","$38,773.14 ","$47,412.75 ","$66,623.98 ","$52,683.62 ","$70,383.15 ","$106,955.47 ","$69,291.57 ","$42,669.73 ","$53,308.58 ","$33,148.33 ","$40,373.92 ","$60,232.19 ",,"$722,786.31 "],
[%" Change 14 v. Avg. '11-'14",35.20%,93.58%,78.59%,65.24%,74.73%,9.93%,-100.00%,-100.00%,-100.00%,-100.00%,-100.00%,-100.00%,43.29%,,#REF!],
["Best Month '11-'13 yr. ","$70,942.00 ","$31,962.00 ","$59,400.00 ","$86,950.00 ","$55,025.00 ","$76,750.00 ","$148,334.00 ","$70,482.71 ","$51,399.00 ","$62,282.00 ","$51,000.00 ","$66,633.00 ","$69,263.31 ",,"$900,423.02 "],
[%" change 14 v. previous best '11-'13","10.79%","134.84%","42.55%","26.61%","67.30%","0.81%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","24.95%",,"-7.94%"],,,,,,,,
[ ""Avg. Revenue '12-'14","$67,029.00 ","$45,909.83 ","$51,125.00 ","$82,760.33 ","$66,947.50 ","$76,190.00 ","$125,067.00 ","$68,696.00 ","$48,549.50 ","$57,145.00 ","$44,610.00 ","$46,050.88 ","$65,006.67 ",,"$780,080.04 "],
["%Change'14 v.'12-'14 Avg","17.26%","63.49%","65.62%","33.02%","37.50%","1.56%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","32.77%",,"6.26%"],
["Gross delta '13 to '14","$7,658.00 ","$43,096.00 ","$25,275.00 ","$23,141.00 ","$37,030.00 ",$625.00 ,"($148,334.00)","($68,242.00)","($51,399.00)","($62,282.00)","($51,000.00)","($66,633.00)","$27,240.00 ",,"$326,880.00 "],
["% ?  '13 to '14","10.79%","134.84%","42.55%","26.61%","67.30%","0.81%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","-100.00%","44.76%",,"54.18%"],
["Projections RE: 2014","January" ,"February" ,"March" ,"April" ,"May" ,"June" ,"July" ,"August" ,"September" ,"October","November" ,"December","Monthly Avg","%?'14 v 13","Totals"],
["Worst Remaining M. (WRM) '12+","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$74,445.00 ","$101,800.00 ","$68,242.00 ","$45,700.00 ","$52,008.00 ","$38,220.00 ","$25,468.75 ","$70,530.23 ","2.10%","$846,362.75 "],
["Proj.WRMonths_incQ4 +17%","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$87,100.65 ","$119,106.00 ","$79,843.14 ","$53,469.00 ","$60,849.36 ","$44,717.40 ","$29,798.44 ","$76,280.25 ","10.43%","$915,362.99 "],
["Proj./w_last +15%","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$88,262.50 ","$170,584.10 ","$78,478.30 ","$59,108.85 ","$71,624.30 ","$58,650.00 ","$76,627.95 ","$86,984.58 ",25.92%,"$1,043,815.00 "],
["Projected w last+25%","$88,677.50 ","$39,952.50 ","$74,250.00 ","$108,687.50 ","$68,781.25 ","$95,937.50 ","$185,417.50 ","$85,302.50 ","$64,248.75 ","$77,852.50 ","$63,750.00 ","$83,291.25 ","$86,345.73 ",25.00%,"$1,036,148.75 "],
["Proj. w/Avg. 12-13","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$76,190.00 ","$125,067.00 ","$68,696.00 ","$48,549.50 ","$57,145.00 ","$44,610.00 ","$46,050.88 ","$75,565.61 ",9.39%,"$906,787.38 "],
["2014 Projections" ,"January" ,"February" ,"March" ,"April" ,"May" ,"June" ,"July" ,"August" ,"September" ,"October","November" ,"December","Monthly Avg","%? v. Proj.","2014 Proj."],
["2014 Actual ","$78,600.00 ","$75,058.00 ","$84,675.00 ","$110,091.00 ","$92,055.00 ","$77,375.00 ",,,,,,,"$86,309.00 ",8.73%,"$1,126,578.34"],,,,,,,,
["? '14 v. + 25%","($10,077.50)","$35,105.50 ","$10,425.00 ","$1,403.50 ","$23,273.75 ","($18,562.50)",,,,,,,"$6,927.96 ",8.73%,"$90,429.59"]];