<dom-module id="fc-course-builder">
<style>
.huge {
	height: 1000px; 
	width: 99.6vw;
	border: 3px blue solid;	
		background: #aedefe;
	display: block;
	overflow: hidden;
}

#demo{
	display: block;
/* 	width: 1080px;
	height: 900px; */
	background: #aedefe;
/* 	margin-left: 290px; */
/* 	border: gold ridge 22px; */
	box-shadow: 4px 11px 21px 7px #9fafaf;
}

.holder{
	width: 320px;
	height: 480px;
	background: #aedefe;
	margin-left: 0px;
	border: gold ridge 8px;
	box-shadow: 4px 11px 21px 7px #9fafaf;
		display: block;
	oveflow: hidden;
	float: left;
}
.innerholder{
	
	overflow-y: scroll;
}

.header-class{
font-size: 22px;
color: white;
	background: #03A9F4;
font-weight: 600;
text-align: center;
	padding: 18px 22px 24px 22px;

}
paper-item{
	
	border: 1px solid #adadad;
 --paper-item-focused: {
      background: var(--paper-amber-500);
      font-weight: bold;
    };
   /* --paper-icon-item-focused-before: {
      opacity: 0;
    };*/
}
.selected{background: var(--paper-amber-500);
      font-weight: bold;}
.primary{
	color: #008;
	font-weight:600;
	font-size: 20px;
}
.secondary{
color: grey;
	font-weight:500;
	font-size: 16px;

}
	
.slides{oveflow: hidden; overflow-y: scroll;}


</style>
<template>
<div class="layout vertical">
			<section class="holder layout vertical">
				<section class="header-class layout vertical"> 
				SAT Test Dates 2016-2019
				</section>
				
				<paper-listbox class="layout vertical slides" selected="{{testDateSelected}}">
					<template is="dom-repeat" class="ghost dropzone"  items="{{testDateArray}}">
						<paper-item on-tap="soSelected" class="layout horizontal courseData" group="courseData" draggable=true on-selected="changeInterface(testDateSelected)" value$="{{item.testDateDateObject}}">
							<paper-item-body  class="layout vertical" value$="{{item.testDateDateObject}}" two-line>
								<div class="primary">{{item.testDate}}</div>
								<div class="secondary">SAT TEST DATE </div>
							</paper-item-body>   	
							<paper-icon-button icon="star" on-tap="soUnSelected" value$="{{item.testDateDateObject}}" alt="favourite this!">
							</paper-icon-button>
			  			</paper-item>
					</template>
				</paper-listbox>
					
			</section>
	<section class="holder layout vertical" hidden$="{{!testDateNotSelected}}">
		<section class="header-class layout vertical"> 
		Select A Practice Test Day 
		</section>
		<paper-listbox class="layout vertical slides" selected="{{practiceTestDaySelected}}">
				<paper-item id="saturday" on-tap="daySelected" data-time="Saturday 9:00AM to 12:45PM" value="saturday">	
					<paper-item-body data-time="Saturday 9:00AM to 12:45PM">
						<div class="primary">Saturday 9:00AM</div>
						<div class="secondary">Practice Test Date & Time</div>
					</paper-item-body>
				</paper-item>
				<paper-item id="sunday" on-tap="daySelected" data-time="Sunday 9:00AM to 12:45PM" value="sunday">	
					<paper-item-body data-time="Sunday 9:00AM to 12:45PM" value="sunday" two-line>
						<div class="primary">Sunday 9:00AM</div>
						<div class="secondary">Practice Test Date & Time</div>
					</paper-item-body>
				</paper-item>
		</paper-listbox>
	</section>

          
            <fc-calendar-animee ptest-array="{{practiceTestDates}}" id="immaguy"></fc-calendar-animee>



	</div>



</template>
<script>
"use strict";
Polymer({
	is: 'fc-course-builder',
	behaviors:["fcDraggableDataBehavior", 
		"Polymer.IronResizableBehavior", 
		"FCBehaviors.FcCalendarBehaviorPrime"],
	// listeners:{"saturday.tap":"saturdayPracticeDay"
				// "sunday.tap":"sundayPracticeDay"	},
	properties: {
		testDateArray:{
			type: Array, 
			value: [],
			notify: true
		},
		testDateSelected:{
			type: Number,
			value: 0,			
			observer:"tellTestDateSelected",
			notify: true
		},
		testDate:{			
			observer:"testDateSelItem",
			notify: true
		}, 
		practiceTestDaySelected:{
			type: Number, 
			value:0,
			notify: true
		},
		testDateNotSelected:{
			type: Boolean,
			value: true,
			notify: true, 
			reflectToAttribute: true
		},
		
		dayInfo:{
			type: Object,
			value:{},
			notify: true
		},
		firstDay:{
			type: Date,
			notify: true
		},
		dateIndex:{ 
			type: Number,
			notify: true
		},
		testDate:{
			type: Date,
			notify: true
		},
		stringTestDate:{ 
			type: String,
			notify: true
		},
		practiceTestDay:{ 
			type: String,
			notify: true
		},
		practiceTestDayLabel:{
			type: String,
			notify: true
		},
		practiceTestDates:{ 
			type: Array,
			value: [],
			notify: true
		},
		practiceTestTime:{ 
			type: String,
			notify: true
		},
		classDays:{ 
			type: Array,
			notify: true
		},
		classTimes:{ 
			type: String,
			notify: true
		},
		coach:{ 
			type: String,
			notify: true
		},
		coachFcid:{ 
			type: String,
			notify: true
		},
		studentFcids:{ 
			type: Array,
			notify: true
		},
		location:{ 
			type: String,
			notify: true
		},
		courseName:{ 
			type: String,
			notify: true
		},
		courseAssistants:{ 
			type: Array,
			notify: true
		},
		allTestDates:{
			type: Array,
			value:[],
			notify: true
		}, 
		testDateCounter:{
			type: Boolean,
			value: false,
			notify: true
		}, 
		eventDetails:{
			type: Object,
			computed: "computeEventDetails(testDateSelected, testDate)",
			notify: true
		},

	},

	daySelected(e){
		console.log(e.target);
		var target = e.target;
		while(target.nodeName!="PAPER-ITEM" && target.nodeName!="BODY")
		{
			target=target.parentNode;
			console.log(target);

		}
		var val = target.getAttribute("value");
		if(target.nodeName!="PAPER-ITEM"){alert("MISSED THE TARGET" + target.nodeName);}
		else if(val=="saturday")
		{ this.set("practiceTestDayLabel", "Saturday 9:00AM to 12:30PM");
		var array = [];
			for (j = 0; j < 6; j++) {
					var d = new Date(this.testDate);
					var sat = j*7+7;
					var test = new Date();
					d.setDate(d.getDate() - sat);
					var test = new Date(d);
					console.log(test);
			array.push(test);
			console.log(array);
			}
			var revarr=[];
			revarr=array.reverse();
			this.set("practiceTestDates", revarr);
			console.log(this.practiceTestDates);

		}
		else if(val=="sunday")
		{ var array = [];
			for (j = 0; j < 6; j++) {
					var d = new Date(this.testDate);
					var sun = j*7+6;
					var test = new Date();
					d.setDate(d.getDate() - sun);
					var test = new Date(d);
					console.log(test);
			array.push(test);
			console.log(array);
			}
			var revarr=[];
			revarr=array.reverse();
			this.set("practiceTestDates", revarr);
			console.log(this.practiceTestDates);
		}
	},


	ready()
	{
			
		this.setTestArray();

	},
	setTestArray(testIndex){
		var mayDate = [2016, 5, 7];
			var juneDate = [2016, 6, 4];
			var augFDate = [2016, 8, 6];
			var octDate = [2016, 10, 1];
			var novDate = [2016, 11, 5];
			var decDate = [2016, 12, 3];
			var janDate = [2017, 1, 28];
			var marDate = [2017, 3, 11];
			var may2Date = [2017, 5, 6];
			var june2Date = [2017, 6, 3];
			var aug1Date = [2017, 8, 26];
			var oct2Date = [2017, 10, 7];
			var nov2Date = [2017, 11, 4];
			var dec2Date = [2017, 12, 2];
			var mar2Date = [2018, 3, 10];
			var may3Date = [2018, 5, 5];
			var june3Date = [2018, 6, 2];
			var aug2Date = [2018, 8, 25];
			var oct3Date = [2018, 10, 6];
			var nov3Date = [2018, 11, 3];
			var dec3Date = [2018, 12, 1];
			var mar3Date = [2019, 3, 9];
			var may4Date = [2019, 5, 4];
			var june4Date = [2019, 6, 1];
			var allTestDates = [];
			allTestDates = [mayDate, juneDate, augFDate, octDate, novDate, decDate, janDate, marDate, may2Date, june2Date, aug1Date, oct2Date, nov2Date, dec2Date, mar2Date, may3Date, june3Date, aug2Date, oct3Date, nov3Date, dec3Date, mar3Date, may4Date, june4Date];
			this.set("allTestDates", allTestDates);
			for(i=0;i<allTestDates.length; i++)
				{
				var testD = new Date(allTestDates[i]).toDateString();
				var testDobj = new Date(allTestDates[i]);
				this.push("testDateArray", {"testDate": testD, "testDateDateObject": testDobj});
				// testDates.push({testD: testSet.reverse()});
				}
			if(testIndex!=undefined && testIndex!=null && testIndex!=NaN)
			{
				var p = new Date(allTestDates[testIndex]);
				return p;

			}
		},

	tellTestDateSelected(newVal, oldVal)
	{		
		this.set("dateIndex", newVal);
	},
	testDateSelItem(newVal, oldVal)
	{	
	},
	
	soUnSelected(e){
		var item =e.target;
		console.log(item);
		console.log(this.courseObject);
		while(item.nodeName!="PAPER-ITEM" && item.nodeName!="BODY")
		{
			item=item.parentNode;
		}
		if(item.nodeName=="PAPER-ITEM" && typeof item.value==Date)
			{
				this.set("courseObject.testDate", null);
				Polymer.dom(item).classList.remove("selected");
			}

	},

	getPracticeTestDates(practiceTestDaySelected)
	{
		this.courseMaker(this.testDateSelected,practiceTestDaySelected, "monday", "wednesday", "friday");
	},
	soSelected(e){
		console.log(e.model.item.testDateDateObject);
		this.set("dateIndex", e.model.index);
		this.set("testDate", e.model.item.testDateDateObject);	
		this.set("stringTestDate", e.model.item.testDate);
		var last=new Date(e.model.item.testDateDateObject);
		var first = last.setDate(last.getDate() - 42);
		first = new Date(first);
		console.log(first);
		this.set("firstDay", first);
		var end = new Date(e.model.item.testDateDateObject);
		console.log(first, end);

		this.$.immaguy.calendarCreator(first, end, "weeks");
		
	},

	courseMaker(testDateIndexSelected, practiceTestDaySelected,courseDayOneSelected, CourseDayTwoSelected, courseDayThreeSelected)
	{
		// courseBuilderOne(dateIndex,practiceTestDay, startTimeOfClass, endTimeOfClass, courseName, courseFcid, firstClassDayOfWeek, secondClassDayOfWeek, thirdClassDayOfWeek){
			var allTestDates=this.allTestDates;
			var counter = allTestDates.length;
			var i =0;
			var allDates = [];
			for(i=0;i<counter;i++){			
				var testSet = [];
				var j = 0;
				var Mon_Wed =[];
				var Tue_Thu=[];
				for (j = 0; j < 6; j++) {
					var d = new Date(allTestDates[i]);
					var sunday =new Date(allTestDates[i])
					var monday = new Date(allTestDates[i]);
					var tuesday = new Date(allTestDates[i]);
					var wednesday = new Date(allTestDates[i]);
					var thursday = new Date(allTestDates[i]);
					var friday = new Date(allTestDates[i]); 
					var sat = j*7+7;
					var sun = j*7+6;
					var mon = j*7+5;
					var tue= j*7+4;
					var wed= j*7+3;
					var thu= j*7+2;
					var fri= j*7+1;
					d.setDate(d.getDate() - sat);
					sunday.setDate(sunday.getDate() - sun);
					monday.setDate(monday.getDate() - mon);
					tuesday.setDate(tuesday.getDate() - tue);
					wednesday.setDate(wednesday.getDate() - wed);
					thursday.setDate(thursday.getDate() - thu);
					friday.setDate(friday.getDate() - fri);

					testSet.push(d.toDateString());
					
					Mon_Wed.push(wednesday.toDateString());
					Mon_Wed.push(monday.toDateString());
					
					Tue_Thu.push(thursday.toDateString());
					Tue_Thu.push(tuesday.toDateString());
				}
				var testD = new Date(allTestDates[i]).toDateString();
				var testDobj = new Date(allTestDates[i]);
				this.push("testDateArray", {"testDate": testD, "testDateDateObject": testDobj});
				allDates.push({testD: testSet.reverse()});
				
			}


		},
		computeEventDetails(testDateSelected, testDate){
			console.log(testDateSelected, testDate);
		}

});
</script>
</dom-module>
<!--
console.log(this.courseObject);
	// 	var targetValue = newVal;
	// 	while(targetValue.nodeName!="PAPER-ITEM" && targetValue.nodeName!="BODY")
	// 	{	
	// 		targetValue=targetValue.parentNode;
	// 	}
	// 	if(this.courseObject.testDate==undefined || this.courseObject.testDate==null){
	// 		if(targetValue.nodeName=="PAPER-ITEM" && typeof targetValue.value==Date)
	// 		{
	// 			this.set("courseObject.testDate", targetValue.value);
	// 			Polymer.dom(targetValue).classList.add("selected");
	// 		}
	// 	else if(this.courseObject.testDate!=undefined || this.courseObject.testDate!=null)
	// 	{Alert("Please Clear the Previously Selected SAT TEST DATE by tapping the star in the appropriate selected item");}
	// 	console.log("this is the new item Value: ", newVal);
	// 	console.log("this is the old item Value: ", oldVal);
	// 	}
-->