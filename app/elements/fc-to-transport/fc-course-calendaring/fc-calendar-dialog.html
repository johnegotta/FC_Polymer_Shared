<dom-module id="fc-calendar-dialog">
<template>
<style>
:host{
background: white;
padding: 0px 3px 4px 8px;
opacity: 1;}
.primary{

	color: #008;
	font-weight:600;
	font-size: 13.5px;
	width: 197px;
	
}
.secondary{
		color: grey;
	font-weight:500;
	font-size: 11px;
	margin-top: 11px;
	padding: 0 4px;
	width: 50px;


}	
iron-icon .small {
	height: 16px!important;
	width:16px!important;
}
.scheduling{padding: 0px 5px;}
.header-class{min-height: 35px !important;}
.selected{}
</style>		
<fc-ddr-card drags="true" head-class="darkBlue" is-picker="true" header-title="Focused Planner" class="flex layout vertical" style="padding-right:2px; margin: 4px 0px 4px 0px; width: 100%!important; height: 500px;">
	
<section class="horizontal flex layout center-justified">

</section>
 <div class="horizontal flex layout center-justified">
 			<array-selector id="arrselector" items="{{fcCourseObject.eventArray}}" selected="{{selected}}" multi toggle></array-selector>
			<neon-animated-pages class="vertical flex-1 layout" id="pages" style="width: 320px; height:360px;" selected="0"> 
				<fc-date-picker-proto displayed-month="{{displayedMonth}}" on-dblclick="_dateSelected" fc-course="{{fcCourseObject}}" selected-array={{days}} id="myCalendarCard">
				<span class="headers">[[_computeCalendarHeading(displayedMonth)]] [[computeYear(displayedMonth)]]</span>
				</fc-date-picker-proto>
				<fc-tabbed-calendar-card on-close="_onClose" fc-course="{{fcCourseObject}}" fc-event="{{fcEvent}}" fc-courses="{{FcCourse}}">
				</fc-tabbed-calendar-card>
			</neon-animated-pages>
			<fc-base-event-inputs class="horizontal flex-2 layout" value-options={{valueOptions}} output-options="{{outputs}}" fc-course="{{fcCourseObject}}">
			</fc-base-event-inputs>
			<div class="horizontal flex-1 layout">
			<fc-event-element fc-course="{{fcCourseObject}}" inputs="{{inputs}}"class="calendarItem">
 			</fc-event-element>
 			</div>
 			
 			
		<content select=".calendarItem"></content>
		</div>
<div class="horizontal layout center-justified" style="width: 100%; margin: 20px; overflow-x: scroll;">
<div class="horizontal layout left-justified" style="max-width: 22000px; min-width: 2400px; height: 420px; border: silver 2px solid; margin-left: 140px; padding-left: 900px;">
<template is="dom-repeat" initial-count="7" items="{{days}}" as="day">
	<div class="vertical layout" draggable=true id="swipable" on-track="swipeNslide" style="border: silver 2px solid; width:260px!important;">
		<section class="holder layout vertical"style="width:260px!important; height: 480px; ">
			<section class="header-class layout vertical" style="height: 65px!important;color: white; font-size:18px; background: green; padding-top: 15px; text-align: center; font-family: merriweather;">
					[[_computeDate(day.calendarDay.date)]]
					 [[day.username]]
					
			</section>
			<paper-listbox class="layout vertical slides" style="overflow-y: scroll;">
				<template is="dom-repeat" id="eventList" initial-count="6" items="{{day.calendarDay.eventList}}" observer="activity, slot.activity" as="slot">
						<paper-item on-tap="selectedTwo"  style$="border: 1px #aeaeae solid; background: [[slot.color]];" class="layout horizontal scheduling" draggable=true>
						
							<paper-item-body style$="background: [[slot.color]];" class="layout horizontal" value$="{{value}}">
								<div class="secondary layout horizontal flex-1 self-shrink" style="background: [[slot.color]];" >
								<fc-input-prime style="width: 65px; font-size: 10px; margin-left: -8px;" label="TIME" name="{{slot.name}}" input-type="tiny" label-hidden="false" value="{{slot.time}}"></fc-input-prime>
								</div>
								<div class="primary layout horizontal flex-4 self-stretch" style$="background: [[slot.color]];"><fc-input-prime style="width: 189px;" input-type="text" label="[[slot.activity]]" name="{{option.name}}" label-hidden="true" value="{{slot.activity}}"></fc-input-prime> &nbsp; &nbsp;</div>
								
							<section class="blue-btn-class" on-tap="addItem">
	   								<iron-icon class="small" style="height: 16px!important;width:16px!important;" icon="icons:add-circle-outline">
	   								</iron-icon>
	   						</section>
							</paper-item-body>   	
			  			</paper-item>
				</template>
				</paper-listbox>	
			</section>
		</div>
</template>
</div>	
</div>

		
	 </fc-ddr-card>
	
</template>
<script>
FcCalendarDialog= Polymer({
	is:"fc-calendar-dialog",
	behaviors:[FCBehaviors.FcCalendarBehaviorPrime
		 // "Polymer.PaperDialogBehavior"
		  ],
	observers:['fcCourseObjectObserver(fcCourseObject.courseCalendarDaysArray.*)', 
	'letsWatchCalendarDays(days.*)'],
	properties:{
		fcCourseObject:{
			type: FcCourse,
			//observer: "fcCourseObjectObserver",
			notify: true
		},
		displayedMonth:{
			type:Array,
			notify: true
		},
		valueOptions: {
			type: Array, 
			value: [],
			notify: true
			},
		outputs: {
			type: Array,
			value: [],
			notify: true
		},
		days:{
			type: Array,
			notify: true,
		},
		slots:{
			type: Array,
			notify: true
		},
	
		inputs: {
			type: Array,
			value: [],
			notify: true
		}
	},
	
	ready: function()
	{	
		this.set("fcCourseObject", new FcCourse());
		var self=this;
		var valueArray=FcCourse.getMoreInputs(); //.concat(FcCourse.getAllInputsAtOnce());
		valueArray.forEach(function(item, index, array){
			 self.push("valueOptions",item);
		 });
	},
	selectedTwo: function(event){





	},

	letsWatchCalendarDays: function(days)
	{

		console.log(days);
	},

	addItem: function(event) {
		  	event.preventDefault();
		  	this.ref.push({
		    	'done': false,
		    	'text': this.newItemValue,
		    	'timeline': this.timeline,
		    	'startDate': this.dateStarted,
		    	'notes': this.notes,
		  	});
		  	this.newItemValue = '';
		},


attached: function()
	{		
		this.set("firstTime", false);
		var inputO=this.inputValueAndLabelSerialization(this.valueOptions);
		this.set("inputs", inputO);	
		var outputs= this._computeOutput(this.valueOptions, this.fcCourseObject);
		this.set("outputs", outputs);
	},
swipeNslide: function(e)
{ var target=e.target;
 e.preventDefault();
          
          switch(e.detail.state) {
                case 'start':
               
                	target.style.left=e.detail.x;
                	
              		target.changeX=0;
                 break;
                case 'track':
                  
                  target.style.left=e.detail.dx + self.changeX;
                   this.translate3d(target.changeX.toString() + 'px', 0, 0);
                  
                
                  break;
                case 'end':
                this.translate3d(0,0,0);
                 target.style.left=(e.detail.x).toString()+'px';
                  Polymer.dom.flush();
                  break;
              }
 

},

fcCourseObjectObserver: function(newVal)
{
	console.log(newVal, newVal);
},

_computeDate: function(date){
	if(date){
var result = date.toDateString();
  		// result = result.slice(0,10);
  		
  		return result;
}
},
computeCourseDays:function(course)
	{
		//course.
	},

_computeOutput: function(valueOptions, fcCourseObject)
	{
		var length=valueOptions.length;
	 	 var outputArray=[];
	 	for(i=0;i<length;i++)
	  {
	 		var valarr = [];
	 		valarr=valueOptions[i];
	 		var name = valarr[1].label2;
	 			name =name.charAt(0).toLowerCase() + name.slice(1);
	 			name=name.replace(/\s/g,'');
	 		var propertyName ="fcCourseObject."+name;
	 		var eventOutput={
	 			"name":name,
	 			"inputType": "select",
	 			"header":valarr[0].label,
	 			"labelA":valarr[1].label2,
	 			"value": this.fcCourseObject[name] || ""
	 		};
	 		outputArray.push(eventOutput);
	 	}
	 	return outputArray;
	},


inputValueAndLabelSerialization: function(valueOptions)
	 {	
		var length=valueOptions.length;
	 	 var derray=[];
	 	for(i=0;i<length;i++)
	  {	
	 		var valarr = [];
	 		valarr=valueOptions[i];
	
	 		var eventInput={
	 			"name":"",
	 			"inputType": "select",
	 			"header":valarr[0].label,
	 			"labelA":valarr[1].label2,
	 			"labelB":"",
	 			"isRepeaterSelect":true,
	 			"selectItems":valarr[2],
	 			"style":"",
	 			"class": "",
	 			"aside":{	"noteOne:": "",
	 						"noteTwo:": ""}
			};
	 			var name = valarr[1].label2;
	 			name =name.charAt(0).toLowerCase() + name.slice(1);
	 			name=name.replace(/\s/g,'');
	 		eventInput.name=name;
	 		derray.push(eventInput);

	 	}
	 	 return derray;
	 },	
	
	
	


_dateSelected: function(event) {
      var targetOne = event.target;
      while (targetOne.nodeName!=="FC-DATE-MINI"&& targetOne !== this && !targetOne._templateInstance && targetOne.nodeName!="PAPER-ICON-BUTTON" && targetOne.nodeName!="PAPER-MATERIAL" && targetOne.nodeName!="BODY") {
        targetOne = targetOne.parentNode;
       
      }
       if(targetOne.nodeName=="FC-DATE-MINI")
        {
        	this.set("event", targetOne.calendarDay);
        	
        
      
    
      this.sharedElements = {
        'hero': this
      };
      this.fire('on-date-click', {//this is where we pass data... we do not have a click yet... it will be on another level likely
        item: targetOne.data
      });
            this.$.pages.selected = 1;
           }
    },
    _forward: function(){
    	this.$.myCalendarCard._forwardOneMonth();
    },
    _backOne: function(){
    	this.$.myCalendarCard._backOneMonth();
    },

    _setPreviousCaller: function(e, detail)
    {
      
    },

    _onClose: function() {
      this.$.pages.selected = 0;
    },

  computeYear: function(displayedMonth)
{	
	if(this.displayedMonth[15])
	{
	return displayedMonth[15].date.getFullYear();
	}
} 
});
</script>
</dom-module>
