<dom-module id="fc-event-element">
<template>
<style>
:host{
	font-family: merriweather;
	font-size: 14px;
	line-height: 1.0;
	margin-top: 12px;
	background: white;
	position:relative;
	height: 440px;
	width: 330px;
}
paper-item {
	border: 1px solid #adadad;
		background: white;
    --paper-item-focus: {
      background: var(--paper-amber-500);
      font-weight: 600;
    };
    
  }
#demo{
	display: block;
	background: #aedefe;
}
.holder{
	width: 320px;
	height: 400px;
	background: #aedefe;
	margin-left: 2px;
	border: gold ridge 3px;
	box-shadow: 4px 11px 21px 7px #9fafaf;
		display: block;
	oveflow: hidden;
	padding: 3px;
	float: right;
}
.innerholder{
	overflow-y: scroll;
}
.header-class{
font-size: 18px;
color: white;
	background: #03A9F4;
font-weight: 600;
text-align: center;
	padding: 12px;
height: 60px!important;
}
.selected{background: var(--paper-amber-500);
      font-weight: bold;}
.primary{
	color: #008;
	font-weight:600;
	font-size: 15.5px;
}
.secondary{
		color: grey;
	font-weight:500;
	font-size: 11px;

}
.headerLeft{
height: 42px; width: 42px; color: white; float: left;
top: 10px;

}
.headerRight{
	height: 42px; width: 42px; color: white; float: right;
top: 10px;
}
.footerclass{
	height: 32px;
	padding: 14px;
	color: white;
	background: #03A9F4;
	font-weight: 600;
	text-align: center;
	font-size: 11px;
}
.slides{overflow: hidden; overflow-y: scroll;}

.one{
	font-family: merriweather; 
	font-weight: 600;
	color: #080808;
	font-size: 14px;

	white-space: nowrap;
	display: inline-block;
}
.courseData{
	height: 72px!important;

}
</style>
{{currentArray}}{{inputIndex}}
{{valueOptions.2.0.labelA}}, {{valueOptions.2.1.labelA}},
{{valueOptions.2.2.labelA}}, {{valueOptions.2.3.labelA}}
<array-selector 
 	id="eventArraySelector" 
 	items="{{inputArrays}}" 
 	selected="{{selected}}"  
 	toggle>
</array-selector>
<div class="layout vertical" style="margin-top: 3px; float: right;height: 420px!important;">
	<section class="holder layout vertical">
		<template 
			is="dom-repeat" 
			items="{{inputArrays}}" 
			as="option"
		>
<!--HEADER-->
			<section class="header-class layout horizontal">
				<paper-icon-button 
					on-tap="_backOneInput" 
					icon="icons:arrow-back"
					class="headerLeft"
					>
				</paper-icon-button>
				<span 
						class="flex layout horizontal nowrap center center-justified" 
						style="color: white; font-size:18px; margin-top: 4px; text-align: center; font-family: merriweather;"
				>
					[[option.header]]
				</span>
				<paper-icon-button 
						on-tap="_forwardOneInput" 
						icon="icons:arrow-forward" 
						class="headerRight" >
				</paper-icon-button> 
			</section>
<!--END HEADER-->
			<paper-listbox 
					class="layout vertical scroll" 
					style="overflow: hidden; overflow-y: scroll;height: 240px!important;">
				<template 
						is="dom-repeat" 
						items="{{option.selectItems}}" 
						as="value">
						<paper-item 
							on-tap="soSelected" 
							class="layout-horizontal courseData">
							<paper-item-body  
										class="layout vertical one" value$="{{value}}">
									<div 
										class="primary">
										[[value]]
									</div>
									<div 
										class="secondary">
										[[option.labelA]]
									</div>
							</paper-item-body>   	
							<paper-icon-button 
									icon="star" 
									on-tap="soUnSelected" 
									value$="{{val}}" 
									alt="favourite this!">
							</paper-icon-button>
				  		</paper-item>
					</template>
				</paper-listbox>
				<section  
				class="footerclass layout horizontal">
				</section>	
			</template>
</section>
</div>
</template>
<script>
"use-strict";
Polymer({
	is:"fc-event-element",
		behaviors:["FCBehaviors.FcCalendarBehaviorPrime"], 
	properties:{
		eventData:{
			type: Object,
			value: {},
			notify: true, 
			reflectToAttribute: true
		},
		inputArrays:{
			type: Array,
			computed: "setCalendarCreatorNextInput(propertyName, val, valueOptions, inputIndex)",			
			notify: true
		},
		selected: {
			type: Array,
			value: [],
			notify: true
		},
		
		fcCourse: {
			type: FcCourse,
			value:function(){return new FcCourse();},
			notify: true,
		},
		inputIndex: {
			type: Number,
			value: 0,
			notify: true
		},	
		valueOptions: {
			type: Array, 
			notify: true
			},
		inputOptions: {
			type: Array, 
		 	computed:"selectInputs(inputs, inputIndex)",
			notify: true,
			reflectToAttribute: true
		},
		courseCalendarDaysArray:{
			type: Array,
			value: [],
			notify: true

		},
		inputs: {
			type: Array,
			value: [],
			notify: true
		},
		saveChoiceLocal:{
			type: Boolean, 
			value: false,
			notify: true
		},

		calendarDayArray:{
			type: Array,
			value: [],
			notify: true,
			reflectToAttribute: true
		},
		summer:{
			type: Boolean,
			value: false,
			notify: true

		},
		currentArray:{
			type: Number,
			value: 1,
			notify: true
		},
		propertyName:{
			type: String, 
			value: "", 
			notify: true,
		}, 
		val: {
			type: String,
			value: '',
			notify: true,


		}
	
	},

	setCalendarCreatorNextInput(propertyName, val, valueOptions, inputIndex){	
		var curra=1;
		var retArray=[];
		var retVal;
		var self=this;
		var i=self.inputIndex;
		this.vfunc=function(i, curra)
			{
					var retV= valueOptions[curra][i]; 
					return retV;
				}
			this.saveChoiceLocal===true
		switch(true) {
			    case self.inputIndex===0 && propertyName=="" || propertyName==undefined:
			        curra=1;
			   		retVal=this.vfunc(i, curra);
			   		retArray.push(retVal);
			     return retArray;
			        break;
			    case (propertyName=="scheduleType" && val==!"Standard Schedule" && this.saveChoiceLocal===true):
			        curra=3;
			        retVal= self.vfunc(i, curra);
			        retArray.push(retVal);
			   		        break;
			    case (propertyName=="courseType" && val!="Focused 1600SAT Course" && this.saveChoiceLocal===true):
			       curra=4;
			      retVal= self.vfunc(i, curra);
			      retArray.push(retVal);
			     return retArray;
			        break;
			    case (propertyName=="testDate" && this.fcCourse.isPrivateSchedule===false && val.charAt(4)=="A" && this.saveChoiceLocal===true):
			        this.set("fcCourse.summer", true);
			        curra=2;
			        retVal=self.vfunc(i, curra);
			        retArray.push(retVal);
			        return retArray;
			        break;
			    case (propertyName=="coach" && this.fcCourse.summer===true && this.saveChoiceLocal===true):
			        curra=2;
			        retVal=self.vfunc(i, curra);
			       	 retArray.push(retVal);
			        return retArray;
			        break;
			    default: 
			    	curra=1;
			    	retVal=self.vfunc(i, curra);
			    	retArray.push(retVal);
			    	}
			    	console.log(retVal, JSON.stringify(retVal));
			this.saveChoiceLocal=false;
    return retArray;
	},
	

	attached(){
		this._computeInputArrays(this.inputs);	
	},
	_backOneInput()
	{
		this.set("saveChoiceLocal", true);
		this.set("inputIndex", this.inputIndex-1);
	},
	_forwardOneInput()
	{	
		this.set("saveChoiceLocal", true);
		this.set("inputIndex", this.inputIndex+1);
	},

	selectInputs(inputs, inputIndex)
	{		
		var retVal = [];
		if(this.inputIndex===0)	
			{ 		
					retVal.push(inputs[this.inputIndex]);
					//console.log(retVal);
			}
			else if(this.saveChoiceLocal===true)
			{	
				retVal.push(inputs[this.inputIndex]);
				this.set("saveChoiceLocal", false);
			}
			return retVal;
	},
	
	_computeInputArrays(inputs){
		var retArray=new Array();
		retArray.push(this.inputs);//array inputArrays[0][0]
		var arrayOne=this.inputs.filter(function(item, index, array){
			console.log(item);
			return(index<10);
		}, this);
		retArray.push(arrayOne);
		var arrayTwo=[];
		for(var i=0; i<6;i++){
			arrayTwo.push(this.inputs[i]);
			if(i==5)
			{
				arrayTwo.push(this.inputs[12]);
				arrayTwo.push(this.inputs[7]);
				arrayTwo.push(this.inputs[8]);
				arrayTwo.push(this.inputs[9]);
			}
		}
		retArray.push(arrayTwo);
		var miniArr=[0, 2, 13, 14, 4, 5, 10, 11, 17, 16, 14]/*adjust 11, 17, 16 needs Push a set linkag, */
		var arrayThree=miniArr.map(function(elem, index){
			return this.inputs[elem];
		}, this);
		retArray.push(arrayThree);
		var arrayFour=[];
		var miniArr2=[0,1,2, 3, 4, 5, 10,11,13, 14, 16, 17]; //set schedules
		arrayFour= miniArr2.map(function(elem, index){
			return this.inputs[elem];
		}, this);
		retArray.push(arrayFour);
			this.set("valueOptions", retArray);
			console.log(this.valueOptions);
	},

	soSelected(e){
		console.log(new Date().getTime());
		var propertyName = e.model.__data__.option.name;
		var val = e.model.__data__.value;
		var indexOfNextInput=this.inputIndex+1;
		this.set("propertyName", propertyName);
		this.set("val", val);
		var self=this;
		if(propertyName == "testDate")
		{
			this.fcCourse.setTestDate(val);
			 var testDay = new FcCalendarDay(val);
			 testDay.eventList=[];
			 testDay.eventList.push(new FcEvent({activity: "SAT Test Date",name:"SAT Test Date", startTime: "7:30AM", "endTime": "3:45PM", time: "7:30AM", duration: "8.75 Hours", coach: "Focused Coaching", "location": "Check Your Registration", color: "gold",isTestDate: true }));
			this.set("fcCourse.courseCalendarDaysArray", []);
			this.push("fcCourse.courseCalendarDaysArray",testDay);
			this.fcCourse.setTestDate(val);
			this.push("fcCourse.eventArray", testDay);
		}
		else if(propertyName =="coach"){
			
			this.fcCourse.setCoach({fullName: val}, self);
		}
		else if(propertyName == "programLength")
		{	var self=this;	
			this.splice("fcCourse.courseCalendarDaysArray",0,1);
			this.fcCourse.setCourseLength(val, self);
			var testDay;
			testDay=this.shift("fcCourse.eventArray");
			this.push("fcCourse.courseCalendarDaysArray", testDay);	
			this.push("fcCourse.eventArray",testDay);
			 
		}
		else if(propertyName == "practiceTestDay")
		{	

			this.fcCourse.setPracticeTestDay(val, self);
		

		}
		else if(propertyName == "courseMeetingSets")
		{			
		
			var courseMeetings= this.fcCourse.setCourseMeetingDaysAndTimes(val, self);
			this.set("fcCourse.courseMeetingSets",val);
			this.set("fcCourse.summerMeetingDays", "Not Applicable");
			

		}
		else if(propertyName == "summerMeetingDays")
		{	
			this.fcCourse.setCourseMeetingDaysAndTimes(val, self);
			this.fcCourse[propertyName] = val;
			this.set("fcCourse.courseMeetingSets", val);		
			
		}
		else if(propertyName=="privateCoach")
			{	this.set("fcCourse.courseType", "Private Coaching"); 
				this.set("fcCourse.coach", val);
				this.set("fcCourse.courseSize", 1);
			this.fcCourse[propertyName] = val;}
		else if(propertyName=="privateCoachingHours")
		{ 
			this.set("fcCourse.privateCoachingHours", val);
			var retVal = (val=="12 Hours, 4-6 Sessions, Price Total")?"3 Weeks": (val == "18 Hours, 6-9 Sessions, Price Total")?"4 Weeks": (val == "24 Hours, 8-12 Sessions, Price Total")?"5 Weeks": (val == "36 Hours, 12-18 Sessions, Price Total")?"6 Weeks": (val == "50 Hours, up to 25 Sessions, Price Total")?"10 Weeks": "13 Weeks";
			this.set("fcCourse.programLength", retVal);
			//console.log(val);
		}
		else if(propertyName == "testDate" && this.fcCourse.isPrivateSchedule===true)
		{
			this.fcCourse.setTestDate(val);
			this.fcCourse.setCourseLength(this.fcCourse.programLength);

		}
		else
		{
			this.fcCourse[propertyName] = val;
			var propertyString="fcCourse."+propertyName;
			this.notifyPath(propertyString, val);
		
		}
		// var inputIndex =self.inputIndex;
	    //var indexOfNextInput= this.fcCourse.setCourseCreatorNextInput(propertyName, val, inputIndex);
	    this.set("saveChoiceLocal",true);
		this.set("inputIndex", indexOfNextInput);
		console.log(new Date().getTime());

	
}

});
</script>
</dom-module>
