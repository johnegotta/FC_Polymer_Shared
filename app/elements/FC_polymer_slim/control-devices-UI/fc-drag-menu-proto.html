<dom-module id="fc-drag-menu-proto">
<template>
<style>
:host {
  position:fixed;
min-width: 200px !important;}
.edged{
  outline-width: 0px;
}
this.$.elem.person="mary"
Polymer.dom(this.$.elem).setAttribute('person','mary');

.menuItems-light{
  color: #aedafd;
  vertical-align: center;
  margin-top: auto;
  margin-bottom: auto;
}


</style>

<div id="protoMenu"  class="horizontal layout flex" style='max-height: 96px; min-height: 24px; min-width: 236px !important; background: #000066; position: fixed; border: 3px ridge silver;'>
<span draggable$="[[_computestaticmenu(dragmenu)]]" hidden="[[_computestaticmenu(dragmenu)]]" on-track="dragmeplease">
<iron-icon 
            name="fcdragtag"
            
            draggable$="[[_computestaticmenu(dragmenu)]]" 
            icon="icons:label-outline"  
            description="the dragable edge of the card"
            class="menuItems-light"
          >
    </iron-icon>

          
  </span>
 
    <content>
</content>

        <iron-icon
            draggable="[[_computestaticmenu(dragmenu)]]"
            track
            icon="icons:input"  
            on-track="_resetWidth"
            class="center center-justified menuItems-light"
            style="position: absolute; right: -24px; top: 0; background: #000066; border: 2px ridge biege;"

            >

        </iron-icon>
        
</div>
</template>
<script>
FcDragMenuProto = Polymer({
	is:'fc-drag-menu-proto',
	behaviors: [
		Polymer.IronResizableBehavior,
		Polymer.NeonAnimationBehavior,
		Polymer.IronSelectableBehavior,
		Polymer.NeonAnimationRunnerBehavior,
		Polymer.IronMenubarBehavior,
		Polymer.IronRangeBehavior],
	properties: {
          	class: {
                type: String,
                value: function(){
                    return 'horizontal layout';
                }, 
                notify: true,
                reflectToAttribute: true
               },
            dragmenu:{
                type: Boolean,
                value: false,
                reflectToAttruibute: true,
                notify: true
               },
            staticmenu:{
                type: Boolean,
                computed:'_computestaticmenu(dragmenu)',
                notify: true
               },
            currentWidth:{
                  type: String, 
                  value: function(){
                            return '280';
                      },
                  notify: true, 
                  reflectToAttribute: true
              },

                slide:{
                        type: Boolean,
                        value: false,
                        notify: true
                },

                _leftHidden: {
                  type: Boolean,
                  value: false
                },
                _rightHidden: {
                  type: Boolean,
                  value: false
                },
                _previousButton: {
                  type: Object
              },
              hostAttributes: {
                role: 'tabList'
              },
              listeners: {
                'iron-resize': '_onResize',
              },
              hostAttributes: {
                'role': 'menubar'
              },
              keyBindings: {
                'left': '_onLeftKey',
                'right': '_onRightKey'
              } 
          },
    
    created: function() {
      this._holdJob = null;
    },
    ready: function() {
      this.setScrollDirection('y', this.$.tabsContainer);
    },
    attached: function(){
    
    },
    _computestaticmenu: function(dragmenu){
        return dragmenu;
    },
     _onResize: function() {
      this.debounce('_onResize', function() {
        this._scroll();
        this._tabChanged(this.selectedItem);
      }, 10);
    },
   
    	_toggleRightDrawer: function(){
			var drawer = document.querySelector('#drawer-2');	
			if(drawer.forceNarrow!==true)
			{drawer.forceNarrow = true;}
			else{drawer.forceNarrow = false;
			}
	},
	_toggleLeftDrawer: function(){
		var drawer = document.querySelector('#drawerPrimed');
          var dashboard = document.querySelector("#dashboardPrime");	
		if(drawer.forceNarrow!==true)
          {
               drawer.forceNarrow = true;
               drawer.responsiveWidth='90000px';
               dashboard.leftHidden=true;
          }
          else
          {
               drawer.forceNarrow = false;
               drawer.responsiveWidth ='1080px';
               dashboard.leftHidden=false;

          }
     },

	
  

	dragmeplease: function(e) {
    if (!this.staticmenu==true){
      console.log(this.staticmenu, this.dragmenu);
     this.dragging=true;
        var self=this;
      e.preventDefault();
        switch(e.detail.state) {
          case 'start':
            self.currentX =e.detail.x;
            self.currentX =e.detail.x;
            console.log('START');
            console.log(e);
            break;
          case 'track':
            self.currentX =e.detail.x;
            self.translate3d(e.detail.dx.toString() + 'px', e.detail.dy.toString() + 'px', 0);
            break;
          case 'end':
            console.log("ENDING", e.detail.x, e.detail.y, e.detail.dx, e.detail.dy);
            self.translate3d(0, 0, 0);
            self.style.left = e.detail.x.toString() + 'px';
            self.style.top = e.detail.y.toString() + 'px';
            self.dragging=false;
            break;
        };
      }
      else return;

     }, 

     _resetWidth: function(e){
          var self=this;
          e.preventDefault();
              switch(e.detail.state) {
                case 'start':
                  console.log(e.detail);
                  break;
                case 'track':
                  var nwidth = parseInt(self.currentWidth) + e.detail.ddx;
                  var trueWidth = nwidth.toString()+'px';
                  self.currentWidth=trueWidth;
                  this.$.protoMenu.style.width= trueWidth;
                  var insertionPoint = Polymer.dom(this.root).querySelector('content');
                  var distributed = Polymer.dom(insertionPoint).getDistributedNodes()[1];
                  distributed.style.width= trueWidth;
                
                  break;
                case 'end':
               
                  break;
          }
        },
          _computeWidth: function(currentWidth){
                   return currentWidth;
    }


});
  </script>
</dom-module>


