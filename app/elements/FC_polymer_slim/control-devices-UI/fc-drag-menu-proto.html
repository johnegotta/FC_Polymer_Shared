<dom-module id="fc-drag-menu-proto">
<template>
<style>
:host {
  position:fixed;
}
.menubuttons{
  display: inline-block; 
  width: 36px; 
  height: 36px;
  background: silver;
  z-index: 1;
  box-shadow: 0px  -5px 15px #d9d9d9 inset;
  align-items: flex-start;
    text-align: center;
    cursor: default;
    color: buttontext;
    border-image-source: initial;
    border-image-slice: initial;
    border-image-width: initial;
    border-image-outset: initial;
    border-image-repeat: initial;
    /*background-color: buttonface;*/
    box-sizing: border-box;
    padding: 2px 6px 3px;
    /*border: 2px outset buttonface;*/

}
.longer{width: 64px;}
.longest{width: 108px;}
.mini{width: 64px; height: 48px; color: green; border: 1px solid #008; font-size: 12px;}
.micro{color: #008; width: 16px; height: 16px;} 

.menuItems-light{
  color: #aedafd;
  vertical-align: center;
  margin-top: auto;
  margin-bottom: auto;
}


</style>
<div id="protoMenu"  class="horizontal layout flex" style='max-height: 96px; min-height: 24px; min-width: 320px!important; background: #000066; border: 3px ridge silver;'>
  <span draggable$="[[_computestaticmenu(dragmenu)]]" hidden="[[_computestaticmenu(dragmenu)]]">
<!-- 
   on-track="dragmeplease" -->
      <iron-icon 
        name="fcdragtag"
        
        draggable$="[[_computestaticmenu(dragmenu)]]" 
        icon="icons:label-outline"  
        description="the dragable edge of the card"
        class="menuItems-light"
      >
      </iron-icon>     
  </span>
  <section class="menubuttons longer" style="min-width: 63px; height: 48px; width: 63px !important; max-width: 64px; font-size: 24px" on-tap="_toggleLeftDrawer" >
      <b>L</b>
      <iron-icon
        icon="icons:swap-horiz"  
        class="menuItems-dark"      
      >
      </iron-icon>
  </section>
  <section on-down="dragsOff" on-up="dragsOn">
    <content>
    </content>
 </section>
  <section 
    class="menubuttons longer layout horizontal"
    style="min-width: 63px; height: 48px; width: 63px !important; max-width: 64px; font-size: 24px" 
    on-tap="_toggleRightDrawer"
    >
      <iron-icon 
        icon="icons:swap-horiz"  
        class="menuItems-dark"
      >
      </iron-icon>
      <b>R</b>
  </section>
  <section 
    class="menubuttons mini" 
    on-tap="swapMenu">
      MENU
    <iron-icon 
      icon="icons:autorenew"  
      class="menuItems-dark micro"    
      >
    </iron-icon>
    SWAP
</section>  
<section on-down="dragsOff" on-up="dragsOn">
  <iron-icon
    draggable="[[_computestaticmenu(dragmenu)]]"
    track
    icon="icons:input"

    on-track="_resetWidth"
    class="center center-justified menuItems-light"
    style="background: #000066; border: 2px ridge biege;"
    >
  </iron-icon>
</section>        
</div>
</template>
<script>
FcDragMenuProto = Polymer({
	is:'fc-drag-menu-proto',
	behaviors: [
    FCBehaviors.DraggableBehavior,
		Polymer.IronResizableBehavior,
		Polymer.NeonAnimationBehavior,
		Polymer.IronSelectableBehavior,
		Polymer.NeonAnimationRunnerBehavior,
		Polymer.IronMenubarBehavior,
		Polymer.IronRangeBehavior],
	properties: {
          	class: {
                type: String,
                value: function(){
                    return 'horizontal layout';
                }, 
                notify: true,
                reflectToAttribute: true
               },
            notRouter:{
              type: Boolean,
                value: function(){
                return true;
                  },
              notify: true
                },
            dragmenu:{
                type: Boolean,
                value: false,
                reflectToAttruibute: true,
                notify: true
               },
            staticmenu:{
                type: Boolean,
                computed:'_computestaticmenu(dragmenu)',
                notify: true
               },
            currentWidth:{
                  type: String, 
                  value: function(){
                            return '280';
                      },
                  notify: true, 
                  reflectToAttribute: true
              },

                slide:{
                        type: Boolean,
                        value: false,
                        notify: true
                },

                _leftHidden: {
                  type: Boolean,
                  value: false
                },
                _rightHidden: {
                  type: Boolean,
                  value: false
                },
                _previousButton: {
                  type: Object
              },
              hostAttributes: {
                role: 'tabList'
              },
              listeners: {
                'iron-resize': '_onResize',
              },
              hostAttributes: {
                'role': 'menubar'
              },
              keyBindings: {
                'left': '_onLeftKey',
                'right': '_onRightKey'
              } 
          },
    
    created: function() {
      this._holdJob = null;
    },
    ready: function() {
      this.setScrollDirection('y', this.$.tabsContainer);
    },
    attached: function(){
    
    },
    _computestaticmenu: function(dragmenu){
        return dragmenu;
    },
     _onResize: function() {
      this.debounce('_onResize', function() {
        this._scroll();
        this._tabChanged(this.selectedItem);
      }, 10);
    },
   
    	_toggleRightDrawer: function(){
			var drawer = document.querySelector('#drawer-2');	
			if(drawer.forceNarrow!==true)
			{drawer.forceNarrow = true;}
			else{drawer.forceNarrow = false;
			}
	},
	_toggleLeftDrawer: function(){
		var drawer = document.querySelector('#drawerPrimed');
          var dashboard = document.querySelector("#dashboardPrime");	
		if(drawer.forceNarrow!==true)
          {
               drawer.forceNarrow = true;
               drawer.responsiveWidth='90000px';
               dashboard.leftHidden=true;
          }
          else
          {
               drawer.forceNarrow = false;
               drawer.responsiveWidth ='1080px';
               dashboard.leftHidden=false;

          }
     },
     swapMenu: function(){
      this.notRouter = !this.notRouter;
    },


     _resetWidth: function(e){
          var self=this;
          e.preventDefault();
              switch(e.detail.state) {
                case 'start':
                  console.log(e.detail);
                  break;
                case 'track':
                  var nwidth = parseInt(self.currentWidth) + e.detail.ddx;
                  var trueWidth = nwidth.toString()+'px';
                  self.currentWidth=trueWidth;
                  this.$.protoMenu.style.width= trueWidth;
                  var insertionPoint = Polymer.dom(this.root).querySelector('content');
                  var distributed = Polymer.dom(insertionPoint).getDistributedNodes()[1];
                  distributed.style.width= trueWidth;
                
                  break;
                case 'end':
               
                  break;
          }
        },
         swapMenu: function(){
          this.notRouter = !this.notRouter;
          },
          _computeWidth: function(currentWidth){
                   return currentWidth;
    }


});
  </script>
</dom-module>


