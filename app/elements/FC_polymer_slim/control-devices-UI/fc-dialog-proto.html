<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../paper-dialog-behavior/paper-dialog-behavior.html">
<link rel="import" href="../paper-dialog-behavior/paper-dialog-shared-styles.html">
<!--
Material design: [Dialogs](https://www.google.com/design/spec/components/dialogs.html)

`<paper-dialog>` is a dialog with Material Design styling and optional animations when it is
opened or closed. It provides styles for a header, content area, and an action area for buttons.
You can use the `<paper-dialog-scrollable>` element (in its own repository) if you need a scrolling
content area. See `Polymer.PaperDialogBehavior` for specifics.

For example, the following code implements a dialog with a header, scrolling content area and
buttons.

    <paper-dialog>
      <h2>Header</h2>
      <paper-dialog-scrollable>
        Lorem ipsum...
      </paper-dialog-scrollable>
      <div class="buttons">
        <paper-button dialog-dismiss>Cancel</paper-button>
        <paper-button dialog-confirm>Accept</paper-button>
      </div>
    </paper-dialog>

### Styling

See the docs for `Polymer.PaperDialogBehavior` for the custom properties available for styling
this element.

### Animations

Set the `entry-animation` and/or `exit-animation` attributes to add an animation when the dialog
is opened or closed. See the documentation in
[PolymerElements/neon-animation](https://github.com/PolymerElements/neon-animation) for more info.

For example:
-->
    <link rel="import" href="components/neon-animation/animations/scale-up-animation.html">
    <link rel="import" href="components/neon-animation/animations/fade-out-animation.html">
<!--
    <paper-dialog entry-animation="scale-up-animation"
                  exit-animation="fade-out-animation">
      <h2>Header</h2>
      <div>Dialog body</div>
    </paper-dialog>

### Accessibility

See the docs for `Polymer.PaperDialogBehavior` for accessibility features implemented by this
element.

@group Paper Elements
@element paper-dialog
@hero hero.svg
@demo demo/index.html
-->

<dom-module id="fc-dialog-proto">
  <template>
    <style include="paper-dialog-shared-styles">
    :host{
          background: white; 
          border-radius: 16px;
          border: 8px double #000066;
          min-width: 320px;
          max-width: 900px;
          min-height: 340px;
          max-height: 900px;
          box-shadow: 10px 5px 5px #afafaf;
          padding: 6px 8px 6px 8px;
          margin: 6px; 
          position: absolute;
          
        }

    </style>
 <iron-icon 
            icon="icons:highlight-off" 
            name="fc-dialog-closer"
            on-tap="_closeDialog"
            description="the dragable edge of a panel intended to change height"
            class="menuItems-light"
            style="position: absolute; width: 26px; height: 26px; right: -22px; top: -22px;"
          >
      </iron-icon>
  <iron-icon 
            icon="icons:open-with" 
            name="fc-dragtag"
            on-track="dragmeplease"
            track
            draggable="true"
            description="the dragable edge of a panel intended to change height"
            class="menuItems-light"
            style="position: absolute; width: 26px; height: 26px; left: -22px; top: -22px;"
          >
  </iron-icon>
   
    
    <content></content>
  <iron-icon 
            icon="icons:aspect-ratio" 
            name="fc-resizer"
            on-track="_resize"
            track
            draggable="true"
            description="the dragable edge of a panel intended to change height"
            class="menuItems-light"
            style="position: absolute; width: 26px; height: 26px; right: -26px; bottom: -26px;"
          >
      </iron-icon>
  </template>


<script>

(function() {

  Polymer({

    is: 'fc-dialog-proto',

    behaviors: [
      Polymer.PaperDialogBehavior,
      Polymer.NeonAnimationRunnerBehavior
    ],

    listeners: {
      'neon-animation-finish': '_onNeonAnimationFinish'
    },

    properties: {
      selectionArray: {
        type: Array,
        value: function(){
          return [
                'first', 
                'second', 
                'third', 
                'fourth'
          ];
        },
        notify: true
      },
      selected: {
        type: String,
        computed: 'computeSelected(selectionArray)',
        notify: true
      },

      currentWidth: {
          type: String, 
          value: function(){
                    return '320';
              },
          notify: true, 
          reflectToAttribute: true
      },
      currentHeight: {
          type: String, 
          value: function(){
                    return '320';
              },
          notify: true, 
          reflectToAttribute: true
      }


    },

    computeSelected: function(selectionArray){
      return `[name=first]`;


    },

    _renderOpened: function() {
      if (this.withBackdrop) {
        this.backdropElement.open();
      }
      this.playAnimation('entry');
    },

    _renderClosed: function() {
      if (this.withBackdrop) {
        this.backdropElement.close();
      }
      this.playAnimation('exit');
    },

    _onNeonAnimationFinish: function() {
      if (this.opened) {
        this._finishRenderOpened();
      } else {
        this._finishRenderClosed();
      }
    },

    _resize: function(e){
          var self=this;
          e.preventDefault();
              switch(e.detail.state) {
                case 'start':
                  console.log(e.detail);
                  break;
                case 'track':
                  var newheight = parseInt(self.currentHeight) + e.detail.ddy;
                  var nwidth = parseInt(self.currentWidth) + e.detail.ddx;
                  var trueWidth = nwidth.toString()+'px';
                  var trueHeight = newheight.toString()+'px';
                  self.currentWidth=trueWidth;
                  self.currentHeight=trueHeight
                  this.style.width= trueWidth;
                  this.style.height= trueHeight;
                  console.log(this, 'w:' + trueWidth, 'h:' + trueHeight, 'ddx:' + e.detail.ddx, 'ddy: ' + e.detail.ddy);
                
                  break;
                case 'end':
               
                  break;
          }
        },
        _closeDialog: function(){
          this.close();


        },
      dragmeplease: function(e) {
     this.dragging=true;
        var self=this;
      e.preventDefault();
        switch(e.detail.state) {
          case 'start':
            var left=self.root.getBoundingRect().left;
            console.log('START', left);
            console.log(e);
            break;
          case 'track':
            self.translate3d(e.detail.dx.toString() + 'px', e.detail.dy.toString() + 'px', 0);
            break;
          case 'end':
            console.log("ENDING", e.detail.x, e.detail.y, e.detail.dx, e.detail.dy);
            self.translate3d(0, 0, 0);
            self.style.left = e.detail.x.toString() + 'px';
            self.style.top = e.detail.y.toString() + 'px';
            self.dragging=false;
            break;
        }
     }, 

});
})();

</script>
</dom-module>
