<dom-module id="fc-date-card">
 
<style>
 :host{
          margin: 2px;
          min-width: 50px;
          max-width: 1300px;
          min-height: 120px;
          max-height: 1300px;
         /*//position: fixed; */
        }
        fc-input{max-width: 121px!important;}
  form {
      display: flex;
      flex-direction: row;
      margin-bottom: 20px;
    }
     paper-header-panel {
        float: left;
        background: white;
        max-width: 780px;
        min-width: 65px;
        max-height: 1280px;
        min-height: 112px;
        margin: 2px;
        border: 4px solid #efefef;
        @apply(--shadow-elevation-2dp);
      }
      .paper-header {
        height: 36px;
        font-size: 22px;
        line-height: 26px;
        padding: 4px;
        color: white;
        transition: height 0.2s;
      }
      .paper-header.tall {
        height: 60px;
      }
      .paper-header.medium-tall {
        height: 48px;
        line-height: 40px;
      }
      .content {
        height: 2500px;
      }
      .cover {
        margin: 2px;
      }
      .blue .paper-header {
        background-color: var(--paper-light-blue-500);
      }
      .red .paper-header {
        background-color: var(--paper-red-500);
      }
      .orange .paper-header {
        background-color: var(--paper-amber-500);
      }
      .green .paper-header {
        background-color: var(--paper-green-500);
      }
      .cyan .paper-header {
        background-color: var(--paper-cyan-500);
      }
      .lime .paper-header {
        background-color: var(--paper-lime-500);
      }
      .pink .paper-header {
        background-color: var(--paper-pink-a200);
      }
      .grey .paper-header{
        background-color: var(--paper-indigo-50);

      }
      .grey .content{background: #E;}
.todaysEvent paper-icon-button[icon=delete]{
			-webkit-transition: opacity 0.5s;
			transition: opacity 0.5s;
			opacity: 0;
		}
		.todaysEvent:hover paper-icon-button[icon=delete]{
			opacity: 100;
		}

		paper-button {
		  flex-shrink: 1;
		}
		fc-input-prime {
      max-width: 95;
		  flex-shrink: 1;
		}

		checkbox {
		  display: inline-block;
		  margin: 1px 0;
		  transition: opacity 0.3s;
		}

		paper-checkbox[checked] + .label {
		  opacity: 0.5;
		  text-decoration: line-through;
		}
	
   .content {
           padding-bottom: 22px;
           margin-bottom: 23px;
      }
      .red .content {
        background: linear-gradient(white, #ffcdd2);
      }
      .orange .content {
        background: linear-gradient(white, #ffecb3);
      }
      .green .content {
        background: linear-gradient(white, #c8e6c9);
      }
      .cyan .content {
        background: linear-gradient(white, #b2ebf2);
      }
      .lime .content {
        background: linear-gradient(white, #f0f4c3);
      }
      .pink .content {
        background: linear-gradient(white, #f8bbd0);
      }
</style>
<template>
  <paper-header-panel id="focusedDateCard" drags="true" id$="{{relId}}" style="height: [[_computeCurrentHeight(isMini)]]; width:[[_computeCurrentWidth(day, id, isAddingEvent)]] padding-right: 2px;" class="blue">


     <div class="paper-header" style="text-align: center;padding-right: 2px;">     
        <section class="layout horizontal nowrap"  > 
              <section class="vertical flex-9 layout" on-tap="toggle" style="text-align: center;">[[computePrettyDay(day)]]</section>
             <section class="horizontal flex-2 layout" style="font-size:9px;">Open<iron-icon icon="icons:swap-vertical-circle"></iron-icon></section> 
             
        </section>
     </div>
       <div style="height: 2500px;" class="content vertical layout"> 
     
          <form>
            <section class="horizontal layout flex nowrap">
          <fc-input-prime 
             input-type="text"
             class="nowrap" is-inline="true"  
            name="eventName" 
            label="Event Name" 
            value="{{eventName}}">
          </fc-input-prime>
          <fc-input-prime 
             input-type="datetime-local"
             class="nowrap" is-inline="true"
             step="30"  
            name="eventStartTime" 
            label="Start Time" 
            value="{{startTime}}">
          </fc-input-prime>
          </section>
           <section class="horizontal layout flex nowrap">
           <fc-input-prime 
            input-type="datetime-local" 
            class="nowrap" is-inline="true"
            step="30" 
            name="eventEndTime" 
            label="End Time" 
            value="{{endTime}}">
          </fc-input-prime>
          <paper-icon-button icon="icons:add-circle-outline" class="blue-btn-class" on-click="addTodaysEvent">
          </paper-icon-button>
          </section>
      </form>
      <div class="layout vertical" style="height:180px; overflow: hidden; border: ridge 4px silver;" >
      <div class="layout vertical flex wrap" style="background: white; max-width: 280px; border: silver solid 2px; max-height: 340px; overflow: hidden; overflow-y: scroll; overflow-x: scroll">
      <template is="dom-repeat" items="{{todaysEvents}}">
          <div class="event">
            <paper-checkbox
              on-change="toggleItem"
                checked="{{item.done}}"></paper-checkbox>
               <section class="vertical layout">
                <span class="event">[[item.eventName]]</span>
              <span class="label">[[item.startTime]] to[[item.endTime]]</span>
              <div id="collapse" style="color:#008;" class="event location"> 
                  <paper-item style="background:[[item.color]]"><fc-grid-cell  gc-readonly gc-label="{{item.eventName}}" gc-value="{{item.location}}"></fc-grid-cell>  <fc-grid-cell gc-readonly="false" gc-value=[[item.eventlocation]]></fc-grid-cell></paper-item>

                <paper-item style="background:[[item.color]]">  <fc-grid-cell gc-readonly="false" gc-value$="[[item.startTime]]"></fc-grid-cell>  <fc-grid-cell gc-readonly="false" gc-value$="{{item.endTime}}"></fc-grid-cell></paper-item>

  <paper-item style="background:[[item.color]]"> <fc-grid-cell readonly=false gc-value="{{item.description}}"></fc-grid-cell>  <fc-grid-cell gc-readonly="false" gc-value="{{item.duration}}"></fc-grid-cell>  </paper-item>         
     
      <paper-item style="background:[[item.color]]">      <fc-grid-cell value="{{item.studentNumber}}"></fc-grid-cell>  <fc-grid-cell gc-value="{{item.connectedFCIDs}}"></fc-grid-cell>   </paper-item>
                   </div>
              </section>
          </div>
      </template>
      </div>
     </div>
     </div>
  </paper-header-panel>
</template> 
<script>
FcDateCard=Polymer({
	is:'fc-date-card',

	properties: {
     todaysEvents: {
        type: Array,
        value: function(){
          return [  { 
                "dateToday": this.day,
                'eventName': "SAT Practice Test", 
                'startTime': "09:00" + "AM",
                'endTime': "12:45" + "PM", 
                'location': "704 Ginesi, Morganville, Focused",
                'description': "Practice Test for New and Enrolled Students",
                'duration': 3.75,
                "color": "#ff00b6",//fuscia bright
                "studentNumber": 47,
                "assocRevenue": 94000,
                "revenuePeriodDays":41,
                "revenuePeriodHours":144, //two teacher minimum plus prep et al
                "perDiem":  2292,
                "perWorkHour": 564,
                "connectedFCIDs": ["RimakisGeorge00001", "GottaJohn00001", "ZirkelJoe00001", "ColleretteStacy00001", "RazzaMustaffa00001", "SatMorgamvilleUnderAbove",],
                 "done": false
                },
                {"dateToday": this.day,
                'eventName': "George Private Tutoring",
                'startTime': "01:00" + "PM",
                'endTime': "04:00" +"PM", 
                'location': "704 Ginesi, Morganville, Focused",
                'description': "Privare Tutoring, with Richard Rich IBS",
                'duration': 3,
                "color": "#00ff3b",//green
                "studentNumber": 1,
                "assocRevenue": 8400,
                "revenuePeriodDays":41,
                "perDiem":  23,
                "revenuePeriodHours":40, //two teacher minimum plus prep et al
                "perWorkHour": 210,
                "connectedFCIDs": ["RimakisGeorge00001", "RichRichardIBS00001"],
                "done": false,
                }
              ];
          },
        notify: true
        },
		drags:{
			type: Boolean, 
			value: false,
			notify: true
		},
    times:{
      type: Date,
      notify: true,
    },
    eventHidden:{
      type: Boolean,
      value: false,
      notify: true
    },
		isResizing: {
			type: Boolean,
			value: false, 
			notify: true
		},
    notFixed:{
      type: Boolean,
      value: function(){return true;},
      notify: true
    },
		isAddingEvent: {
			type: Boolean,
			value: false,
			notify: true
		},
		
      isMini: {
        type: Boolean,
        value: false,
        notify: true,
        reflectToAttribute: true
      },
      selected: {
        type: String,
        notify: true
      },
      currentHeight: {
          type: String, 
     	  computed: "_computeCurrentHeight(isMini)",
          notify: true, 
          reflectToAttribute: true
      },
      day:{
      		type: Date,
      		notify: true,
      		reflectToAttribute: true
      },
      theId: {
      	type: String, 
      	notify: true,
      },
      id:{
      	type: String,
      	computed: "_computeId(theId, day)",
      	notify: true
      }
      
    },
    behaviors:["fcDraggableDataBehavior", "Polymer.IronResizableBehavior"],
    attached: function(){
    	// this.center();
    	
    },
    computePrettyDay: function(day)
  {
      var result = day.toDateString();

      
      return result;
  },
   
    _computeCurrentHeight: function(isMini){
      if(isMini==true)
      {   
        return "70px";   
      }
      else{ return "360px";}
    },
    _computeCurrentWidth:function(day, id, isAddingEvent){
       Polymer.dom.flush();
       var resizer = this.parentNode;
       var w = parseInt(window.getComputedStyle(resizer, null).getPropertyValue("width"));
       while(w==NaN && resizer!=document.body){
        resizer=resizer.parentNode;
        w== parseInt(window.getComputedStyle(resizer, null).getPropertyValue("width"));
console.log(w);
       } 
       var z = parse.Int(window.getComputedStyle(resizer, null).getPropertyValue("width"));
       console.log(z);
            var wn=Math.ceil(z/7.8);
      var width=wn.toString() + "px";
      
      this.notifyResize();
      return width;  
    },



  toggle: function()
    { 
        console.log(this.$.collapse);},
    _computeId: function(theId, day){
    	//console.log(theId, day, day, day, day, theId);
    },
    // computeSelected: function(selectionArray){
    //   return "[name=first]";
  
    // },
    _computeRelId: function(day){
    	 var dayId	= day.replaceAll("\\s+","");
    	 //console.log(dayId, dayId, dayId, dayId);
    	 return dayId;
    },
    // computeId:function(theId){
    // 	//console.log(theId, theId, theId, theId, theId, theId);
    // },
});
</script>
</dom-module>

<!-- 

<template>
  <style>
    form {
      display: flex;
      flex-direction: row;
      align-items: center;
      margin-bottom: 20px;
    }
    .eventItem, paper-icon-button[icon=delete]{
      -webkit-transition: opacity 0.5s;
      transition: opacity 0.5s;
      opacity: 0;
    }
    .eventItem:hover paper-icon-button[icon=delete]{
      opacity: 100;
    }
    .eventTime{}
    .eventTime:hover {}

    paper-button {
      flex-shrink: 1;
    }
    paper-input {
      flex-grow: 1;
    }

    paper-checkbox {
      display: inline-block;
      margin: 5px 0;
      transition: opacity 0.3s;
    }

    paper-checkbox[checked] + .label {
      opacity: 0.5;
      text-decoration: line-through;
    }
  </style>
    <firebase-auth
        location="[[firebaseURL]]"
        provider="[[firebaseProvider]]"
        on-login="onFirebaseLogin"
        on-logout="onFirebaseLogout">
    </firebase-auth>
    <paper-toast id="errorToast">
    </paper-toast>
    <form on-submit="addItem">
          <paper-input 
            value="{{newItemValue}}" 
            placeholder="Enter your item here...">
          </paper-input>
          <paper-button on-click="addItem">
            Add
          </paper-button>
      </form>
      <template is="dom-repeat" items="{{toDos}}">
          <div class="toDoItem">
            <paper-checkbox
              on-change="toggleItem"
                checked="{{item.done}}"></paper-checkbox>
              <span class="label">[[item.text]]</span>
              <paper-icon-button
              icon="delete" 
                on-tap="deleteItem">
              </paper-icon-button>
          </div>
      </template>
  </template>
  <script>
  Polymer({
    is: 'fc-todaysEventCard',
    properties: {
      today: {
        type: Date,
        value: funct


      },
      todaysEvents: {
        type: Array,
        value: function(){
          return [  { 
                'eventName': this.eventName
                'startTime': this.startTime,
                'endTime': this.endTime, 
                'location': this.eventLocation,
                'description': this.eventDescription,
                'duration': this.eventDuration,
                },
                {
                'eventName': this.eventName
                'startTime': this.startTime,
                'endTime': this.endTime, 
                'location': this.eventLocation,
                'description': this.eventDescription,
                'duration': this.eventDuration,
                }
              ];
          },
        notify: true
        },
      todaysEvent: {
        type: Object,
        value: {
          eventName: String,
          startTime: String,
          endTime: String, 
          location: String,
          duration: Number,
          description: String
          },
        notify: true
        },
      firebaseURL: {
        type: String, 
        value: "https://focused0ne.firebaseio.com/todaysEvents",
        notify: true
        },
      firebaseProvider: {
        type: String,
        value: 'password',
        notify: true
        },
      completedTodaysEvents:{
        type: Array,
        computed: 'computeCompletedTodaysEvents(completedTodaysEvents, todaysEvent)',
        notify: true
      },
      todaysEvent:{
        type: Object, 
        value: {
          done: true,
          dateStarted: Date,
          dateCompleted: Date, 
          userFullName: function(){return 'Jason C. Frazzano';},
          notes: String
        },
        notify: true
        }
      },
    addEventToday: function(event) {
        event.preventDefault(); // Don't send the form!
        this.push('todaysEvents', {
          done: false,
          text: newItemValue
      });
        this.newTodaysEvent = '';
    },

    toggleEventToday: function(event) {
        event.model.todaysEvent.set('over', !event.model.todaysEvent.over);
    },

    deleteItem: function(event) {
        this.splice('todaysEvent', event.model.index, 1);
    },

    computeTodaysCompletedEvents: function(event, eventsCompletedToday, todaysEvent){
      return {"silly": "object"};
    },

    onFirebaseLogin: function(event) {
        this.ref = new Firebase(this.firebaseURL + '/users/' + 
                                                      event.detail.user.uid);
        this.ref.on('value', function(snapshot) {
          this.updateTodaysEvents(snapshot);
        }.bind(this));
    },

    onFirebaseError: function(event) {
        this.$.errorToast.text = event.detail.message;
        this.$.errorToast.show();
          },
  
    onFirebaseLogout: function(event) {
      this.updateTodaysEvents();
    },

    updateEvents: function(snapshot) {
        this.eventsToday = [];
        snapshot.forEach(function(childSnapshot) {
          var item = childSnapshot.val();
          item.uid = childSnapshot.key();
          this.push('eventsToday', item);
        }.bind(this));
    },

    addItem: function(event) {
        event.preventDefault();
        this.ref.push({
          'eventName': this.eventName
          'startTime': this.startTime,
          'endTime': this.endTime, 
          'location': this.eventLocation,
          'description': this.eventDescription,
          'duration': this.eventDuration,
        });
        this.newItemValue = '';
    },

    toggleItem: function(event) {
        this.ref.child(event.model.item.uid).
          update({done: event.model.item.done});
    },

    deleteItem: function(event) {
        this.ref.child(event.model.item.uid).remove();
    }
  }); -->