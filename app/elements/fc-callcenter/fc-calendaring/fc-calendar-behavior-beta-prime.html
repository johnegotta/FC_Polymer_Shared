<script>
"use strict";


Date.prototype.dayStamp= function()
{
 	var year= this.getFullYear(); 
	var month= this.getMonth();
	var day = this.getDate();
    var dayStamp= Date.UTC(year, month, day);
    return dayStamp;
}	
function courseFcidGenerator(testDate, coachFcid, location, meetingDays, practiceTestDay, startTime, endTime, eventDateArray){
	var len =eventDateArray.length;
	var weekdays="";
	var mdays= meetingDays.replace(/\s/g,'');
	var arr=mdays.split(',');
	var len = arr.length;
	for(var i=0;i<len; i++){
	weekdays += arr[i][2];
	}
	startTime=startTime.replace(":", "");
	endTime=endTime.replace(":","");
	//console.log(endTime);
	var fcid= dayStamp(testDate)+"_"+coachFcid+location+startTime+weekdays+endTime+"_"+len.toString()+practiceTestDay;
	//console.log(fcid);
	return fcid;
}
function duration(timeOne, timeTwo){
	var startHrs = stringTime(timeOne);
	var endHrs = stringTime(timeTwo);
	var tot=endHrs-startHrs;
	//console.log(tot);
	return tot;	
}

function costGenerator(numberOfHours)
{
	var cost = (numberOfHours<50)?numberOfHours*60:(numberOfHours<75&&numberOfHours>50)?numberOfHours*55:numberOfHours*50;
	return cost;
	
}
function stringTime(time)
{
	var start = parseInt(time);
	//console.log(start);
	var len = time.length;
	var ampm = (start!==12 && time.charAt(len-2)=="P")?12: 0;
	ampm=parseInt(ampm);
	var hoursStart = ampm+start;
	//console.log(hoursStart, ampm, start);
	var minStart =(parseInt(time.charAt(len-4))*10)+parseInt(time.charAt(len-3));
	var minHundreds =minStart/60;
	//console.log(minStart, minHundreds);
	var tot=hoursStart +minHundreds;
	//console.log(tot);
	return tot;
}

/* Modifications to Date prototype*/
Date.prototype.getFullMonth = function()
{
	var dat = new Date(this.valueOf());
	var monArray = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
	return monArray[dat.getMonth()];
}

Date.prototype.addDays = function(days) {
       var dat = new Date(this.valueOf())
       dat.setDate(dat.getDate() + days);
       return dat;
}

/* truncates hours, minutes, seconds and reports timestamp of beginning of day*/
Date.prototype.dayStamp= function()
{
 	var year= this.getFullYear(); 
	var month= this.getMonth();
	var day = this.getDate();
    var dayStamp= Date.UTC(year, month, day);
    return dayStamp;
}	

function getDates(startDate, stopDate)
{
      var dateArray = new Array();
      var currentDate = startDate;
      while (currentDate <= stopDate)
      {
        dateArray.push(currentDate)
        currentDate = currentDate.addDays(1);
      }
      return dateArray;
}

class FcEvent
{
	constructor(argEvent)
	{
		this.build(argEvent.name, argEvent.startTime, argEvent.endTime, argEvent.holiday, argEvent.fcid, argEvent.location, argEvent.completed, argEvent.relatedFcids, argEvent.parentEventName, argEvent.parentEventFcid)
	}

	static getFirebaseLocation(theDate)
	{
		return "https://focused0ne.firebaseio.com/events";
	}

  	build(name, startTime, endTime, holiday, fcid, location, completed, relatedFcids,  parentEventName, parentEventFcid)
  	{
	    this.name = name || ""; 
	    this.startTime = new Date(startTime) || new Date();// console.log(this.startTime);
	    this.endTime = new Date(endTime) || ""; 
	    if(fcid)
	    {
	    	this.fcid=fcid
	    }
	    else
	    { 
	    	this.fcid="";
	    }
	    this.location = location || "704 Ginesi Dr. Morganville, New Jersey 07754"; 
	    this.completed = completed || false;
	    this.relatedFcids = relatedFcids || "";  
	    this.parentEventName = parentEventName || ""; 
	    this.parentEventFcid = parentEventFcid || "";
	    //this.dayStamp = this.startTime.dayStamp();	
	    if(this.startTime) this.dayStamp = this.startTime.dayStamp();
	   // console.log(this.dayStamp);
	}

	save()
	{
		if(this.fcid=="")
		{
			var ref = new Firebase(FcEvent.getFirebaseLocation());
    		var self= this;
  			ref.child('counter').transaction(function(argCounter){return argCounter+1;}, 
      				function(error, isSuccessful, finalVal)
        				{ console.log(error, isSuccessful, finalVal.val());
          						if(isSuccessful)
            						{
              							self.fcid=finalVal.val();
              							var ref2=ref.child(self.fcid);
              							ref2.update(self);
            						}
        				});
		}
	}

	assignNewFcid()
		{ 	var ref = new Firebase(FcEvent.getFirebaseLocation());
    		var self= this;
  			ref.child('counter').transaction(function(argCounter){return argCounter+1;}, 
      				function(error, isSuccessful, finalVal)
        				{ console.log(error, isSuccessful, finalVal.val());
          						if(isSuccessful)
            						{
              							self.fcid=finalVal.val();
            						}
        				});
		}
}

class FcCourseEvent extends FcEvent
{    
	constructor(argCourseEvent)
	{   
		super(argCourseEvent);
		this.buildCourseEvent(argCourseEvent.courseId, argCourseEvent.coach, argCourseEvent.testDate,argCourseEvent.courseEventType);
	}

	buildCourseEvent(courseId, coach, testDate, courseEventType)
	{
		this.courseEventType = courseEventType || "";
		this.courseId = courseId;
		this.coach = coach;
		this.testDate = testDate;
	}
}//End of Class

function generateRealSATEvents(startDate, endDate)
{

}

function generateHolidayEvents(startDate, endDate)
{
	var holidayArray = [{"name": "Daylight Saving Time", "holiday":[2016,3,13], "noBook": false}, 
        {"name": "St. Patrick's Day", "holiday":[2016,3,17], "noBook": false},
        {"name": "Palm Sunday", "holiday":[2016,3,20], "noBook": false}, 
        {"name": "Passover Begins", "holiday": [2016,3,23], "noBook": false},
        {"name": "Purim", "holiday": [2016,3,24], "noBook": false}, 
        {"name": "Good Friday", "holiday": [2016,3,25], "noBook": false},
        {"name": "Easter", "holiday": [2016,3,27], "noBook": true},
        {"name": "Orthodox Good Friday", "holiday": [2016,4,29], "noBook": false},
        {"name": "Last Day of Passover", "holiday": [2016,4,30], "noBook": false}, 
        {"name": "Yom HaShoah", "holiday": [2016,5,4], "noBook": false}, 
        {"name": "Isra and Mi'raj, Cinco Di Mayo", "holiday": [2016,5,5], "noBook": false}, 
        {"name": "MOTHERS DAY!!!", "holiday": [2016,5,8], "noBook": true},
        {"name": "Memorial Day", "holiday": [2016,5,30], "noBook": false},
        {"name": "Ramadan Begins", "holiday": [2016,6,7], "noBook": false},
        {"name": "Father's Day", "holiday": [2016,6,19], "noBook": true},
        {"name": "Independence Day July 4", "holiday": [2016,7,4], "noBook": true},
        {"name": "Labor Day", "holiday": [2016,9,5], "noBook": false},
        {"name": "Rosh Hashana, Muharram", "holiday": [2016,10,3], "noBook": false},
        {"name": "Columbus Day", "holiday": [2016,10,10], "noBook": false},
        {"name": "Yom Kippur", "holiday": [2016,10,12], "noBook": false},
        {"name": "Diwali", "holiday": [2016,10,29], "noBook": false},
        {"name": "Halloween", "holiday": [2016,10,31], "noBook": false},
        {"name": "Veterans Day", "holiday": [2016,11,11], "noBook": false},
        {"name": "Thanksgiving Thursday", "holiday": [2016,11,24], "noBook": true},
        {"name": "Thanksgiving Friday", "holiday": [2016,11,25], "noBook": true}, 
        {"name": "Christmas Eve", "holiday": [2016,12,24], "noBook": true},
        {"name": "Christmas", "holiday": [2016,12,25], "noBook": true},
        {"name": "New Year's Eve", "holiday": [2016,12,31], "noBook": true}];

    var numHolidays = holidayArray.length;
    var eventPushObject = {};
    var ev = {};
  	for(i=0;i<numHolidays;i++){
      	var relHolidays=[];
      	var noBookHolidays=[];
        var startTime = new Date(holidayArray[i].holiday);
        var endTime = new Date(holidayArray[i].holiday);
        endTime.setHours(23);
        endTime.setMinutes(59);
        var holidayTimestamp = startTime.dayStamp();
        holidayArray[i].dayStamp=holidayTimestamp;
        if(holidayTimestamp >= startDate && holidayTimestamp <= endDate && holidayArray[i].noBook)
        {	
        	ev = new FcEvent({name: holidayArray[i].name, 
        							startTime: startTime,
        							endTime: endTime,
        							completed: false,
        							relatedFcids: holidayArray[i].noBook? "*": ""});
        	//eventPushObject[ev.fcid] = ev;  
        	ev.save();      
        }
    }
   
}

class FcCourse
{

	constructor()
	{
		this.scheduleType="",
		this.customCourseType="",
		this.courseType = "";
		this.testDate = "";
		this.startTime="";
		this.endTime= "";
		this.programLength="";
		if(this.startTime!==""){
		this.startAndEndTimes= this.startTime + " to " + this.endTime;}
		this.courseMeetingDays="";
		this.courseDaySets="";
		this.summerMeetingDays="";
		this.presetCourseLength= ""; 
		this.practiceTestDay= "";
		this.presetCoursePattern="";
		this.numberOfMeetings="";
		this.numberOfPracticeTests="";
		this.courseLocation=""; 
		this.coach="";
		this.associatedCoaches="";
		this.courseSize="";
		this.practiceTestDay = "";
		this.eventArray = [];
		this.practiceTestArray = [];
		this.courseMeetingArray = [];
		this.fcid = "";
		this.currentEnrollment="";
		this.price="";
		this.summer=false;
		this.courseLength="";
		this.courseMeetingLength="";
		this.hoursTotal=""; //FcCourse.getNewFcid();
		this.courseCalendarDaysArray=[];
	}

	


	static getCourseTypes()
	{
		return [{"label": "Would you like to make a custom or standard course schedule?"},
				{"label2":"Schedule Type"},
				["Standard Schedule", "Custom Schedule"]
			];
	}

	static getCourseSubTypes()
		{
		return [ 	{"label": "Standard Course Schedule"},
	  				{"label2":"Course Type"},
					["Focused 1600SAT Course","Focused Study Group"] 
				];
		}
	static getTestDates()
	{	var tResult =[];
		var result = [];
		var allTestDates=[[2016, 5, 7],[2016, 6, 4],[2016, 8, 6],[2016,10,1],[2016,11,5],[2016,12,3],[2017,1,28],[2017,3,11],[2017, 5, 6], [2017, 6, 3],[2017, 8, 26],[2017, 10, 7],[2017,11,4],[2017, 12, 2],[2018,3, 10],[2018, 5, 5], [2018, 6, 2], [2018, 8, 25], [2018, 10, 6],[2018,11,3],[2018,12,1],[2019,3, 9],[2019,5,4],[2019, 6, 1]];
		var numDates = allTestDates.length;
		var now = new Date();
		for(var i = 0; i < numDates; i++)
		{
			var testdate = new Date(allTestDates[i]);
			if(testdate.addDays(-28) >= now) //must be 28 days before test min
			{
				result.push(testdate.toDateString());
			}
		}
		var obj1 = {"label":"2016-2019 SAT Test Dates"};
		var obj2={"label2": "Test Date"};
		tResult.push(obj1);
		tResult.push(obj2);
		tResult.push(result);
		return tResult;	
	}

	

	static getPresetCourseLength()
	{
		return 	[{"label": "Select a Program Length between 3 & 13 weeks"},
				{"label2": "Program Length"},
				["3 Weeks, 21 Days", "4 Weeks, 28 Days", "5 Weeks, 35 Days", "6 Weeks, 42 Days", "7 Weeks, 49 Days", "8 Weeks, 56 Days", "9 Weeks, 63 Days", "10 Weeks, 70 Days", "11 Weeks, 77 Days", "12 Weeks, 84 Days", "13 Weeks, 91 Days"]
			    ];	   
	}

	static getCourseTimes()
	{
		return [
				{"label":"Course Times"},
				{"label2":"Start And End Times"},
				["3:45PM-5:45PM", "6:00PM-9:00PM", "9:00AM-12:30PM", "1:00PM-4:30PM", "5:00PM-8:30PM", "4:00PM-7:30PM"]
				];
	}

	static getPracticeTestDays()
	{
	 	return	[	{"label": "Which Practice Test Day Suits Your Course?"},
		 			{"label2": "Practice Test Day"},
					["Saturday Practice Tests","Sunday Practice Tests"]
				];
	}
	static getCoaches()
	{
		return [{"label": "Primary Course Coach"},
					{"label2": "Coach"},
					["John Gotta",
					"Stacy Collerette",
					"George Rimakis",
					"Scott McKinley",
					"Jason Frazzano",
					"Mustaffa Raza",
					"Radika Patel"],
					];//this should be a profile and be pulled from its own constructors.
	}

	static getCourseEnrollment()
	{
		  		 return [	{"label": "Course Enrollment Limit"},
							{"label2": "Course Size"},
	  						["Mini-Group: 8","Mini-Group: 12","Mini-Group: 16","1600SAT Course: 18","1600SAT Course: 22","1600SAT Course: 25"]
	  					];
	}

	static getCourseMeetingDays()
	{
		return [{"label": "Which Days will your Course Meet on each Week?"},
				{"label2": "Course Meeting Days"},
				["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Select Days on your Calendar"]
				];
	}

	static getCourseDaySets()
	{	return [{"label": "Select the Days and Related Times For Your Course!"},
				{"label2": "Course Day Sets"},
				["Monday & Wednesday (6PM_to_9PM)", "Tuesday & Thursday (6PM_to_9PM)", "Mon|Wed|Fri (Afternoon)"]
			 ];
	}
	static getCourseTimeSets()
	{	return  [{"label": "Course Times During School"},
			  {"label2":"Preset Course Times"},
			  ["6:00PM_9:00PM, for Mon|Wed", "6:00PM_9:00PM, for Tues|Thurs", "3:45PM_5:45PM, for Mon|Wed|Fri"]
			  ];
	}
	static getSummerCourseDaySets()
	{
	return 	[{"label": "Summer Course Schedules!"},
			{"label2": "Summer Course Day Sets"},
		["Summer: Mon & Wed (Morning)", "Summer: Tues & Thurs (Morning)", "Summer: Mon & Wed (Afternoon)", "Summer: Tues & Thurs (Afternoon)", "Summer: Mon, Wed & Fri (Morning)", "Summer: Monday & Wednesday (Evening)", "Summer: Tuesday & Thursday (Evening)"]
];
}
static getSummerCourseSchedules()
{		return[{"label": "Summer Course Schedules!"},
	{"label2": "Summer Meeting Days"},
 	["Summer: 9:00AM_12:30PM M|W", "Summer: 9:00AM_12:30PM Tu|Th", "Summer: 1:00PM_4:30PM M|W", "Summer: 1:00PM_4:30PM Tu|Th", "Summer: 5:30PM_8:30PM M|W", "Summer: 5:30PM_8:30PM T|Th", "Summer: 9:45AM_12:45PM M|W|F"]
 	];

}

static getMoreInputs()
{		return[	FcCourse.getCourseTypes(), FcCourse.getCourseSubTypes(), FcCourse.getTestDates(),FcCourse.getPresetCourseLength(),FcCourse.getPracticeTestDays(), FcCourse.getCourseTimeSets(),FcCourse.getCourseEnrollment(), FcCourse.getCourseMeetingDays(), FcCourse.getSummerCourseSchedules(),FcCourse.getCourseTimes()];
}
static getAllInputsAtOnce()
{			return[	
					[
					 {"label": "Would you like to make a custom or standard course schedule?"},
					{"label2":"Schedule Type"},
					["Standard Schedule", "Custom Schedule"]
					],
					[
					 {"label": "Standard Course Schedule"},
					{"label2":"Course Type"},
						["Focused 1600SAT Course",
						 "Focused Study Group"
						 ] 
					],
					  [
					  {"label": "Will the Course be 3, 4, 5, 6 or 7 weeks long?"},
					 {"label2": "Preset Course Length"},
					 ["3 Weeks, 21 Days", "4 Weeks, 28 Days", "5 Weeks, 35 Days", "6 Weeks, 42 Days", "7 Weeks, 49 Days",]
					 ],
					 [
					 {label: "Which Practice Test Day Suits Your Course?"},
					 {"label2": "Practice Test Day"},
					 ["Saturday Practice Tests","Sunday Practice Tests"]
					 ],
					 [
					 {"label": "Which Course Paterns match your event?"},
					 {"label2": "Preset Course Pattern"},
					 ["Mon|Wed_6:00PM_9:00PM","Tues|Thurs_6:00PM_9:00PM","Mon|Wed|Fri_3:45PM_5:45PM", "M|W|F_Summer_9:00AM_12:30PM","Tues|Thurs_3:45PM_6:00PM", "M|W_Summer_9:00AM_12:30PM","T|Th_Summer_9:00AM_12:30PM","M|W_Summer_1:00PM_4:30PM","T|Th_Summer_1:00PM_4:30PM"
					 ]
					 ],
					 [
					{"label":"Confirm Start Time" },
					{"label2": "Start Time" },
					["9:00AM", "1:00PM", "3:45PM","6:00PM" ]
					],
					[{"label":"Confirm End Time" },
					{"label2":"End Time" },
					["12:30PM", "4:30PM", "5:45PM", "6:00PM", "9:00PM"]
					],
					[		
				 	{"label": "Primary Course Coach"},
					{"label2": "Coach"},
					["John Gotta",
					"Stacy Collerette",
					"George Rimakis",
					"Scott McKinley",
					"Jason Frazzano",
					"Mustaffa Raza",
					"Radika Patel"],
					],
					[
					 {"label": "Custom Course Design"},
					 {"label2": "Custom Course Type"},
					 ["Mini-Goup", "Private", "Elite Course"]
					 ],
				
					 [
					 {"label": "Weeks You Will Prepare Prior Your Test Date"},
					 {"label2": "Course Length"},
					 ["1 Week, 7 Days", "2 Weeks, 14 Days", "3 Weeks, 21 Days", "4 Weeks, 28 Days", "5 Weeks, 35 Days", "6 Weeks, 42 Days", "7 Weeks, 49 Days", "8 Weeks, 56 Days", "9 Weeks, 63 Days", "10 Weeks, 70 Days", "11 Weeks, 77 Days", "12 Weeks, 84 Days", "13 Weeks, 91 Days", "14 Weeks, 98 Days", "15 Weeks, 105 Days", "16 Weeks, 112 Days"]
					 ],
					
					[ {"label": "How Many Days Will you Select?"},
					 {label2: "Course Meeting Days"},
					 ["", "Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]
					]
				];
	}
	

getFirebaseLocation()
	{
		// return ("https://focused0ne.firebaseio.com/courses");
	}

	setCourseLength(argWeeks)
	{
		console.log("setCourseLength " + argWeeks);
		this.courseLength = parseInt(argWeeks);
	}

	setTestDate(argDate)
	{
		console.log("setTestDate " + argDate);
		this.testDate = argDate;
		this.testDateDate = new Date(this.testDate);
		this.eventArray = [];
		this.practiceTestArray = [];
		this.courseMeetingArray = [];
		//this.generateCourseCalendar(argCourseLength);
	}

	generateCourseCalendar(weeks)
	{	var numb = parseInt(weeks);
		var start = new Date(this.testDate.addDays(-7*numb));
		var end = new Date(this.testDate);
		//this.calendarCreator(start, end);
	}

	setPracticeTestDay(argDay)
	{
		if(!this.testDate)
		{
			console.log("ERROR: must set test date before practice test day");
			return;
		}
		console.log(this, argDay);
		this.practiceTestDay = argDay;
		this.practiceTestArray = [];
		var i = 0;
		var numEvents = this.eventArray.length;
		for(i=0;i<numEvents;i++)
		{
			var ev = this.eventArray[i];
			if(ev.courseEventType == "practice test")
			{
				this.eventArray.splice(i, 1);
				i--; numEvents--;
			}
		}
		var currDate = this.testDateDate.addDays((argDay == "Saturday Practice Tests")?(-1 * this.courseLength * 7):(-1 * (this.courseLength * 7 - 1)) );
		for(i=0; i<this.courseLength;i++)
		{
			var ptStart = new Date(currDate);
			ptStart.setHours(9);
			var ptEnd = new Date(currDate);
			ptEnd.setHours(12);
			ptEnd.setMinutes(30);
			var ptEvent = new FcCourseEvent({courseId: this.fcid, startTime:ptStart, endTime: ptEnd, courseEventType: "practice test", testDate:this.testDateDate});
			this.eventArray.push(ptEvent);
			this.practiceTestArray.push(ptEvent);
			currDate = currDate.addDays(7);
		}
		this.numberOfPracticeTests = this.practiceTestArray.length;
		console.log(this.practiceTestArray);
	}


	setCourseMeetingDaysAndTimes(argDaysAndTimes)
	{
		console.log("setCourseMeetingDaysAndTimes " + argDaysAndTimes);
		var parts = argDaysAndTimes.split(",");
		var days = parts[1];
		days = days.toLowerCase();
		days = days.replace("for", "");
		days = days.replace(/\s/g, "");
		days = days.replace("tues", "tuesday");
		days = days.replace("thurs", "thursday");
		days = days.replace("mon", "monday");
		days = days.replace("wed", "wednesday");
		days = days.replace("fri", "friday");
		days = days.replace(/\|/g, "/");
		var times = parts[0];
		times = times.replace("_", "-");
		var start = times.split("-")[0];
		start = start.replace("AM", "");
		var pmIndex = start.indexOf("PM");
		var hour, min;
		if(pmIndex > -1)
		{
			start = start.replace("PM", "");
			hour = parseInt(start.split(":")[0]);
			min = start.split(":")[1];
			start = (hour+12).toString() + ":" + min;
		}
		var end = times.split("-")[1];
		end = end.replace("AM", "");
		pmIndex = end.indexOf("PM");
		if(pmIndex > -1)
		{		
			end = end.replace("PM", "");
			hour = parseInt(end.split(":")[0]);
			min = end.split(":")[1];
			end = (hour+12).toString() + ":" + min;
		}
		times = start + "-" + end;
		console.log(days, times);
		this.setCourseMeetingDays(days);
		this.setCourseMeetingTime(times);
	}

	setCourseMeetingDays(argDays)
	{
		if(!this.testDate || !this.practiceTestDay)
		{
			console.log("ERROR: must set test date and practice test day before meeting days");
			return;
		}
		this.courseMeetingDays = argDays;
		this.courseMeetingArray = [];
		var numEvents = this.eventArray.length;
		for(i=0;i<numEvents;i++)
		{
			var ev = this.eventArray[i];
			if(ev.courseEventType == "course meeting")
			{
				this.eventArray.splice(i, 1);
				i--; numEvents--;
			}
		}
		var currDate = this.testDateDate.addDays((argDays.indexOf("monday/wednesday") > -1)?(-1 * (this.courseLength * 7 - 2)):(argDays == "tuesday/thursday")? (-1 * (this.courseLength * 7 - 3)): 0);
		for(i=0; i<this.courseLength;i++)
		{
			var cmStart = new Date(currDate);
			var cmEnd = new Date(currDate);
			var cmEvent = new FcCourseEvent({courseId: this.fcid, startTime:cmStart, endTime: cmEnd, courseEventType: "course meeting", testDate:this.testDateDate});
			this.eventArray.push(cmEvent);
			this.courseMeetingArray.push(cmEvent);
			var cm2Start = new Date(cmStart.addDays(2));
			var cm2End = new Date(cmEnd.addDays(2));
			var cm2Event = new FcCourseEvent({courseId: this.fcid, startTime: cm2Start, endTime: cm2End, courseEventType: "course meeting", testDate:this.testDateDate});
			this.eventArray.push(cm2Event);
			this.courseMeetingArray.push(cm2Event);
			if(argDays == "monday/wednesday/friday")
			{
				var cm3Start = new Date(cm2Start.addDays(2));
				var cm3End = new Date(cm2End.addDays(2));
				var cm3Event = new FcCourseEvent({courseId: this.fcid, startTime: cm3Start, endTime: cm3End, courseEventType: "course meeting", testDate:this.testDateDate});
				this.eventArray.push(cm3Event);
				this.courseMeetingArray.push(cm3Event);
			}
			currDate = currDate.addDays(7);
		}
		this.numberOfMeetings = this.courseMeetingArray.length;

	}

	setCourseMeetingTime(argTime)
	{
		if(!this.testDate || !this.practiceTestDay || !this.courseMeetingDays)
		{
			console.log("ERROR: must set test date, practice test day, and course meeting days before meeting time");
			return;
		}
		this.courseMeetingTime = argTime;
		var parts = argTime.split("-");
		var start = parts[0];
		var end = parts[1];
		var startparts = start.split(":");
		var starthours = parseInt(startparts[0]);
		var startminutes = parseInt(startparts[1]);
		var endparts = end.split(":");
		var endhours = parseInt(endparts[0]);
		var endminutes = parseInt(endparts[1]);
		var numEvents = this.courseMeetingArray.length;
		var i = 0;
		for(i=0; i < numEvents; i++)
		{
			var ev = this.courseMeetingArray[i];
			// var property = argIsStart?"startTime": "endTime";
			ev.startTime.setHours(starthours);
			ev.startTime.setMinutes(startminutes);
			ev.endTime.setHours(endhours);
			ev.endTime.setMinutes(endminutes);
//			ev[property].setHours(hours);
//			ev[property].setMinutes(minutes);
			//ev[property].setSeconds(seconds);
		}
	}


	setCoach(argCoach)
	{
		this.coach = argCoach;
		var numEvents = this.eventArray.length;
		for(i=0; i < numEvents; i++)
		{
			var ev = this.eventArray[i];
			ev.coach = argCoach;
		}
	}

	save()
	{
		var numEvents = this.eventArray.length;
		var i = 0;
		console.log(this.eventArray);
		if(this.fcid=="")
		{
			var ref = new Firebase(FcCourse.getFirebaseLocation());
    		var self= this;
  			ref.child('counter').transaction(function(argCounter){return argCounter+1;}, 
      				function(error, isSuccessful, finalVal)
        				{ console.log(error, isSuccessful, finalVal.val());
          						if(isSuccessful)
            						{
              							self.fcid=finalVal.val();
              							var ref2=ref.child(self.fcid);
              							ref2.update(self);
            						}
        				});
		}/*
		for(i=0; i < numEvents; i++)
		{
			this.eventArray[i].save();
		}*/
		//var ref = new Firebase(FcCourse.getFirebaseLocation());
		// var courseObj = {};
		// courseObj[this.fcid] = this;
		// console.log(courseObj);
		// ref.update(courseObj);
	}
}
FcCourse.fcidCounter = 0;

window.FCBehaviors = window.FCBehaviors || {};
FCBehaviors.FcCalendarBehaviorPrime = {
	properties: {
		 startDate:{
		 	type: Date,
		 	notify: true
		 },
		 endDate:{
		 	type: Date,
		 	notify: true
		 },
		displayedMonthIndex:{
			type: Number,
			notify: true
		},
		lastMonthIndex:{
			type: Number,
			notify: true

		},
		theDate:{
			type: Date,
			notify: true
		},
		
		monthsArray:{
			type: Array,
			value: [],
			notify: true
		},
		testDateObjects:{



		},
		dayOfWeek: {
			type: String,
			notify: true
		},
		dateArr: {
			type: Array,
			value: function(){ return [];},
			notify: true
		},
		year: {
			type: String,
			notify: true
		},
		day:{
			type: Date,
			notify: true
		},
		dayArray:{
			type: Array,
			value: [],
			notify: true
		},
		days:{
			type: Array,
			value: function()
			{
					return ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
			},
			notify: true
		}, 
		
		month: {
			type: String,
			value:"",
			notify: true
		}, 
		units:{
			type: String,
			value:"months",
			notify: true
		}, 
	
		calendarDaysArray: {
			type: Array,
			value: [],
			notify: true
		}

	},

	attached: function(){
	},

	dayObject: function(date, FcEvent){},

	
	calendarCreator: function(start, end, units)
	{	this.monthsArray=null;
		this.monthsArray=[];
		var currDate;
		if (units!=undefined && units!=null){this.set("units", units);} 
		var startDate=(start!=null)?start:(new Date()).addDays(0);
		var endDate = (end!=null)?end:(new Date()).addDays(120);
		var i=0;
		if(endDate<=startDate)
			{
				var startDateHolder= new Date(startDate);
				startDate={};
				startDate=new Date(endDate);
				endDate={};
				endDate= new Date(startDateHolder);
			}//date crossing condition

		//console.log(startDate);
			while(startDate.getDay() !== 0)//filling beginning week of calendar
			{
				startDate = startDate.addDays(-1);
				//console.log(startDate);
			
			}
			while(endDate.getDay() !== 6)
			{
				endDate = endDate.addDays(+1);

			}
		var finishedFirstMonth=false;
		var testArray =[];
		testArray = FcCourse.getTestDates();
		//console.log(testArray);
		this.set('dateArr', getDates(startDate, endDate));
		var numDays = this.dateArr.length;
		var currentMonth = 0; 
		for (i = 0; i < numDays; i++) 
		{   var calendarDay={};
			currDate=this.dateArr[i];
			calendarDay.date=currDate; 
			calendarDay.index=i;
			calendarDay.background="#008";
			calendarDay.toggleDay=false;
			calendarDay.isSelected=false;
			calendarDay.inMonth=true;
			calendarDay.eventList=this.getTimes();
			calendarDay.dateId=currDate.dayStamp();
			calendarDay.showDate=currDate.toDateString();
			calendarDay.dayOfMonth=currDate.getDate();
			if(testArray[2].indexOf(calendarDay.showDate)>-1)
			{
				calendarDay.testDate=true; 
			}
			else{
				calendarDay.testDate=false;
			}

			this.push("calendarDaysArray", calendarDay);
			if(i==0)
			{	
				this.push("monthsArray", []);
				this.monthsArray[currentMonth].push(calendarDay);
				this.set("month", currDate.getFullMonth());
			}
			else if(i>0)
			{
				var yesterday = this.dateArr[i-1];
				var dateYester = yesterday.toDateString();
				var dateToday = calendarDay.showDate;
				if(currDate.getFullMonth() != yesterday.getFullMonth() && this.units=="months")
				{	
					if(currentMonth==0 && finishedFirstMonth==false)
						{
							finishedFirstMonth =true;
							this.monthsArray[currentMonth].push(calendarDay);
						}
					else{
					currentMonth++;
					this.monthsArray[currentMonth]=[];
					this.monthsArray[currentMonth].push(calendarDay)
					}
				}
				else {
					//console.log(i, currentMonth,this.monthsArray);
					this.monthsArray[currentMonth].push(calendarDay);
					// console.log(this.calendarDay);
				}
			// console.log(this.displayedMonth);
			}
		}
			var monthIndex=0;
		if(this.units==="months")
		{
		this.padMonths();
		}
		var today = new Date();
		var todMonth = today.getMonth();
		var todYear = today.getFullYear();
		//console.log(this.monthsArray[0][8]);
		
			if (todYear==this.monthsArray[0][15].date.getFullYear())
				{//console.log(this.monthsArray);
					var counter =this.monthsArray.length-1;
				for(i=0;i<counter; i++)
					{
					if(todMonth==this.monthsArray[i][15].date.getFullMonth())
					{
						this.set("displayedMonth", this.monthsArray[i]);
						this.set("displayedMonthIndex",i);
					}
				}
			}
		
			else {alert(todYear);}
			//console.log("jkhjhjhh, ghghg hg ,jhuyu iuyt iugh uighu m")};
		var lastMonthIndex=this.monthsArray.length-1;
		this.set("lastMonthIndex", lastMonthIndex);
	},//end of function

	padMonths: function()
	{	var month=[];
		var i = 1;
		var numMonths = this.monthsArray.length;
		for(i=1; i < numMonths-1; i++)
		{
			month = this.monthsArray[i];
			//console.log(month);
			var lastMonth = this.monthsArray[i-1];
			var numDaysPrevMonth = this.monthsArray[i-1].length;
			var fillerDay = numDaysPrevMonth - 1;

			while (month[0].date.getDay() != 0 && this.units=="months")
			{	
				var fill = this.monthsArray[i-1][fillerDay--];
				var filler = this.calendarDayConstructor(fill.date)
			 	month.unshift(filler);
			 }
			 
		}
		var count =numMonths-1;
		for(i=0;i < count; i++)
		{
			month = this.monthsArray[i];
			var lastDay=month[month.length-1];
			 var firstDay=0;

			 var d = lastDay.date;
			 d = new Date(d);
			while(d.getDay()!=6 & this.units=="months")
			{	
				d=new Date(d).addDays(+1);
				
				lastDay = this.calendarDayConstructor(d);
				lastDay.inMonth=false;
				month.push(lastDay);
			
			}
		}
		var lastMonth=this.monthsArray.length-1;
		
		
	},
 
 calendarDayConstructor: function(currDate)
 	{	var calendarDay={};
 		
 		calendarDay={
			"date":currDate, 
			"eventList":this.getTimes(),
			"dateId":currDate.dayStamp(),
			showDate:currDate.toDateString(),
			"dayOfMonth":currDate.getDate(),
			"inMonth": false,
			"isSelected":false,
			"toggleDay": false

		};
		return calendarDay;
	},

	_backOneMonth:function()
	{
		if(this.displayedMonthIndex==0){
			var counter =this.monthsArray.length-1;
			this.set("displayedMonth", this.monthsArray[counter]);
			this.displayedMonthIndex=counter;
		}
		else{
			var diLess=this.displayedMonthIndex-1;
			this.set("displayedMonth", this.monthsArray[diLess]);
			this.displayedMonthIndex--;
		}
		
		var month = this.displayedMonth[8].getFullMonth();
			var year = this.displayedMonth[8].getFullYear();
			this.set("month",month);
			this.set("year", year);
	},

	_forwardOneMonth:function()
	{
	
		if(this.displayedMonthIndex==this.monthsArray.length-1)
		{
			this.set("displayedMonth",this.monthsArray[0]);
			this.displayedMonthIndex=0;						
		}
		else{
			var diMore=this.displayedMonthIndex+1;
			this.set("displayedMonth", this.monthsArray[diMore]);
			this.displayedMonthIndex=diMore;	
		}
	
		var length=this.displayedMonth.length-2;
		var month = this.displayedMonth[7].date.getFullMonth();
		var year = this.displayedMonth[7].date.getFullYear();
			this.set("month",month);
			this.set("year", year);
	},

	_computeTheMonths: function(year, month, monthsArray, displayedMonthIndex, displayedMonth)
	{
		var mon=(displayedMonth==undefined || displayedMonth==[])? month:displayedMonth[displayedMonthIndex].toString().substring(4,7);
		var returnVal =(mon=="Feb")?"February": (mon=="Mar")?"March":(mon=="Apr")?"April": (mon=="May")?"May":(mon=="Jun")?"June":(mon=="Jul")?"July":(mon=="Aug")?"August":(mon=="Sep")?"September":(mon=="Oct")?"October": (mon=="Nov")?"November":(mon=="Dec")?"December":"January";  
		
		return returnVal;
	},

 getTimes: function()
	{	var slotsArr = [];
		var timeArr = [];
        for(var i=24; i<=84;i++)
        {
              var hour=(Math.floor(i/4) <13)?Math.floor(i/4):(Math.floor(i/4)-12);
              if(hour<10){hour='0'+hour.toString();}
              var minutes=(i%4==0)?"00":(i%4==1)?"15":(i%4==2)?"30":"45";
              var ampm=(i<48)?"AM":"PM";
              var tobj = {"hour": hour,
                          "minutes": minutes,
                          "ampm": ampm, 
                        };
              var string=hour.toString() + ":" + minutes+ ampm;
              timeArr.push({"time": string, "activity": "", "coach":"", "location": "", "startTime":"", "endTime": "", "fcid": ""});
          }
 	var obj1={"label": "Scheduled Appointment Times"};
 	var obj2={"label2": "activity.valueTOBEADDED"};
 	slotsArr.push(obj1);
 	slotsArr.push(obj2);
 	slotsArr.push(timeArr);
          return(slotsArr);
    }



};



/*
function fcCreateBaseLineEvents(startDate,stopDate){
     var daysArray = [];
	 daysArray=getDates(startDate,stopDate);
	 var counter =argDays.length;
	 var eventDaysArrayII=[];
		for(var i=0;i<counter;i++)
		{
			var aDay= this.holidayEvents(argDays[i]);
		 	var aDay2 =	this.satTestCourseEvents(aDay);
		 	daysArray.push(aDay2);
		}
	}

 {"label": "Custom Course Design"},
					 {"label2": "Custom Course Type"},
					 ["Mini-Goup", "Private", "Elite Course"]
					 ],
					  // testDates,
					 [
					 {"label": "Weeks You Will Prepare Prior Your Test Date"},
					 {"label2": "Course Length"},
					 ["1 Week, 7 Days", "2 Weeks, 14 Days", "3 Weeks, 21 Days", "4 Weeks, 28 Days", "5 Weeks, 35 Days", "6 Weeks, 42 Days", "7 Weeks, 49 Days", "8 Weeks, 56 Days", "9 Weeks, 63 Days", "10 Weeks, 70 Days", "11 Weeks, 77 Days", "12 Weeks, 84 Days", "13 Weeks, 91 Days", "14 Weeks, 98 Days", "15 Weeks, 105 Days", "16 Weeks, 112 Days"]
					 ],
					
					[ {"label": "How Many Days Will you Select?"},
					 {label2: "Course Meeting Days"},
					 ["", "Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]
					],
					
					this.timeSlotsArr, 
					[
					{"label": "Primary Course Coach"},
					{"label2": "Coach"},
					["John Gotta",
					"Stacy Collerette",
					"George Rimakis",
					"Scott McKinley",
					"Jason Frazzano",
					"Mustaffa Raza",
					"Radika Patel"],
					],


function holidayEvents(startDate,endDate){
      var holidayArray = [];
      holidayArray = [{"name": "Daylight Saving Time", "holiday":[2016,3,13], "noBook": false}, 
        {"name": "St. Patrick's Day", "holiday":[2016,3,17], "noBook": false},
        {"name": "Palm Sunday", "holiday":[2016,3,20], "noBook": false}, 
        {"name": "Passover Begins", "holiday": [2016,3,23], "noBook": false},
        {"name": "Purim", "holiday": [2016,3,24], "noBook": false}, 
        {"name": "Good Friday", "holiday": [2016,3,25], "noBook": false},
        {"name": "Easter", "holiday": [2016,3,27], "noBook": true},
        {"name": "Orthodox Good Friday", "holiday": [2016,4,29], "noBook": false},
        {"name": "Last Day of Passover", "holiday": [2016,4,30], "noBook": false}, 
        {"name": "Yom HaShoah", "holiday": [2016,5,4], "noBook": false}, 
        {"name": "Isra and Mi'raj, Cinco Di Mayo", "holiday": [2016,5,5], "noBook": false}, 
        {"name": "MOTHERS DAY!!!", "holiday": [2016,5,8], "noBook": true},
        {"name": "Memorial Day", "holiday": [2016,5,30], "noBook": false},
        {"name": "Ramadan Begins", "holiday": [2016,6,7], "noBook": false},
        {"name": "Father's Day", "holiday": [2016,6,19], "noBook": true},
        {"name": "Independence Day July 4", "holiday": [2016,7,4], "noBook": true},
        {"name": "Labor Day", "holiday": [2016,9,5], "noBook": false},
        {"name": "Rosh Hashana, Muharram", "holiday": [2016,10,3], "noBook": false},
        {"name": "Columbus Day", "holiday": [2016,10,10], "noBook": false},
        {"name": "Yom Kippur", "holiday": [2016,10,12], "noBook": false},
        {"name": "Diwali", "holiday": [2016,10,29], "noBook": false},
        {"name": "Halloween", "holiday": [2016,10,31], "noBook": false},
        {"name": "Veterans Day", "holiday": [2016,11,11], "noBook": false},
        {"name": "Thanksgiving Thursday", "holiday": [2016,11,24], "noBook": true},
        {"name": "Thanksgiving Friday", "holiday": [2016,11,25], "noBook": true}, 
        {"name": "Christmas Eve", "holiday": [2016,12,24], "noBook": true},
        {"name": "Christmas", "holiday": [2016,12,25], "noBook": true},
        {"name": "New Year's Eve", "holiday": [2016,12,31], "noBook": true}
        ];
  		
      var counter = holidayArray.length;
      for(i=0;i<counter;i++){
      	var relHolidays=[];
      	var noBookHolidays=[];
        var holiday = new Date(holidayArray[i].holiday);
        var holidaynumb = holiday.dayStamp();
        holidayArray[i].dayStamp=holidaynumb;
        if(holidaynum>=startDate && holidaynum<=endDate)
        {	
        	relHolidays.push(holidayArray[i]);
        	if(holidayArray[i].noBook==true)
        	{	holidayArray[i].alert="Alert No Booking!!";
        		noBookHolidays.push(holidayArray[i]);
        	}
        }
        var pushObj={
        	"holidays":relHolidays,
        	"alerts": noBookHolidays,
        }
      }
      return pushObj;
    }
*/

/*
FcCourseBuilder.prototype.FcCourseCalendar=function(testDate)
{
	this.testDate = testDate || nextReasonableTestDate();	
	var startDate = new Date(testDate);
	this.startDate = startDate.setDate(startDate.getDate() - 49);
	var calendarDaysArray=[];
	var self=this;
	console.log(this.startDate, this.testDate);
	calendarDaysArray=	getDates(startDate, testDate);
	var fcCourseCalendarObject={};
	var counter =calendarDaysArray.length;
	var i=0;
	var day=i+1;
	var number =counter;
	this.fcCourseDayArray=[];
	var endNum=counter-1;

	for(i=0;i<counter; i++)
	{ 	
		var numbDate = dates.dayStamp = new Date(calendarDaysArray[i].dayStamp());
		calendarDayObject={
				date:calendarDaysArray[i],
				startDate:self.startDate,
				testDate: testDate,
				daysdayStamp: numbDate,
				endDate:"",
				courseStartTime: "",
				courseEndTime: "",
				courseDaysOfWeek:"",
				practiceTestDayOfWeek: "",
				practiceTestStartTime: "",
				practiceTestEndTime: "",
				courseWorkDaySyllabus:"",
				fcEventList:[],
				fcCourseEventList: [],
				fcCourseMeetingDayList:[],
				fcPracticeTestDayList:[],
				fcToTestCountDown:number,
				fcCourseDay: day,
				fcid:"",
				coach:"",
				coachID:"",
				calendarUserFcid:"", 
				studentFcids:[],
				creatorFcis:"",
				relatedFcids:[]
			};

		this.fcCourseDayArray.push(calendarDayObject);
		var startdayStamp=this.fcCourseDayArray[0];
		var enddayStamp=this.fcCourseDayArray[endNum];
 			number--;
		}
		var startdayStamp=this.fcCourseDayArray[0];
	var enddayStamp=this.fcCourseDayArray[endNum];
	var holidayObjArrays ={};
	holidayOnjArrays= setHolidays(startdayStamp,enddayStamp);
		
		return this.fcCourseDayArray;
}


var fcCourseBuilder =function(argObjectBuilder)
{	
	this.courseCalendar = this.FcCourseCalendar(testDate);
	this.practiceTestMeetingsObject=this.practiceTestDays(argSetPracticeTestDays);
	this.courseMeetingsObject =this.FcCourseMeetingDays(argMeetingDaysObject);


}
fcCourseBuilder.prototype.constructor=FcCourseBuilder;

fcCourseBuilder.prototype.practiceTestDays=function(testDate, isPracticeTestSaturday)
	{	
		var practiceTestObjec={};
		if(isPracticeTestSaturday)
			{ 
				for(i=0; i<7;i++)
				{
					var dayStamp=sunday.dayStamp();
					var ptestArray=[];				
					var saturday = testDate.setDate(testDate.getDate() - (49-(7*i)-7));
						practiceTestObject={
							startTime: "9:00AM",
							endTime: "12:30PM",
							practiceTestDayOfWeek: "Saturday",
							date: saturday,
							dayStamp: saturday
						};
					ptestArray.push[saturday];	
				}

			}
		else {
			for(i=0; i<7;i++)
				{
					var ptestArray=[];				
					var sunday = testDate.setDate(testDate.getDate() - (49-(7*i)-6));
						var dayStamp=sunday.dayStamp();
						practiceTestObject={
							startTime: "9:00AM",
							endTime: "12:30PM",
							practiceTestDayOfWeek: "Sunday",
							date: sunday,
							dayStamp: dayStamp
						};
					ptestArray.push[sunday];
		}
		this.FcCoursePracticeTestObjectArray =ptestObject; 
	}
}


FcCourseBuilder.prototype.FcCourseMeetingDays = function(testDate, isMonWedCourse, isTueThuCourse, isMonWedFriCourse, isOtherDaySchedule, otherDayScheduleArray, numberOfWeeks)
	{	var reverseCourseMeetingsArray=[];
	  this.courseMeetingArrays=[];
		this.otherDayScheduleArray=otherDayScheduleArray || [];
	 	var courseMeetingArray=[];
	 	var courseWeekDaysArray=(isMonWedCourse==true)?[3,5]: (isTueThuCourse==true)?[2,4]:(isMonWedFriCourse)?[1,3,5]:otherDayScheduleArray;
	 	var dayBlocks=["M|W|F","Tu|Th", "M|W"];
	 	var shortLabel = (isMonWedCourse==true)?dayBlocks[2]: (isTueThuCourse==true)?dayBlocks[1]:(isMonWedFriCourse)?dayBlocks[0]:(isOtherDaySchedule==true)?shortDaysLabel([otherDayScheduleArray], 2):"";// see functions shortDayLabel /shortDaysLabel below for solution
	 	this.shortLabelA=shortLabel;
	 	var mdl;
		if(isMonWedCourse==true)
			{
				mdl=shortDaysLabel(["Monday", "Wednesday"], 3);
			}
		else if(isTueThuCourse==true)
		{
			mdl =shortDaysLabel(["Tuesday", "Thursday"], 3);
		}
		else if(isMonWedFriCourse)
		{
			mdl=shortDaysLabel(["Monday", "Wednesday", "Friday"], 3);
		}
		else if(isOtherDaySchedule==true)
			{
			mdl=shortDaysLabel([otherDayScheduleArray], 3);
			}
		else {mdl= "Mon, Wed"};
		(isTueThuCourse==true)?shortDaysLabel(["Tuesday", "Thursday"], 3):(isMonWedFriCourse)?shortDaysLabel(["Monday", "Wednesday", "Friday"], 3):(isOtherDaySchedule==true)?shortDaysLabel([otherDayScheduleArray], 3): "";
	 	var medLabelA = "Course schedule for the " + mdl; 
	 	var medLabelB = "Focused 1600SAT Course, leading up to the " + testDate.toDateString() + " SAT."
	 	this.mediumLabelA=medLabelA;
	 	this.mediumLabelB=medLabelB;
	 	var longDays = (isMonWedCourse==true)?"Monday, Wednesday":(isTueThuCourse==true)?"Tuesday,Thursday":(isMonWedFriCourse)?"Monday, Wednesday, Friday":otherDayScheduleArray.toString();
	 	this.longLabelA = "Class Schedule for the " + longDays; 
	 	this.longLabelB = "Focused 1600SAT Course: this course is designed to prepare students for the SAT scheduled on " + testDate + "."
	 	var counter = courseWeekDaysArray.length;	
	 	var j = 0;
		var singleCourseMeetingsArray =[];
		
		for (j = 0; j < numberOfWeeks; j++) 
		{
				for(var i=0;i<counter;i++)
				{ 	var courseMeetingDay =new Date(testDate);
					var dates={};
					var numb = courseWeekDaysArray[i];
					console.log(numb);
					var less = (j*7)+numb;
					console.log(less);
					console.log(courseMeetingDay);
					courseMeetingDay.setDate(courseMeetingDay.getDate() - less);
				var cmd=courseMeetingDay;	
				 	dates.dayStamp = new Date(courseMeetingDay.dayStamp());
					dates.prettyDate = cmd.toDateString();
					dates.localeDate = cmd.toLocaleString();
					dates.date =courseMeetingDay;
					dates.startTime="";
					dates.endTime="";
					dates.shortLabelA = this.shortLabelA;
					dates.shortLabelB = this.shortLabelB;
					dates.mediumLabelA = this.mediumLabelA;
					dates.mediumLabelB = this.mediumLabelB;
					dates.longLabelA = this.longLabelA;
					dates.longLabelB = this.longLabelB;
					dates.hasDays=true;
					reverseCourseMeetingsArray.push(dates);
		 		// dates={};
		 console.log(reverseCourseMeetingsArray);
				}	
		}
		this.courseMeetingsArray=reverseCourseMeetingsArray.reverse();
		console.log(this.courseMeetingArray);
		this.hasDays=true;
	return this;
	}

FcCourseMeetingDays.prototype.fcCourseMeetingTimes=function(isSixToNineCourse, isAfternoonCourse, is900AmCourse, is100PMCourse, isOtherTimeCourse, otherStartTime, otherEndTime)
	{   fcCourseMeetingDays.call(this);
		if(this.hasDays)
			{	var time={};
			var	sixToNine={}; 
				sixToNine.startTime= "6:00PM";
				sixToNine.startNumHrsArray=[18,0,0];
				sixToNine.endTime="9:00PM";
				sixToNine.endNumHrsArray=[21,0,0];
				sixToNine.short="_6_9PM_SAT"
				sixToNine.full=sixToNine.startTime + "-" +sixToNine.endTime;				
			var	afternoon={};
			afternoon.full = "3:45PM-5:45PM";
			afternoon.startTime="3:45PM";
			afternoon.short="_345_545PM_SAT"
			afternoon.endTime="5:45PM";
			afternoon.startNumHrsArray=[15,45,0];
			afternoon.endNumHrsArray=[17,45,0];
			var	nineAm = {};
			nineAm.startTime="9:00AM";
			nineAm.endTime="12:30PM";
			nineAm.short="9AM_1230PM";
			nineAm.full=nineAm.startTime + "-"+nineAm.endTime;
			nineAm.startNumHrsArray=[9,0,0];
			nineAm.endNumHrsArray=[12,30,0];
			var	onePM = {};
			onePM.full="1:00PM-4:30PM";
			onePM.startTime="1:00PM";
			onePM.endTime="4:30PM";
			onePM.short="_1_430PM_SAT";
			onePM.startNumHrsArray=[13,0,0];
			onePM.endNumHrsArray=[17,30,0];

			time=(isSixToNineCourse==true)?sixToNine: (isAfternoonCourse==true)?afternoon:(is900AmCourse)?NineAm:(is100PMCourse==true)?onePM: otherStartTime;
			time.classType="_1600SAT";

			var numberTime = this.courseMeetingsArray[0].dayStamp;
			var startNumberTime = new Date(item.dayStamp).setHours(18,0,0);

			var courseObj={};
			var cmt=[];
			this.courseMeetingsArray.forEach(function(item, index, array)
			{	time.snt = new Date(item.numberTime).setHours(time.startNumHrsArray);
				time.ent = new Date(item.numberTime).setHours(time.endNumHrsArray);
				courseObj={
					"dayStamp":item.dayStamp,
					"prettyDate":item.prettyDate,
					"localeDate":item.localeDate,
					"date":item.date,
					"startTime":item.startTime,
					"endTime":item.endTime,
					"shortLabel":item.shortLabelA + time.short+ item.shortLabelB,
					"mediumLabel": item.mediumLabelA + time.full + item.mediumLabelB,					
					"longLabel":item.longLabelA + time.full + item.longLabelB,
					"hasDays":item.hasDays,
					"startTime":time.startTime,
					"endTime":time.endTime,
					"short":time.short,
					"full":time.full,
					"startNumberTime": time.snt, 
					"endNumberTime": time.ent, 
					"FcidAB": item.dayStamp + "_" + time.snt +"_",
				};
				cmt.push(courseObj);
				console.log(time.snt);
				console.log(time.ent);
				courseObj={};
			});

			this.courseBuilderData=[];
			this.courseBuilderData=cmt;
			console.log(cmt);
			return this.CourseBuilderData;
			}

		}




class FcCourse2
{
	constructor(argCourse)
	 {
	 	this.buildCourse( argCourse.hasExtraCoach, argCourse.extraCoach, fcid);
	 }
	 buildCourse(testDate, isMonWedCourse, isTueThuCourse, isMonWedFriCourse, isOtherDaySchedule, otherDayScheduleArray, isSixToNineCourse, isAfternoonCourse, is900AmCourse, is100PMCourse, isOtherSchedule, hasSaturdayTests, hasSundayTests, hasExtraCoach, extraCoach, fcid)
	 {
	 	// this.otherDayScheduleArray=otherDayScheduleArray || [];
	 	// var courseMeetingArray=[];
	 	// courseMeetingArray=(isMonWedCourse==true)?[5,3]: (isTueThuCourse==true)?[4,2]:(isMonWedFriCourse?[5,3,1]:[];

	 	// this.courseMeetings= 
	 }
}
*/
function nextReasonableTestDate()
	{
		var d=new Date();
		d.setDate(d.getDate(d +49));
		var allTestDates=[];
		allTestDates=[[2016, 5, 7],[2016, 6, 4],[2016, 8, 6],[2016,10,1],[2016,11,5],[2016,12,3],[2017,1,28],[2017,3,11],[2017, 5, 6], [2017, 6, 3],[2017, 8, 26],[2017, 10, 7],[2017,11,4],[2017, 12, 2],[2018,3, 10],[2018, 5, 5], [2018, 6, 2], [2018, 8, 25], [2018, 10, 6],[2018,11,3],[2018,12,1],[2019,3, 9],[2019,5,4],[2019, 6, 1]];
		var counter = allTestDates.length;
		var i = 0;
		for (i = 0; i < counter; i++)
		{
			var testDay = new Date(allTestDates[i]);
			//console.log(d.toLocaleString, testDate.toLocaleString);
			if(d<testDay){return testDay;}
		}
	
	}

function TimeSlots(){
				var timeArr = [];
        		for(var i=18; i<=42;i++){
              var hour=(Math.floor(i/2) <13)?Math.floor(i/2):(Math.floor(i/2)-12);
              var j=false;
              j=(i>47)?true:false;
              if(hour<10){hour='0'+hour.toString();}
              var space=(i<20)?true: false;
              var halfhour=(i%2==0)?0:3;
              var ampm=(i<24)?"am":(j==true)?"am":"pm";
              var tobj = {"hour": hour,
                          "halfhour": halfhour,
                          "ampm": ampm, 
                          "space": space
                        };
              var string=hour.toString() + ":" + halfhour.toString() + "0"+ ampm;
              var obj2={"label": string, "val": "open", "name": string};
              timeArr.push(obj2);
          }
          return timeArr;
         }


  


	
function shortDayLabel(argDay, numChars)
{	
	var fullDaysArray=["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]; 
	var shortDaysArray = ["Su","M","Tu","W","Th","F","Sa"];
	var singlesArray = ["M", "W", "F"];
	var dayBlocks=["M|W|F","Tu|Th", "M|W"];
 	var md = argDay
	if(numChars>2)
	{
	md=md.slice(0,numChars);
	return md;
	}
	else
	{
		var letters = md.slice(0,2);
		var lilLetters=md.slice(0,1);
		if(shortDaysArray.indexOf(letters)!==-1)
			{
				var letterIndex = singlesArray.indexOf(lilLetters);
				return singlesArray[letterIndex];
			}
		else {var retVal= shortDaysArray.indexOf(letters);
			//console.log(shortDaysArray[retVal]);
				return shortDaysArray[retVal];
			}
	}
}
function shortDaysLabel(argDays, NumChars)
{
	var counter =argDays.length;
	for(var i=0;i<counter; i++)
	{
		var shortdaylabeltopush = shortDayLabel(argDays[i]);
		var label=(i==counter-1)?shortdaylabeltopush:shortdaylabeltopush + "|";
		label+=label; 

	}
	return label;

}

</script>
	
