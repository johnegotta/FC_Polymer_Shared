<dom-module id="fc-passage-holder">
<template>
<style>
:host {
	padding-left: 12px;
	margin-left: 6px;
	position: relative;
	top: 0px;
	font-size: 16pt;
	bottom: 0px;
	height: 99vh;
	right: 0px;
	left: 0px;
	display: flex;
	min-width: 96%;
	max-width: 99vw;
    }
    div.line-number {
	width: 28px;
	height: 20px;
	line-height: 1.2;
	font-size: 16pt;
	/*font-size: 1.25em;*/
	font-family: merriweather;
	font-weight: 500;
	font-style: italic;
	padding: 2px 4px;
	margin: 2px;


    }

    paper-textarea, paper-input{
    	padding: 12px;

    }
    .blurb-class{
    	max-width: 670px; 
    	padding: 4px 0px 4px 8px; 
    	font-size: 12pt; 
    	line-height: 1.05;
    	font-style: oblique;

    }

    .highlighted {
	background: yellow;
    }

    div.text {
	line-height: 1.2;
	font-size: 16pt;
     /* font-size: 1.25em;*/
	font-family: merriweather;
	font-weight: 500;
	padding: 2px 0px 8px 4px;
	margin: opx 0px 6px 0px;
	min-height: 900px !important;
	display: flex;
	min-width: 300px !important;
	max-width: 660px !important;
    }


    #firepad {min-width: 330px; height: 450px; border: 6px ridge silver; max-width: 480px;}
</style>            

    <paper-header-panel class="vertical layout flex wrap text" mode="waterfall" style="margin: 12px; padding: 12px 36px 12px 36px; border: 3px ridge silver;">
		<div 
			class="paper-header inline horizontal layout flex" 
			id="headerPanel" 
			style="margin-bottom: 12px; max-height: 75px; border-bottom: 1px solid #efefef;"
			> 
			
			<array-selector 
				id="selector" 
				items="{{passagesWordArrays}}" 
				selected="{{selected}}" 
				multi 
				toggle>
			</array-selector>

	    	<fc-dropdown-menu 
		  		style="min-width: 360px;" 
		  		on-select="toggleSelection" 
		  		id="passagesList" 
		  		data-source="{{passagesWordArrays}}" 
		  		selected="{{selected}}"
		  		>
		  	</fc-dropdown-menu>
	
			
		
					<section class="circle"></section>
		</div>
		<div class="horizontal layout flex">
	    	<div class="layout vertical flex-3" >
	     		<section 
	     			class="blurb-class"
	     			>
	     			[[selected.0.passageBlurb]]
	     		</section>

		<div class="layout horizontal flex nowrap container" style="min-height: 5000px; padding: 2px 0px 6px 8px;">
		<div id="lineNumbers" class="layout vertical line-number">
		  <div class="line-numbers" id="linesA1">Lines</div>
		    <template is="dom-repeat" items="{{lineNumberArray}}" filter="{{_numberFilter(lineNumbers)}}">
			  <span hidden="{{!item.show}}" id$="LN{{item.number}}">{{item.number}}</span>
			  <span hidden="{{item.show}}">&nbsp</span>
		    </template> 
		  </div>
			  <!--passage-1-column-1 container-->
	    <div id="firstColumn" class="layout horizontal flex wrap text">
		<article id="textColumnOne" style="margin: 2px 2px 2px 2px; padding: 0ps 3px 0px 8px; max-width: 600px;">
	
		  <template is="dom-repeat" items="{{selected}}" id="aDarnedTemplate" filter="">
			<template is="dom-if" if="{{item.newPara}}">
			  <br><span>&nbsp&nbsp&nbsp&nbsp</span>
			</template>
			<a id$="A[[item.wordIndex]]" hidden$="{{item.is_transitionWord}}">{{item.word}}</a>
		     <a id$="A[[item.wordIndex]]_transition" style="" hidden$="{{!item.is_transitionWord}}" >{{item.word}}</a>
		  
		  </template>
		  <br class="line-numbers">
		  <hr>
		  <div id="focusedMark" class="right-justified line-numbers" style="float:right; text-align: right;" id="singleColumnBounder"> Focused Coaching (c) 2016</div>
		</article>
		<code id="code" style="opacity: 0;">[[passageOneWordArray.0.passageType]]</code>
	    </div>
	    
	    </div>

	  </div>
	  	 
	  
	               
    </paper-header-panel>			 
</template>
<script>
'use strict';

    (
	function() {
	class fcPassageHolder {
	   get behaviors() { 
	    return [
		  Polymer.IronResizableBehavior, 
		  FCBehaviors.FCFirepadBehavior, 
		  FCBehaviors.PassageDataBehavior
		  ];
	   }
	   beforeRegister() {

		this.is = 'fc-passage-holder';
	    this.properties = {
	  
	    estimatedHeight: {
		type: Number,
		value: function(){
		  var estimatedHeight=Math.ceil(screen.height*.895);
		 return estimatedHeight;
		},
		notify: true,
		reflectToAttribute: true 
	    }, 
	    passagesWordArrays:{
		type: Array,
		value: function(){return []},
		notify: true
	    },
	    lineNumberArray: {
		  type: Array,
		  computed: '_computeLineNumberArray(passageOneWordArray)',
		  notify: true
		  },
		  isFirePad: {
		  	type: Boolean,
		  	value: function(){
		  		return true;

		  	},
		  	notify: true
		  },
	  
	   
	    firstRowIndex: {
		type: Number,
		value: 1,
		notify: true
	    },
	    hasCharts:{
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true

	    },
	    inputHasCharts: {
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true
	    },
	    passageType: {
	    	type: String,
	    	value: function(){
	    		return "";
	    	},
	    	notify: true
	    	},
	    lastRowIndex:{
			type: Number,
			value: 1,
			notify: true,
			reflectToAttribute: true
	    },
	    passagesTestOne: {
		  type: Array,
		  value: function(){
		 	return [];
		},
		notify: true
	    },
	
		myValue: {
		  type: String,
		  notify: true
		},
		currentWidth:{
		  type: Number, 
		  value: function(){
		    return 380;
		  },
		  notify: true
		},


		inputPassageTitle:{
			type: String,
			value: function(){
		    return "";},
			notify: true
		},
		inputPassageType:{
			type: String,
			value: function(){
		    	return "";
		    },
			notify: true
		},
	    inputPassageBlurb:{
	    	type: String,
			value: function(){
		    	return "";
		    },
			notify: true
	    },
	    inputTestId:{
			type: String,
			value: function(){
		    	return "";
		    },
			notify: true
	    },
	    testId:{
	    	type: String,
	    	value: function(){
		    	return "";
			},
			notify: true
		},
	    inputFcid_test:{
			type: String,
			value: function(){
		    	return "";
		    },
			notify: true
	    },
	    fcid_test: {
	    	type: String,
			value: function(){
		    	return "";
		    },
			notify: true
	    },
	    inputTestSource:{
			type: String,
			value: function(){
		    	return "";
		    },
			notify: true
	    },
	    inputIsDoublePassage: {
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true
	    },
	    isDoublePassage: {
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true

	    },
	    inputIsCollegeBoard: {
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true
	    },
	    isCollegeBoard: {
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true
	    },
	    inputIsFocused: {
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true
	    },
	    isFocused: {
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true
	    },

	    inputIsDoublePassage: {
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true
	    },
	    isDoublePassage: {
	    	type: Boolean,
	    	value: function(){return false;},
	    	notify: true
	    },
		currentHeight:{
		  type: Number,
		  value: function(){
		    return 920;
		  },
		  notify: true
		}, 
		currentZ:{
		  type: Number,
		  value: function(){
		    return 1;
		  },
		  notify: true
		},
	    yourName: {
		  	value: function(){
		    	return "";
			},
			notify: true
		},
	
	    passageTitle: {
			value: function(){
		    return "";},
			notify: true
	    },
	    passageBlurb:{
			value: function(){
		    return "";},
			notify: true
		},
	    testSource: {
			value: function(){
		    return "";},
			notify: true
		},
	    transitionArray: {
			type: Array,
			value: [],
			notify: true
	    },
	    paragraphArray: {
			type: Array,
			value: [],
			notify: true
	    },

	    truePassageArray:{
			type: Array,
			value: [],
			notify: true
	    },
	    passageWordArrayOrdered:{
			type:Array,
			value: [],
			notify: true
	    },
	    passageArray:{
		type:Array,
		value: [],
		notify: true
	    }, 
	   
	    orderIndex: {
		type: Number, 
		value: 0,
		notify: true
	    },
	    columnOne: {
		type: Boolean,
		value: false,
		notify: true,
		reflectToAttribute: true
	    },

	minTarra: {        
	  type: Array,
	  value: function(){
	    return  [];
	    },
	  notify: true,
	},
	question_1_1_3: {
		type: String,
		value: function(){return "As used in line 1 and line 65, “directly” most nearly means:";},
		notify: true
	},
	question_1_1_3_A:{
		type: String,
		value: function(){return "A) frankly.";},
		notify: true


	},

	question_1_1_3_B:{
		type: String,
		value: function(){return "B) confidently.";},
		notify: true

	},

	question_1_1_3_C:{
		type: String,
		value: function(){return "C) without mediation.";},
		notify: true
	},

	question_1_1_3_D:{
		type: String,
		value: function(){return "D) with precision";},
		notify: true
	},

	holderArray: {
	  type: Array,
	  value: function(){
	    return  this.passageThreeWordArray;
	    },
	  notify: true,
	  reflectToAttribute: true
	},

	minTranArray:{
	  type: Array,
	  notify: true,
	}, 

	doublePassage: {
	  type: Boolean,
	  value: false,
	  notify: true, 
	  reflectToAttribute: true
	},
	secondPassage: {
	  type: Boolean,
	  value: false,
	  notify: true,
	  reflectToAttribute: true

	},

	shorterThan550:{
	  type: Boolean,
	  value: false, 
	  notify: true,
	  reflectToAttribute: true
	}, 

	lineNumbers: {
		type: Number,
		value: function(){
		return 180;
		},
		notify: true
		}

	};
}

	  _computeLineNumberArray(passageOneWordArray){
		  this.arrayNums=[]
		  for(var i=1; i <= 180; i++)
		     {
			var showLine =  i % 5 ? false: true;
			this.push('arrayNums',{'number': i, 'show': showLine});
			}
			return this.arrayNums;
			}
     _computeValue(myValue){
		return myValue;
	  }

	 _onIronResize(){
	 	var ht=Math.floor((this.$.focusedMark.getBoundingClientRect().top-this.$.linesA1.getBoundingClientRect().top)/this.$.focusedMark.getBoundingClientRect().height)-2;
	     console.log(ht);
	     (!isNaN(ht))?this.set("lineNumbers", ht):this._computeLineNumberArray();

	 }
	  setMeasureParams(){
	  
	      var ht=Math.floor((this.$.focusedMark.getBoundingClientRect().top-this.$.linesA1.getBoundingClientRect().top)/this.$.focusedMark.getBoundingClientRect().height)-2;
	     console.log(ht);
	     (!isNaN(ht))?this.set("lineNumbers", ht):this._onIronResize();

	  }

	

_theContentFilter(firstWordIndex, lastWordIndex) {
	// if(!isNaN(lastWordIndex)){
	//   return (item) =>{
	// 	return (item.wordIndex >= firstWordIndex && item.wordIndex <= lastWordIndex);
	//   };
	// } else {
	//   return (item) =>{
		return true;
	//   };
	// }
  }


  _numberFilter(lineNumbers) {
	return (item) =>{
	  return (item.number <= lineNumbers);
	    };
	  } 
	
	}
    Polymer(fcPassageHolder);
 
  })();
</script>
</dom-module>