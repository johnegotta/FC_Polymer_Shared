<dom-module id="fc-tabbed-card">
<template>
<style is="custom-style">
.grid-box{
  min-width: 340px;
  min-height: 480px;
  padding: 3px;
  margin: 3px;
  display: block;
  color: black;
  background: white;
  overflow-x: hidden;
}

.grid-image{
    float: left;
    padding: 3px;
    height: 72px;
    color: black;
    width: 73px;
    background: aliceblue;
    display: block;

}
.grid-holder{
  width: calc(95%-85px);
  max-height: calc(98vh-64px);
  overflow: scroll;
}

.selectedp{ 
min-width: 560px;
min-height: 560px;
border: 2px solid blue;

}

</style>
<firebase-document id="ModelClass" location="focusedstudents.firebaseio.com/ModelClass" data="{{ModelClass}}" on-firebase-child-added="showTime"></firebase-document>


  <firebase-collection id='contactinfo' location="https://focusedstudents.firebaseio.com/contactinfo" order-by-child='fcid' equal-to="GanaMary00001" data='{{grids}}'></firebase-collection>
  <div class="vertical layout wrap grid-holder">
    <div class="horizontal layout wrap">
        <paper-material elevation="2" class="grid-box">
        <paper-tabs id="studenttabs" selected="{{selected}}" style="line-height:.6; background: #aecdfe;" scrollable>
              <paper-tab>Profile</paper-tab>
              <paper-tab>Scores</paper-tab>
              <paper-tab>Account</paper-tab>
              <paper-tab>ROI</paper-tab>
              <paper-tab>Academics</paper-tab>
              <paper-tab>Inquiries</paper-tab>
            </paper-tabs>
        <hr>
        <template is="dom-repeat" items="{{grids}}" as="item">
        <div class="vertical layout wrap" style="height: 78px;"> 
            <div class="grid-image">
            <img src="{{item.photo}}" height="72px" width="73px">
            </div>

          <div class="horizontal layout wrap left justified" style="width: 210px; height: 78px; overflow-y: scroll;"> 
              <span><b>Full Name</b>: <b><span>{{item.firstname}}</span>&nbsp<span>{{item.lastname}}</span></b>&nbsp</span>
             <span><b>FCID</b>: <i><u><span>[[item.fcid]]</span></u></i>&nbsp</span>
            <span><b>Phone</b>: <span>[[item.phone]]</span></span>&nbsp
              <span>
		              <b>Email</b>: <span>[[item.email]]</span>&nbsp
		              <b>S-email</b>: <span>[[item.studentemail]]</span>
              </span>
          </div>
        </div>
     </template>
        <hr>
         <iron-pages id="pageHanger" class="horizontal row wrap layout" style="padding:3px" selected="{{selected}}">
         <div class="selectedp">
Profile: STUFF







        </div>
        <div class="selectedp">
    	<div>
    	<div style="overflow-x: scroll; overflow-y: hidden; max-width: 480px;">
  <firebase-collection id='scores' location="{{pathThree}}" on-query-value="_getScores" order-by-child='fcid' equal-to='GanaMary00001' log="true" on-firebase-child-added="_scoreGetter" data='{{score}}'></firebase-collection>
          <template is="dom-repeat" items="{{score}}" as="potato">
                 <span><b style="font-size: 16px; color: #000066; font-weight: 700;">Pretest</b>: <span>[[potato.scoresPreTest]]</span></span><br><br>
                <span><b style="font-size: 16px; color: #000066; font-weight: 700;">Test 1</b>: <span>[[potato.scoresTest1]]</span></span><br><br>
                 <span><b style="font-size: 16px; color: #000066; font-weight: 700;">Test 2</b>: <span>[[potato.scoresTest2]]</span></span><br><br>
                 <span><b style="font-size: 16px; color: #000066; font-weight: 700;">Test 3</b>: <span>[[potato.scoresTest3]]</span></span><br><br>
                 <span><b style="font-size: 16px; color: #000066; font-weight: 700;">Test 4</b>: <span>[[potato.scoresTest4]]</span></span><br><br>
                 <span><b style="font-size: 16px; color: #000066; font-weight: 700;">Test 5</b>: <span>[[potato.scoresTest5]]</span></span><br><br>
                 <span><b style="font-size: 16px; color: #000066; font-weight: 700;">Test 6</b>: <span>[[potato.scoresTest6]]</span></span><br><br>
                <span style="font-size: 16px; color: #000066; font-weight: 700;">REAL SAT: <span>[[potato.realSAT]]</span></span><br><br>
                
            </template>
            </div>
        </div>
        </div>
        <div class="selectedp">





        </div>
        <div class="selectedp">








        </div>
		<div class="selectedp">








        </div>
        <div class="selectedp">








        </div>
        </iron-pages>

</paper-material>

</div>
</div>
</template>
<script>
 (function(){Polymer({
   	is: 'fc-tabbed-card',
  properties: {
    defaultPath: "",
    pathOne: String, 
    pathTwo: String, 
    pathThree: {
        type: String, 
        value: "https://focusedstudents.firebaseio.com/courseresults/", 
        notify: true, 
        reflectToAttributes: true
      },
    pathThreeArray: {
      type: Array, 
      notify: true, 
      reflectToAttributes: true 

    },
    firebasepathTwo: {
      type: String,
       value: "https://focusedstudents.firebaseio.com/courseresults", 
      notify: true, 
      reflectToAttributes: true
    },
    gridType: String, 
    fcid: {
      type: String, 
      value:' ',
      notify: true,
      reflectToAttributes: true
    },
    fcids: {
      type: Array,
      notify: true,
      value: [],
      reflectToAttributes: true
    },
    scores: {
      type: Array,
      value: [],
      notify: true,
      reflectToAttributes: true
      },
    gridImageOne: '',
    gridImageTwo: '',
    selected: {
    	type: Number,
    	value: 0,
    	notify: true,
    	reflectToAttributes: true
    },
    reflectToAttributes: true,
    notify: true
  },

created: function (){
 

},

 showTime: function(e){
        var path = this.pathThree;
        console.log(path + " this is the additive path");
        var fcid = e.detail.childSnapshot.key();
        console.log(fcid);
        this.fcid=fcid;
        var firebasepathTwo = this.pathThree + this.fcid;
        console.log(firebasepathTwo);
        this.firebasepathTwo = firebasepathTwo;
        var ref = new Firebase("#!" + firebasepathTwo);
        ref.orderByKey().startAt("real").endAt("scores\uf8ff").on("child_added", function(snapshot) {
        if(snapshot.exists() == false){
          var liToAddTwo = document.createElement('li');
            var showerTwo = document.getElementById('showIndicesTwo');
           console.log(fcid + ' and fcid ' + fcid);
            liToAddTwo.innerHTML = this.fcid + " " + "Did not take Test!!!";
            Polymer.dom(showerTwo).appendChild(liToAddTwo);
        }
        else if (snapshot.val()!== null) {
          var liToAdd = document.createElement('li');
          var showerTwo = document.getElementById('showIndicesTwo');
          console.log(fcid + " just got scores");
          //here we can set local object arrays, or object objects
        liToAdd.innerHTML = fcid + " " + snapshot.key() +": " + snapshot.val();
           Polymer.dom(showerTwo).appendChild(liToAdd);
           this.fcid = fcid;
        }
        //I dont get why nothing happens in this else? save that since there is no snapshot there is no function and the game ends there.
        
        });

        var ModelClass = e.detail.childSnapshot.val();
        console.log(ModelClass + " ModelClass");
// never got to storing it in a this array of objects; not exactly sure how to???
// if query resulty null or undefined == record no test score this week
       this.fcids.push(this.fcid);        
       console.log(this.fcids);
// push to corresponding array in scores=--I prefer an array of objects so our sinking isnt absurd, which the sending us all over tarnation would seem to imply.
       var repeats = this.fcids.length;
       console.log(repeats);
       console.log(this.fcid);
       return this.fcid;
//the above variable is pointless...
//of note, I expected the above individual ids to be an array from the beginning, not sure why they are not.
        },
_scoreGetter: function(sco){
        var scorekey = sco.detail.childSnapshot.key();
        var scorevalues = sco.detail.childSnapshot.val();
        console.log(JSON.stringify(scorekey));
        this.scores.push({scorekey, scorevalues});
        console.log(this.scores.length);
        //this is happening way in the beginning of time after "app is ready to rock!!!"

       },
_getScores: function(vals){
	console.log("-------------------------------------------------------------------- " + vals.detail.snapshot.val());



},

_doMagic: function(oldMagic, newMagic){
  
  console.log(oldMagic + " hello magic________________________________________________________________ " + newMagic + "  " +this.fcid + " I am observing this bullshit, but I get no details of the shit that happened?");
},

showArrays: function(){
  this.$.immabeTwo.innerHTML = "The first element numbered 0, contained the following: " + JSON.stringify(this.scores[0]) + " _______________________________________________________________________________ " + [/\n/] + " The second element contained the following: " + JSON.stringify(this.scores[1]) + " ________________________________________________________________________________ " + /\n/  + " The class list from the fcids array is as follows: " + this.fcids;
  console.log(this.scores + "scores and in the class list " + this.fcids + " " + this.fcids.slice(0,6));
}
});})();
</script>
</dom-module>
